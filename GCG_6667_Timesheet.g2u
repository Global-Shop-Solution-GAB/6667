Program.Sub.ScreenSU.Start
Gui.FormTimesheet..create(BaseForm)
Gui.FormTimesheet..caption("Timesheet Entry")
Gui.FormTimesheet..size(20685,10560)
Gui.FormTimesheet..minx(17000)
Gui.FormTimesheet..miny(9000)
Gui.FormTimesheet..position(0,0)
Gui.FormTimesheet..event(UnLoad,FormTimesheet_unload)
Gui.FormTimesheet..forecolor(0)
Gui.FormTimesheet..BackColor(-2147483633)
Gui.FormTimesheet..mousepointer(0)
Gui.FormTimesheet..AlwaysOnTop(False)
Gui.FormTimesheet..FontName("Tahoma")
Gui.FormTimesheet..FontSize(8.25)
Gui.FormTimesheet..ControlBox(True)
Gui.FormTimesheet..MaxButton(True)
Gui.FormTimesheet..MinButton(True)
Gui.FormTimesheet..Moveable(True)
Gui.FormTimesheet..Sizeable(True)
Gui.FormTimesheet..ShowInTaskBar(True)
Gui.FormTimesheet..TitleBar(True)
Gui.FormTimesheet.dtpWeek.create(datepicker)
Gui.FormTimesheet.dtpWeek.size(1935,285)
Gui.FormTimesheet.dtpWeek.position(120,315)
Gui.FormTimesheet.dtpWeek.event(Change,dtpweek_change)
Gui.FormTimesheet.dtpWeek.defaultvalue("")
Gui.FormTimesheet.dtpWeek.tabstop(True)
Gui.FormTimesheet.dtpWeek.tabindex(1)
Gui.FormTimesheet.dtpWeek.Enabled(True)
Gui.FormTimesheet.dtpWeek.Visible(True)
Gui.FormTimesheet.dtpWeek.Zorder(0)
Gui.FormTimesheet.dtpWeek.CheckBox(False)
Gui.FormTimesheet.dtpWeek.FontName("Tahoma")
Gui.FormTimesheet.dtpWeek.FontSize(8.25)
Gui.FormTimesheet.gsgcTimesheet.create(GsGridControl)
Gui.FormTimesheet.gsgcTimesheet.size(19500,8985)
Gui.FormTimesheet.gsgcTimesheet.position(0,705)
Gui.FormTimesheet.gsgcTimesheet.Event(RowCellClick,gsgcTimesheet_RowCellClick)
Gui.FormTimesheet.gsgcTimesheet.Event(CellValueChanged,gsgcTimesheet_CellValueChanged)
Gui.FormTimesheet.gsgcTimesheet.Anchor(15)
Gui.FormTimesheet.gsgcTimesheet.Enabled(True)
Gui.FormTimesheet.gsgcTimesheet.Visible(True)
Gui.FormTimesheet.gsgcTimesheet.Zorder(0)
Gui.FormTimesheet.cmdUpdate.create(button)
Gui.FormTimesheet.cmdUpdate.caption("Lock/Post to GSS")
Gui.FormTimesheet.cmdUpdate.size(1860,375)
Gui.FormTimesheet.cmdUpdate.position(1095,9720)
Gui.FormTimesheet.cmdUpdate.event(Click,cmdupdate_click)
Gui.FormTimesheet.cmdUpdate.disableonclick(20)
Gui.FormTimesheet.cmdUpdate.defaultvalue("")
Gui.FormTimesheet.cmdUpdate.tabstop(True)
Gui.FormTimesheet.cmdUpdate.tabindex(12)
Gui.FormTimesheet.cmdUpdate.Anchor(6)
Gui.FormTimesheet.cmdUpdate.Enabled(True)
Gui.FormTimesheet.cmdUpdate.Visible(True)
Gui.FormTimesheet.cmdUpdate.Zorder(0)
Gui.FormTimesheet.cmdUpdate.FontName("Tahoma")
Gui.FormTimesheet.cmdUpdate.FontSize(8.25)
Gui.FormTimesheet.cmdTemp.create(button)
Gui.FormTimesheet.cmdTemp.caption("Template")
Gui.FormTimesheet.cmdTemp.size(960,375)
Gui.FormTimesheet.cmdTemp.position(2085,9720)
Gui.FormTimesheet.cmdTemp.event(Click,cmdtemp_click)
Gui.FormTimesheet.cmdTemp.defaultvalue("")
Gui.FormTimesheet.cmdTemp.tabstop(True)
Gui.FormTimesheet.cmdTemp.tabindex(13)
Gui.FormTimesheet.cmdTemp.Anchor(6)
Gui.FormTimesheet.cmdTemp.Enabled(True)
Gui.FormTimesheet.cmdTemp.Visible(True)
Gui.FormTimesheet.cmdTemp.Zorder(0)
Gui.FormTimesheet.cmdTemp.FontName("Tahoma")
Gui.FormTimesheet.cmdTemp.FontSize(8.25)
Gui.FormTimesheet.cmdSave.create(button)
Gui.FormTimesheet.cmdSave.caption("Save")
Gui.FormTimesheet.cmdSave.size(855,375)
Gui.FormTimesheet.cmdSave.position(105,9720)
Gui.FormTimesheet.cmdSave.event(Click,cmdsave_click)
Gui.FormTimesheet.cmdSave.defaultvalue("")
Gui.FormTimesheet.cmdSave.tabstop(True)
Gui.FormTimesheet.cmdSave.tabindex(11)
Gui.FormTimesheet.cmdSave.Anchor(6)
Gui.FormTimesheet.cmdSave.Enabled(True)
Gui.FormTimesheet.cmdSave.Visible(True)
Gui.FormTimesheet.cmdSave.Zorder(0)
Gui.FormTimesheet.cmdSave.FontName("Tahoma")
Gui.FormTimesheet.cmdSave.FontSize(8.25)
Gui.FormTimesheet.lblDate.create(label,"Select Week",True,1935,255,1,120,120,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblDate.defaultvalue("")
Gui.FormTimesheet.lblDate.BorderStyle(0)
Gui.FormTimesheet.cmdRefresh.create(button)
Gui.FormTimesheet.cmdRefresh.caption("Refresh")
Gui.FormTimesheet.cmdRefresh.size(855,375)
Gui.FormTimesheet.cmdRefresh.position(2115,255)
Gui.FormTimesheet.cmdRefresh.event(Click,cmdrefresh_click)
Gui.FormTimesheet.cmdRefresh.disableonclick(20)
Gui.FormTimesheet.cmdRefresh.defaultvalue("")
Gui.FormTimesheet.cmdRefresh.tabstop(True)
Gui.FormTimesheet.cmdRefresh.tabindex(2)
Gui.FormTimesheet.cmdRefresh.Enabled(True)
Gui.FormTimesheet.cmdRefresh.Visible(True)
Gui.FormTimesheet.cmdRefresh.Zorder(0)
Gui.FormTimesheet.cmdRefresh.FontName("Tahoma")
Gui.FormTimesheet.cmdRefresh.FontSize(8.25)
Gui.FormTimesheet.txtASO.create(textbox,"",True,1095,300,0,3180,300,True,0,"Arial",8,-2147483643,1)
Gui.FormTimesheet.txtASO.defaultvalue("")
Gui.FormTimesheet.txtASO.MaxLength(6)
Gui.FormTimesheet.txtASO.TabStop(True)
Gui.FormTimesheet.txtASO.TabIndex(3)
Gui.FormTimesheet.txtASO.Event(LostFocus,txtASO_LostFocus)
Gui.FormTimesheet.txtASO.Event(GotFocus,txtASO_GotFocus)
Gui.FormTimesheet.txtAWO.create(textbox,"",True,1200,300,0,4320,300,True,0,"Arial",8,-2147483643,1)
Gui.FormTimesheet.txtAWO.defaultvalue("")
Gui.FormTimesheet.txtAWO.MaxLength(3)
Gui.FormTimesheet.txtAWO.TabStop(True)
Gui.FormTimesheet.txtAWO.TabIndex(4)
Gui.FormTimesheet.txtAWO.Locked(True)
Gui.FormTimesheet.cmdAddSOBrows.create(button)
Gui.FormTimesheet.cmdAddSOBrows.caption("^")
Gui.FormTimesheet.cmdAddSOBrows.size(345,375)
Gui.FormTimesheet.cmdAddSOBrows.position(5580,255)
Gui.FormTimesheet.cmdAddSOBrows.event(Click,cmdAddSOBrows_click)
Gui.FormTimesheet.cmdAddSOBrows.defaultvalue("")
Gui.FormTimesheet.cmdAddSOBrows.Enabled(True)
Gui.FormTimesheet.cmdAddSOBrows.Visible(True)
Gui.FormTimesheet.cmdAddSOBrows.Zorder(0)
Gui.FormTimesheet.cmdAddSOBrows.FontName("Tahoma")
Gui.FormTimesheet.cmdAddSOBrows.FontSize(8.25)
Gui.FormTimesheet.txtADept.create(textbox,"",True,765,300,0,6000,300,True,0,"Arial",8,-2147483643,1)
Gui.FormTimesheet.txtADept.defaultvalue("")
Gui.FormTimesheet.txtADept.MaxLength(6)
Gui.FormTimesheet.txtADept.TabStop(True)
Gui.FormTimesheet.txtADept.TabIndex(5)
Gui.FormTimesheet.txtADept.Event(GotFocus,txtADept_GotFocus)
Gui.FormTimesheet.cmdAddDeptBrows.create(button)
Gui.FormTimesheet.cmdAddDeptBrows.caption("^")
Gui.FormTimesheet.cmdAddDeptBrows.size(345,375)
Gui.FormTimesheet.cmdAddDeptBrows.position(6885,270)
Gui.FormTimesheet.cmdAddDeptBrows.event(Click,cmdAddDeptBrows_click)
Gui.FormTimesheet.cmdAddDeptBrows.defaultvalue("")
Gui.FormTimesheet.cmdAddDeptBrows.Enabled(True)
Gui.FormTimesheet.cmdAddDeptBrows.Visible(True)
Gui.FormTimesheet.cmdAddDeptBrows.Zorder(0)
Gui.FormTimesheet.cmdAddDeptBrows.FontName("Tahoma")
Gui.FormTimesheet.cmdAddDeptBrows.FontSize(8.25)
Gui.FormTimesheet.lblADept.create(label,"Dept",True,870,255,1,6000,105,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblADept.defaultvalue("")
Gui.FormTimesheet.lblADept.BorderStyle(0)
Gui.FormTimesheet.lblAWO.create(label,"Work Order",True,1155,255,1,4425,105,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblAWO.defaultvalue("")
Gui.FormTimesheet.lblAWO.BorderStyle(0)
Gui.FormTimesheet.lblASO.create(label,"Sales Order",True,1065,255,1,3150,105,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblASO.defaultvalue("")
Gui.FormTimesheet.lblASO.BorderStyle(0)
Gui.FormTimesheet.cmdAdd.create(button)
Gui.FormTimesheet.cmdAdd.caption("Add")
Gui.FormTimesheet.cmdAdd.size(1110,375)
Gui.FormTimesheet.cmdAdd.position(8850,270)
Gui.FormTimesheet.cmdAdd.event(Click,cmdadd_click)
Gui.FormTimesheet.cmdAdd.disableonclick(20)
Gui.FormTimesheet.cmdAdd.defaultvalue("")
Gui.FormTimesheet.cmdAdd.tabstop(True)
Gui.FormTimesheet.cmdAdd.tabindex(7)
Gui.FormTimesheet.cmdAdd.Enabled(True)
Gui.FormTimesheet.cmdAdd.Visible(True)
Gui.FormTimesheet.cmdAdd.Zorder(0)
Gui.FormTimesheet.cmdAdd.FontName("Tahoma")
Gui.FormTimesheet.cmdAdd.FontSize(8.25)
Gui.FormTimesheet.cmdReady.create(button)
Gui.FormTimesheet.cmdReady.caption("Ready for Approval")
Gui.FormTimesheet.cmdReady.size(1710,375)
Gui.FormTimesheet.cmdReady.position(3120,9720)
Gui.FormTimesheet.cmdReady.event(Click,cmdready_click)
Gui.FormTimesheet.cmdReady.defaultvalue("")
Gui.FormTimesheet.cmdReady.TabStop(True)
Gui.FormTimesheet.cmdReady.TabIndex(14)
Gui.FormTimesheet.cmdReady.Anchor(6)
Gui.FormTimesheet.cmdReady.Enabled(True)
Gui.FormTimesheet.cmdReady.Visible(True)
Gui.FormTimesheet.cmdReady.Zorder(0)
Gui.FormTimesheet.cmdReady.FontName("Tahoma")
Gui.FormTimesheet.cmdReady.FontSize(8.25)
Gui.FormTimesheet.cmdPrint.create(button)
Gui.FormTimesheet.cmdPrint.caption("Export")
Gui.FormTimesheet.cmdPrint.size(885,375)
Gui.FormTimesheet.cmdPrint.position(4050,9720)
Gui.FormTimesheet.cmdPrint.event(Click,cmdprint_click)
Gui.FormTimesheet.cmdPrint.defaultvalue("")
Gui.FormTimesheet.cmdPrint.Anchor(6)
Gui.FormTimesheet.cmdPrint.Enabled(True)
Gui.FormTimesheet.cmdPrint.Visible(True)
Gui.FormTimesheet.cmdPrint.Zorder(0)
Gui.FormTimesheet.cmdPrint.FontName("Tahoma")
Gui.FormTimesheet.cmdPrint.FontSize(8.25)
Gui.FormTimesheet.txtEmployee.create(textbox,"",True,1020,300,0,11220,9780,False,0,"Arial",8,-2147483643,1)
Gui.FormTimesheet.txtEmployee.maxLength(5)
Gui.FormTimesheet.txtEmployee.defaultvalue("")
Gui.FormTimesheet.txtEmployee.Event(LostFocus,txtEmployee_Change)
Gui.FormTimesheet.txtEmployee.TabStop(True)
Gui.FormTimesheet.txtEmployee.TabIndex(8)
Gui.FormTimesheet.txtEmployee.Anchor(6)
Gui.FormTimesheet.txtEmployee.Event(GotFocus,txtEmployee_GotFocus)
Gui.FormTimesheet.lblEmp.create(label,"Employee",True,810,255,1,10365,9870,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblEmp.defaultvalue("")
Gui.FormTimesheet.lblEmp.Anchor(6)
Gui.FormTimesheet.lblEmp.BorderStyle(0)
Gui.FormTimesheet.cmdEmpBrws.create(button)
Gui.FormTimesheet.cmdEmpBrws.caption("^")
Gui.FormTimesheet.cmdEmpBrws.size(465,375)
Gui.FormTimesheet.cmdEmpBrws.position(12285,9750)
Gui.FormTimesheet.cmdEmpBrws.event(Click,cmdempbrws_click)
Gui.FormTimesheet.cmdEmpBrws.defaultvalue("")
Gui.FormTimesheet.cmdEmpBrws.Anchor(6)
Gui.FormTimesheet.cmdEmpBrws.Enabled(False)
Gui.FormTimesheet.cmdEmpBrws.Visible(False)
Gui.FormTimesheet.cmdEmpBrws.Zorder(0)
Gui.FormTimesheet.cmdEmpBrws.FontName("Tahoma")
Gui.FormTimesheet.cmdEmpBrws.FontSize(8.25)
Gui.FormTimesheet.cmdEmpSearch.create(button)
Gui.FormTimesheet.cmdEmpSearch.caption("Refresh")
Gui.FormTimesheet.cmdEmpSearch.size(1095,420)
Gui.FormTimesheet.cmdEmpSearch.position(14415,9720)
Gui.FormTimesheet.cmdEmpSearch.event(Click,cmdempsearch_click)
Gui.FormTimesheet.cmdEmpSearch.defaultvalue("")
Gui.FormTimesheet.cmdEmpSearch.TabStop(True)
Gui.FormTimesheet.cmdEmpSearch.TabIndex(9)
Gui.FormTimesheet.cmdEmpSearch.Anchor(6)
Gui.FormTimesheet.cmdEmpSearch.Enabled(False)
Gui.FormTimesheet.cmdEmpSearch.Visible(False)
Gui.FormTimesheet.cmdEmpSearch.Zorder(0)
Gui.FormTimesheet.cmdEmpSearch.FontName("Tahoma")
Gui.FormTimesheet.cmdEmpSearch.FontSize(8.25)
Gui.FormTimesheet.cmdUnlock.create(button)
Gui.FormTimesheet.cmdUnlock.caption("Unlock")
Gui.FormTimesheet.cmdUnlock.visible(False)
Gui.FormTimesheet.cmdUnlock.size(855,375)
Gui.FormTimesheet.cmdUnlock.position(4095,9720)
Gui.FormTimesheet.cmdUnlock.event(Click,cmdunlock_click)
Gui.FormTimesheet.cmdUnlock.defaultvalue("")
Gui.FormTimesheet.cmdUnlock.TabStop(True)
Gui.FormTimesheet.cmdUnlock.TabIndex(15)
Gui.FormTimesheet.cmdUnlock.Anchor(6)
Gui.FormTimesheet.cmdUnlock.Enabled(True)
Gui.FormTimesheet.cmdUnlock.Zorder(0)
Gui.FormTimesheet.cmdUnlock.FontName("Tahoma")
Gui.FormTimesheet.cmdUnlock.FontSize(8.25)
Gui.FormTimesheet.chkAllEmployees.create(checkbox)
Gui.FormTimesheet.chkAllEmployees.caption("Update All Employees")
Gui.FormTimesheet.chkAllEmployees.visible(False)
Gui.FormTimesheet.chkAllEmployees.size(2115,300)
Gui.FormTimesheet.chkAllEmployees.position(5235,9780)
Gui.FormTimesheet.chkAllEmployees.tooltip("Upload all employee times that are marked as Ready.")
Gui.FormTimesheet.chkAllEmployees.defaultvalue(0)
Gui.FormTimesheet.chkAllEmployees.TabStop(True)
Gui.FormTimesheet.chkAllEmployees.TabIndex(16)
Gui.FormTimesheet.chkAllEmployees.Anchor(6)
Gui.FormTimesheet.chkAllEmployees.Enabled(True)
Gui.FormTimesheet.chkAllEmployees.Zorder(0)
Gui.FormTimesheet.chkAllEmployees.FontName("Tahoma")
Gui.FormTimesheet.chkAllEmployees.FontSize(8.25)
Gui.FormTimesheet.txtUser.create(textbox,"",True,1020,300,1,13350,9780,False,0,"Arial",8,-2147483643,1)
Gui.FormTimesheet.txtUser.maxLength(10)
Gui.FormTimesheet.txtUser.defaultvalue("")
Gui.FormTimesheet.txtUser.TabStop(True)
Gui.FormTimesheet.txtUser.TabIndex(10)
Gui.FormTimesheet.txtUser.Anchor(6)
Gui.FormTimesheet.txtUser.Event(LostFocus,txtUser_LostFocus)
Gui.FormTimesheet.lblUser.create(label,"User",True,540,255,0,12810,9870,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblUser.defaultvalue("")
Gui.FormTimesheet.lblUser.Anchor(6)
Gui.FormTimesheet.lblUser.BorderStyle(0)
Gui.FormTimesheet.lblASeq2.Create(Label,"Work Center",True,1170,255,1,7290,120,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblASeq2.DefaultValue("")
Gui.FormTimesheet.lblASeq2.BorderStyle(0)
Gui.FormTimesheet.txtWC.Create(TextBox,"",True,765,300,0,7320,300,True,0,"Arial",8,-2147483643,1)
Gui.FormTimesheet.txtWC.DefaultValue("")
Gui.FormTimesheet.txtWC.MaxLength(4)
Gui.FormTimesheet.txtWC.TabStop(True)
Gui.FormTimesheet.txtWC.TabIndex(6)
Gui.FormTimesheet.txtWC.Event(GotFocus,txtWC_GotFocus)
Gui.FormTimesheet.cmdAddWC.Create(Button)
Gui.FormTimesheet.cmdAddWC.Size(345,375)
Gui.FormTimesheet.cmdAddWC.Position(8220,270)
Gui.FormTimesheet.cmdAddWC.Caption("^")
Gui.FormTimesheet.cmdAddWC.DefaultValue("")
Gui.FormTimesheet.cmdAddWC.Event(Click,cmdAddWC_Click)
Gui.FormTimesheet.cmdAddWC.Enabled(True)
Gui.FormTimesheet.cmdAddWC.Visible(True)
Gui.FormTimesheet.cmdAddWC.Zorder(0)
Gui.FormTimesheet.cmdAddWC.FontName("Tahoma")
Gui.FormTimesheet.cmdAddWC.FontSize(8.25)
Gui.FormTimesheet.lbl1.Create(Label,"Sun Hrs",True,1035,255,0,19545,1080,True,0,"Arial",10,-2147483633,0,0)
Gui.FormTimesheet.lbl1.Anchor(9)
Gui.FormTimesheet.lbl1.BorderStyle(0)
Gui.FormTimesheet.txtSunHrs.Create(TextBox,"",True,870,300,0,19575,1305,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtSunHrs.Locked(True)
Gui.FormTimesheet.txtSunHrs.ForeColor(0)
Gui.FormTimesheet.txtSunHrs.Anchor(9)
Gui.FormTimesheet.lbl2.Create(Label,"Mon Hrs",True,1035,255,0,19575,1965,True,0,"Arial",10,-2147483633,0,0)
Gui.FormTimesheet.lbl2.Anchor(9)
Gui.FormTimesheet.lbl2.BorderStyle(0)
Gui.FormTimesheet.lbl3.Create(Label,"Tues Hrs",True,1035,255,0,19575,2985,True,0,"Arial",10,-2147483633,0,0)
Gui.FormTimesheet.lbl3.Anchor(9)
Gui.FormTimesheet.lbl3.BorderStyle(0)
Gui.FormTimesheet.lbl4.Create(Label,"Wed Hrs",True,1035,255,0,19575,3975,True,0,"Arial",10,-2147483633,0,0)
Gui.FormTimesheet.lbl4.Anchor(9)
Gui.FormTimesheet.lbl4.BorderStyle(0)
Gui.FormTimesheet.lbl5.Create(Label,"Thur Hrs",True,1035,255,0,19575,4965,True,0,"Arial",10,-2147483633,0,0)
Gui.FormTimesheet.lbl5.Anchor(9)
Gui.FormTimesheet.lbl5.BorderStyle(0)
Gui.FormTimesheet.lbl6.Create(Label,"Fri Hrs",True,1035,255,0,19575,5970,True,0,"Arial",10,-2147483633,0,0)
Gui.FormTimesheet.lbl6.Anchor(9)
Gui.FormTimesheet.lbl6.BorderStyle(0)
Gui.FormTimesheet.lbl7.Create(Label,"Sat Hrs",True,1035,255,0,19575,6945,True,0,"Arial",10,-2147483633,0,0)
Gui.FormTimesheet.lbl7.Anchor(9)
Gui.FormTimesheet.lbl7.BorderStyle(0)
Gui.FormTimesheet.lbl8.Create(Label,"Hours for Wk",True,1125,255,0,13305,120,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lbl8.BorderStyle(0)
Gui.FormTimesheet.txtFriHrs.Create(TextBox,"",True,870,300,0,19575,6210,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtFriHrs.ForeColor(0)
Gui.FormTimesheet.txtFriHrs.Locked(True)
Gui.FormTimesheet.txtFriHrs.Anchor(9)
Gui.FormTimesheet.txtThurHrs.Create(TextBox,"",True,870,300,0,19575,5205,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtThurHrs.ForeColor(0)
Gui.FormTimesheet.txtThurHrs.Locked(True)
Gui.FormTimesheet.txtThurHrs.Anchor(9)
Gui.FormTimesheet.txtWedHrs.Create(TextBox,"",True,870,300,0,19575,4200,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtWedHrs.ForeColor(0)
Gui.FormTimesheet.txtWedHrs.Locked(True)
Gui.FormTimesheet.txtWedHrs.Anchor(9)
Gui.FormTimesheet.txtTuesHrs.Create(TextBox,"",True,870,300,0,19575,3225,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtTuesHrs.ForeColor(0)
Gui.FormTimesheet.txtTuesHrs.Locked(True)
Gui.FormTimesheet.txtTuesHrs.Anchor(9)
Gui.FormTimesheet.txtMonHrs.Create(TextBox,"",True,870,300,0,19575,2205,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtMonHrs.ForeColor(0)
Gui.FormTimesheet.txtMonHrs.Locked(True)
Gui.FormTimesheet.txtMonHrs.Anchor(9)
Gui.FormTimesheet.txtSatHrs.Create(TextBox,"",True,870,300,0,19575,7185,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtSatHrs.ForeColor(0)
Gui.FormTimesheet.txtSatHrs.Locked(True)
Gui.FormTimesheet.txtSatHrs.Anchor(9)
Gui.FormTimesheet.txtTotHrs.Create(TextBox,"",True,870,300,0,13305,315,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtTotHrs.ForeColor(0)
Gui.FormTimesheet.txtTotHrs.NumericOnly(1)
Gui.FormTimesheet.txtTotHrs.Locked(True)
Gui.FormTimesheet.cmdFrmTemp.Create(Button)
Gui.FormTimesheet.cmdFrmTemp.Size(1770,375)
Gui.FormTimesheet.cmdFrmTemp.Position(10230,270)
Gui.FormTimesheet.cmdFrmTemp.TabStop(True)
Gui.FormTimesheet.cmdFrmTemp.TabIndex(7)
Gui.FormTimesheet.cmdFrmTemp.Caption("Add From Template")
Gui.FormTimesheet.cmdFrmTemp.DisableOnClick(20)
Gui.FormTimesheet.cmdFrmTemp.DefaultValue("")
Gui.FormTimesheet.cmdFrmTemp.Event(Click,cmdFrmTemp_Click)
Gui.FormTimesheet.cmdFrmTemp.Enabled(True)
Gui.FormTimesheet.cmdFrmTemp.Visible(True)
Gui.FormTimesheet.cmdFrmTemp.Zorder(0)
Gui.FormTimesheet.cmdFrmTemp.FontName("Tahoma")
Gui.FormTimesheet.cmdFrmTemp.FontSize(8.25)
Gui.FormTimesheet.lblDay.Create(Label,"Day",True,435,255,0,19845,75,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblDay.Anchor(9)
Gui.FormTimesheet.lblDay.BorderStyle(0)
Gui.FormTimesheet.txtBucketHrs.Create(TextBox,"Bucket Hrs.",True,1005,300,0,19545,255,False,0,"Arial",8,-2147483643,1)
Gui.FormTimesheet.txtBucketHrs.Anchor(9)
Gui.FormTimesheet.lblClockHrs.Create(Label,"Balance Hrs.",True,960,255,0,19590,615,False,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblClockHrs.FontStyle(False,True,False,False,False)
Gui.FormTimesheet.lblClockHrs.Anchor(9)
Gui.FormTimesheet.lblClockHrs.BorderStyle(0)
Gui.FormTimesheet.lblClockHrsMon.Create(Label,"Clock Hrs.",True,870,255,0,19575,2595,False,2,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblClockHrsMon.Anchor(9)
Gui.FormTimesheet.lblClockHrsMon.FontStyle(False,True,False,False,False)
Gui.FormTimesheet.lblClockHrsMon.BorderStyle(0)
Gui.FormTimesheet.lblClockHrsTues.Create(Label,"Clock Hrs.",True,870,255,0,19575,3585,False,2,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblClockHrsTues.Anchor(9)
Gui.FormTimesheet.lblClockHrsTues.FontStyle(False,True,False,False,False)
Gui.FormTimesheet.lblClockHrsTues.BorderStyle(0)
Gui.FormTimesheet.lblClockHrsWed.Create(Label,"Clock Hrs.",True,870,255,0,19575,4560,False,2,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblClockHrsWed.Anchor(9)
Gui.FormTimesheet.lblClockHrsWed.FontStyle(False,True,False,False,False)
Gui.FormTimesheet.lblClockHrsWed.BorderStyle(0)
Gui.FormTimesheet.lblClockHrsThur.Create(Label,"Clock Hrs.",True,870,255,0,19575,5565,False,2,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblClockHrsThur.Anchor(9)
Gui.FormTimesheet.lblClockHrsThur.FontStyle(False,True,False,False,False)
Gui.FormTimesheet.lblClockHrsThur.BorderStyle(0)
Gui.FormTimesheet.lblClockHrsFri.Create(Label,"Clock Hrs.",True,870,255,0,19575,6570,False,2,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblClockHrsFri.Anchor(9)
Gui.FormTimesheet.lblClockHrsFri.FontStyle(False,True,False,False,False)
Gui.FormTimesheet.lblClockHrsFri.BorderStyle(0)
Gui.FormTimesheet.lblClockHrsSat.Create(Label,"Clock Hrs.",True,870,255,0,19575,7545,False,2,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblClockHrsSat.Anchor(9)
Gui.FormTimesheet.lblClockHrsSat.FontStyle(False,True,False,False,False)
Gui.FormTimesheet.lblClockHrsSat.BorderStyle(0)
Gui.FormTimesheet.lblClockHrsSun.Create(Label,"Clock Hrs.",True,870,255,0,19545,1680,False,2,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblClockHrsSun.Anchor(9)
Gui.FormTimesheet.lblClockHrsSun.FontStyle(False,True,False,False,False)
Gui.FormTimesheet.lblClockHrsSun.BorderStyle(0)
Gui.FormTimesheet.lblClockHrsTotal.Create(Label,"Clock Hrs.",False,870,255,0,19575,9660,False,2,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblClockHrsTotal.Anchor(10)
Gui.FormTimesheet.lblClockHrsTotal.FontStyle(False,True,False,False,False)
Gui.FormTimesheet.lblClockHrsTotal.BorderStyle(0)
Gui.FormTimesheet.txtHoursTA.Create(TextBox,"",True,870,300,0,12195,315,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtHoursTA.ForeColor(0)
Gui.FormTimesheet.txtHoursTA.Locked(True)
Gui.FormTimesheet.txtHoursBalance.Create(TextBox,"",False,870,300,0,15630,315,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtHoursBalance.ForeColor(0)
Gui.FormTimesheet.txtHoursBalance.NumericOnly(1)
Gui.FormTimesheet.txtHoursBalance.Locked(True)
Gui.FormTimesheet.lbl9.Create(Label,"Hours Posted",True,1095,255,0,12195,120,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lbl9.BorderStyle(0)
Gui.FormTimesheet.lbl10.Create(Label,"Balance Hrs.",False,1035,255,0,15630,120,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lbl10.BorderStyle(0)
Gui.FormTimesheet.txtGUIHours.Create(TextBox,"",False,870,300,0,14475,315,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtGUIHours.ForeColor(0)
Gui.FormTimesheet.txtGUIHours.NumericOnly(1)
Gui.FormTimesheet.txtGUIHours.Locked(True)
Gui.FormTimesheet.lbl11.Create(Label,"GUI Hrs.",False,930,255,0,14475,120,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lbl11.BorderStyle(0)
Gui.F_Template..create(BaseForm)
Gui.F_Template..caption("Template Entry")
Gui.F_Template..size(6930,7380)
Gui.F_Template..minx(0)
Gui.F_Template..miny(0)
Gui.F_Template..position(0,0)
Gui.F_Template..event(UnLoad,f_template_unload)
Gui.F_Template..forecolor(0)
Gui.F_Template..BackColor(-2147483633)
Gui.F_Template..maxbutton(False)
Gui.F_Template..mousepointer(0)
Gui.F_Template..sizeable(False)
Gui.F_Template..AlwaysOnTop(False)
Gui.F_Template..FontName("Tahoma")
Gui.F_Template..FontSize(8.25)
Gui.F_Template..ControlBox(True)
Gui.F_Template..MinButton(True)
Gui.F_Template..Moveable(True)
Gui.F_Template..ShowInTaskBar(True)
Gui.F_Template..TitleBar(True)
Gui.F_Template.lblJob.create(label,"Sales Order",True,1020,255,1,120,150,True,0,"Arial",8,-2147483633,0,0)
Gui.F_Template.lblJob.defaultvalue("")
Gui.F_Template.lblJob.BorderStyle(0)
Gui.F_Template.txtTmpSO.create(textbox,"",True,1140,300,0,105,375,True,0,"Arial",8,-2147483643,1)
Gui.F_Template.txtTmpSO.defaultvalue("")
Gui.F_Template.txtTmpSO.TabStop(True)
Gui.F_Template.txtTmpSO.TabIndex(1)
Gui.F_Template.lblSuff.create(label,"Work Order",True,1110,255,1,1335,150,True,0,"Arial",8,-2147483633,0,0)
Gui.F_Template.lblSuff.defaultvalue("")
Gui.F_Template.lblSuff.BorderStyle(0)
Gui.F_Template.txtTmpWO.create(textbox,"",True,1230,300,0,1335,375,True,0,"Arial",8,-2147483643,1)
Gui.F_Template.txtTmpWO.defaultvalue("")
Gui.F_Template.txtTmpWO.TabStop(True)
Gui.F_Template.txtTmpWO.TabIndex(2)
Gui.F_Template.txtTmpWO.Locked(True)
Gui.F_Template.cmdTmpSOBrows.create(button)
Gui.F_Template.cmdTmpSOBrows.caption("^")
Gui.F_Template.cmdTmpSOBrows.size(345,375)
Gui.F_Template.cmdTmpSOBrows.position(2625,345)
Gui.F_Template.cmdTmpSOBrows.event(Click,cmdTmpSOBrows_click)
Gui.F_Template.cmdTmpSOBrows.defaultvalue("")
Gui.F_Template.cmdTmpSOBrows.TabStop(True)
Gui.F_Template.cmdTmpSOBrows.TabIndex(3)
Gui.F_Template.cmdTmpSOBrows.Enabled(True)
Gui.F_Template.cmdTmpSOBrows.Visible(True)
Gui.F_Template.cmdTmpSOBrows.Zorder(0)
Gui.F_Template.cmdTmpSOBrows.FontName("Tahoma")
Gui.F_Template.cmdTmpSOBrows.FontSize(8.25)
Gui.F_Template.lblSeq.create(label,"Dept",True,735,255,1,3030,150,True,0,"Arial",8,-2147483633,0,0)
Gui.F_Template.lblSeq.defaultvalue("")
Gui.F_Template.lblSeq.BorderStyle(0)
Gui.F_Template.txtTmpDept.create(textbox,"",True,630,300,0,3030,375,True,0,"Arial",8,-2147483643,1)
Gui.F_Template.txtTmpDept.defaultvalue("")
Gui.F_Template.txtTmpDept.TabStop(True)
Gui.F_Template.txtTmpDept.TabIndex(4)
Gui.F_Template.cmdTmpDeptBrows.create(button)
Gui.F_Template.cmdTmpDeptBrows.caption("^")
Gui.F_Template.cmdTmpDeptBrows.size(345,375)
Gui.F_Template.cmdTmpDeptBrows.position(3720,345)
Gui.F_Template.cmdTmpDeptBrows.event(Click,cmdTmpDeptBrows_click)
Gui.F_Template.cmdTmpDeptBrows.defaultvalue("")
Gui.F_Template.cmdTmpDeptBrows.TabStop(True)
Gui.F_Template.cmdTmpDeptBrows.TabIndex(5)
Gui.F_Template.cmdTmpDeptBrows.Enabled(True)
Gui.F_Template.cmdTmpDeptBrows.Visible(True)
Gui.F_Template.cmdTmpDeptBrows.Zorder(0)
Gui.F_Template.cmdTmpDeptBrows.FontName("Tahoma")
Gui.F_Template.cmdTmpDeptBrows.FontSize(8.25)
Gui.F_Template.cmdTmpAdd.create(button)
Gui.F_Template.cmdTmpAdd.caption("Add")
Gui.F_Template.cmdTmpAdd.size(855,375)
Gui.F_Template.cmdTmpAdd.position(105,825)
Gui.F_Template.cmdTmpAdd.event(Click,cmdtmpadd_click)
Gui.F_Template.cmdTmpAdd.defaultvalue("")
Gui.F_Template.cmdTmpAdd.TabStop(True)
Gui.F_Template.cmdTmpAdd.TabIndex(8)
Gui.F_Template.cmdTmpAdd.Enabled(True)
Gui.F_Template.cmdTmpAdd.Visible(True)
Gui.F_Template.cmdTmpAdd.Zorder(0)
Gui.F_Template.cmdTmpAdd.FontName("Tahoma")
Gui.F_Template.cmdTmpAdd.FontSize(8.25)
Gui.F_Template.cmdTmpDelete.create(button)
Gui.F_Template.cmdTmpDelete.caption("Delete")
Gui.F_Template.cmdTmpDelete.size(855,375)
Gui.F_Template.cmdTmpDelete.position(1065,810)
Gui.F_Template.cmdTmpDelete.event(Click,cmdtmpdelete_click)
Gui.F_Template.cmdTmpDelete.defaultvalue("")
Gui.F_Template.cmdTmpDelete.TabStop(True)
Gui.F_Template.cmdTmpDelete.TabIndex(9)
Gui.F_Template.cmdTmpDelete.Enabled(True)
Gui.F_Template.cmdTmpDelete.Visible(True)
Gui.F_Template.cmdTmpDelete.Zorder(0)
Gui.F_Template.cmdTmpDelete.FontName("Tahoma")
Gui.F_Template.cmdTmpDelete.FontSize(8.25)
Gui.F_Template.lvwTemp.create(listview)
Gui.F_Template.lvwTemp.view(3)
Gui.F_Template.lvwTemp.addlistviewcolumn("Sales Order",915,0)
Gui.F_Template.lvwTemp.addlistviewcolumn("Work Order",660,0)
Gui.F_Template.lvwTemp.addlistviewcolumn("Dept",1000,0)
Gui.F_Template.lvwTemp.addlistviewcolumn("WC",660,0)
Gui.F_Template.lvwTemp.addlistviewcolumn("Customer Name",2115,0)
Gui.F_Template.lvwTemp.size(6765,5055)
Gui.F_Template.lvwTemp.position(75,1305)
Gui.F_Template.lvwTemp.event(ItemClick,lvwtemp_itemclick)
Gui.F_Template.lvwTemp.Enabled(True)
Gui.F_Template.lvwTemp.Visible(True)
Gui.F_Template.lvwTemp.Zorder(0)
Gui.F_Template.lvwTemp.FontName("Tahoma")
Gui.F_Template.lvwTemp.FontSize(8)
Gui.F_Template.lvwTemp.Multiselect(False)
Gui.F_Template.lvwTemp.CheckBoxes(False)
Gui.F_Template.cmdTmpDeleteAll.create(button)
Gui.F_Template.cmdTmpDeleteAll.caption("Delete All")
Gui.F_Template.cmdTmpDeleteAll.size(1395,345)
Gui.F_Template.cmdTmpDeleteAll.position(90,6450)
Gui.F_Template.cmdTmpDeleteAll.event(Click,cmdtmpdeleteall_click)
Gui.F_Template.cmdTmpDeleteAll.defaultvalue("")
Gui.F_Template.cmdTmpDeleteAll.TabStop(True)
Gui.F_Template.cmdTmpDeleteAll.TabIndex(10)
Gui.F_Template.cmdTmpDeleteAll.Enabled(True)
Gui.F_Template.cmdTmpDeleteAll.Visible(True)
Gui.F_Template.cmdTmpDeleteAll.Zorder(0)
Gui.F_Template.cmdTmpDeleteAll.FontName("Tahoma")
Gui.F_Template.cmdTmpDeleteAll.FontSize(8.25)
Gui.F_Template.cmdTmpWC.Create(Button)
Gui.F_Template.cmdTmpWC.Size(345,375)
Gui.F_Template.cmdTmpWC.Position(5025,330)
Gui.F_Template.cmdTmpWC.Caption("^")
Gui.F_Template.cmdTmpWC.DefaultValue("")
Gui.F_Template.cmdTmpWC.Event(Click,cmdTmpAddWC_Click)
Gui.F_Template.cmdTmpWC.TabStop(True)
Gui.F_Template.cmdTmpWC.TabIndex(7)
Gui.F_Template.cmdTmpWC.Enabled(True)
Gui.F_Template.cmdTmpWC.Visible(True)
Gui.F_Template.cmdTmpWC.Zorder(0)
Gui.F_Template.cmdTmpWC.FontName("Tahoma")
Gui.F_Template.cmdTmpWC.FontSize(8.25)
Gui.F_Template.txtTmpWC.Create(TextBox,"",True,765,300,0,4110,375,True,0,"Arial",8,-2147483643,1)
Gui.F_Template.txtTmpWC.DefaultValue("")
Gui.F_Template.txtTmpWC.TabStop(True)
Gui.F_Template.txtTmpWC.TabIndex(6)
Gui.F_Template.lblSeq2.Create(Label,"Workcenter",True,1185,255,1,4050,150,True,0,"Arial",8,-2147483633,0,0)
Gui.F_Template.lblSeq2.DefaultValue("")
Gui.F_Template.lblSeq2.BorderStyle(0)
Gui.fLogin..Create(BaseForm)
Gui.fLogin..Caption("Time Sheet Login")
Gui.fLogin..Size(4395,2280)
Gui.fLogin..MinX(0)
Gui.fLogin..MinY(0)
Gui.fLogin..Position(0,0)
Gui.fLogin..BackColor(-2147483633)
Gui.fLogin..MousePointer(0)
Gui.fLogin..Event(UnLoad,fLogin_UnLoad)
Gui.fLogin..AlwaysOnTop(False)
Gui.fLogin..FontName("Tahoma")
Gui.fLogin..FontSize(8.25)
Gui.fLogin..ControlBox(True)
Gui.fLogin..MaxButton(True)
Gui.fLogin..MinButton(True)
Gui.fLogin..Moveable(True)
Gui.fLogin..Sizeable(True)
Gui.fLogin..ShowInTaskBar(True)
Gui.fLogin..TitleBar(True)
Gui.fLogin.lbl1.Create(Label,"User Name :",True,1560,255,0,270,300,True,0,"Arial",12,-2147483633,0,0)
Gui.fLogin.lbl1.BorderStyle(0)
Gui.fLogin.txtUser.Create(TextBox,"",True,1680,390,0,2130,165,True,0,"Arial",12,-2147483643,1)
Gui.fLogin.txtUser.MaxLength(8)
Gui.fLogin.txtUser.Mask(">")
Gui.fLogin.lbl2.Create(Label,"Password : ",True,1605,255,0,270,720,True,0,"Arial",12,-2147483633,0,0)
Gui.fLogin.lbl2.BorderStyle(0)
Gui.fLogin.txtPassword.Create(TextBox,"",True,1680,390,0,2130,585,True,0,"Arial",12,-2147483643,1)
Gui.fLogin.txtPassword.PasswordChar("***********")
Gui.fLogin.cmdSignIn.Create(Button)
Gui.fLogin.cmdSignIn.Size(3555,450)
Gui.fLogin.cmdSignIn.Position(270,1125)
Gui.fLogin.cmdSignIn.Caption("Sign In")
Gui.fLogin.cmdSignIn.FontSize(12)
Gui.fLogin.cmdSignIn.Event(Click,cmdSignIn_Click)
Gui.fLogin.cmdSignIn.Enabled(True)
Gui.fLogin.cmdSignIn.Visible(True)
Gui.fLogin.cmdSignIn.Zorder(0)
Gui.fLogin.cmdSignIn.FontName("Tahoma")
Gui.fLogin.lblUsrName.Create(Label,"!",False,240,330,0,3870,255,True,0,"Arial",12,-2147483633,0,0)
Gui.fLogin.lblUsrName.ForeColor(255)
Gui.fLogin.lblUsrName.BorderStyle(0)
Gui.fLogin.lblPassWord.Create(Label,"!",False,240,330,0,3870,660,True,0,"Arial",12,-2147483633,0,0)
Gui.fLogin.lblPassWord.ForeColor(255)
Gui.fLogin.lblPassWord.BorderStyle(0)
Gui.FormMessageBox..Create(BaseForm)
Gui.FormMessageBox..Caption("Title")
Gui.FormMessageBox..Size(9915,2145)
Gui.FormMessageBox..MinX(0)
Gui.FormMessageBox..MinY(0)
Gui.FormMessageBox..Position(0,0)
Gui.FormMessageBox..AlwaysOnTop(True)
Gui.FormMessageBox..BackColor(-2147483633)
Gui.FormMessageBox..MaxButton(False)
Gui.FormMessageBox..MinButton(False)
Gui.FormMessageBox..MousePointer(0)
Gui.FormMessageBox..Sizeable(False)
Gui.FormMessageBox..Event(UnLoad,FormMessageBox_UnLoad)
Gui.FormMessageBox..FontName("Tahoma")
Gui.FormMessageBox..FontSize(8.25)
Gui.FormMessageBox..ControlBox(True)
Gui.FormMessageBox..Moveable(True)
Gui.FormMessageBox..ShowInTaskBar(True)
Gui.FormMessageBox..TitleBar(True)
Gui.FormMessageBox.lblMsgBox.Create(Label,"Message",True,9450,1245,0,105,165,True,2,"Arial",10,-2147483633,0,0)
Gui.FormMessageBox.lblMsgBox.ForeColor(16711680)
Gui.FormMessageBox.lblMsgBox.BorderStyle(0)
Gui.FormMessageBox.cmdMsgNo.Create(Button)
Gui.FormMessageBox.cmdMsgNo.Size(990,375)
Gui.FormMessageBox.cmdMsgNo.Position(8490,1425)
Gui.FormMessageBox.cmdMsgNo.Caption("No")
Gui.FormMessageBox.cmdMsgNo.Event(Click,cmdMsgNO_Click)
Gui.FormMessageBox.cmdMsgNo.Enabled(True)
Gui.FormMessageBox.cmdMsgNo.Visible(True)
Gui.FormMessageBox.cmdMsgNo.Zorder(0)
Gui.FormMessageBox.cmdMsgNo.FontName("Tahoma")
Gui.FormMessageBox.cmdMsgNo.FontSize(8.25)
Gui.FormMessageBox.cmdMsgYes.Create(Button)
Gui.FormMessageBox.cmdMsgYes.Size(990,375)
Gui.FormMessageBox.cmdMsgYes.Position(7365,1425)
Gui.FormMessageBox.cmdMsgYes.Caption("Yes")
Gui.FormMessageBox.cmdMsgYes.Event(Click,cmdMsgYes_Click)
Gui.FormMessageBox.cmdMsgYes.Enabled(True)
Gui.FormMessageBox.cmdMsgYes.Visible(True)
Gui.FormMessageBox.cmdMsgYes.Zorder(0)
Gui.FormMessageBox.cmdMsgYes.FontName("Tahoma")
Gui.FormMessageBox.cmdMsgYes.FontSize(8.25)
Program.Sub.ScreenSU.End

Program.Sub.Preflight.Start
V.Global.sMessageBoxReturn.Declare(String)
Variable.Global.dDate.Declare(Date,1/1/1900)
Variable.Global.sDetl.Declare(String)
Variable.Global.sTA.Declare(String)
Variable.Global.iChk.Declare(Long,0)
Variable.Global.iRun.Declare(Long,0)
Variable.Global.sUser.Declare(String)
Variable.Global.bAdminMode.Declare(Boolean,False)
Variable.Global.iBIRUNID.Declare(Long,0)
Variable.Global.iLogID.Declare(Long,0)
Variable.Global.bSaveMsg.Declare(boolean,false)
Variable.Global.bReady.Declare(boolean,false)
Program.External.Include.Library("JB0455.lib")
Program.Sub.Preflight.End

Program.Sub.Main.Start
'Developer: Angel Tudon
'Customer: L2 Aviation
'Ticket: https://www.gss-service.com/Calls/CallEditInternalOpen/1368701
'Quote: 14222 - 0
'Modification to original project adds project name, part, part description to the browser in both the main grid and the template browser. Also, addition of identical SO, WO, and Dept records are allowed when a different WC is attached to them.

F.Intrinsic.Control.SetErrorHandler("Main_Err")
F.Intrinsic.Control.ClearErrors

v.Local.sSql.Declare
v.Local.sCaption.Declare

F.Intrinsic.Control.CallSub(SetIcon)

F.Intrinsic.Control.SelectCase(V.Caller.Hook)
	F.Intrinsic.Control.Case(15710)
	Variable.Passed.000020.Set("Timesheet")
	
	F.Intrinsic.Control.Case(15770)
		F.Intrinsic.string.build("Select Distinct GS_USER from USER_INFORMATION where company = '{0}' or company_specific = 0",v.caller.CompanyCode,v.Local.sSql)
		F.ODBC.Connection!conx.OpenCommonConnection
		F.Intrinsic.Control.try	
			F.Data.DataTable.CreateFromSQL("USERDT","CONX",v.Local.sSql,true)
		F.Intrinsic.Control.Catch
			F.Intrinsic.UI.Msgbox("Oops! Something went wrong. Please contact Global Shop Solutions.")
		F.Intrinsic.Control.Finally
			F.ODBC.Connection!conx.Close
		F.Intrinsic.Control.EndTry
		F.Intrinsic.Control.If(v.DataTable.USERDT.Exists)
			F.Data.DataView.Create("USERDT","USERVw",22)
		F.Intrinsic.Control.EndIf
		
		F.Intrinsic.Control.CallSub(GetGSUserFromWindowsUser, "WindowsUser", V.System.UserName)
		
		F.Intrinsic.Control.If(V.Args.GSUser.Trim, =, "")
			GUI.fLogin..Show
		F.Intrinsic.Control.Else
			V.Global.sUser.Set(V.Args.GSUser.Trim)
			F.Intrinsic.Control.CallSub(PostSignIn)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CaseElse
		F.Intrinsic.Control.CallSub(PostSignIn)
		
F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Main_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.Main.End

Program.Sub.GetGSUserFromWindowsUser.Start
'check the windows user when launched from the GUI. If there is a GS User tied to that open the timesheet for them
'Otherwise they need to sign in
F.Intrinsic.Control.SetErrorHandler("GetGSUserFromWindowsUser_Err")
F.Intrinsic.Control.ClearErrors
	
V.Local.sWindowsUser.Declare(String)
V.Local.sGSUser.Declare(String)
V.Local.sSQL.Declare(String)
V.Local.bInString.Declare(Boolean)
V.Local.sMessage.Declare(String)
V.Local.sSplit.Declare(String)

V.Local.sWindowsUser.Set(V.Args.WindowsUser.Trim)
F.Intrinsic.String.Build("select USER_ID from USER_SECURITY where UPPER(WINDOW_USER) = '{0}'", V.Local.sWindowsUser.UCase, V.Local.sSQL)
F.ODBC.Connection!Com.OpenCommonConnection
F.ODBC.Connection!Com.ExecuteAndReturn(V.Local.sSQL, V.Local.sGSUser)
F.ODBC.Connection!Com.Close

F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
	V.Local.sGSUser.Set("")
F.Intrinsic.Control.EndIf

F.Intrinsic.String.IsInString(V.Local.sGSUser, "#$#", True, V.Local.bInString)
F.Intrinsic.Control.If(V.Local.bInString)
	F.Intrinsic.String.Build("Warning: Multiple GS Users with the windows username {0}. User will need to sign in.", V.Local.sWindowsUser, V.Local.sMessage)
	F.Intrinsic.UI.Msgbox(V.Local.sMessage)
	V.Local.sGSUser.Set("")
F.Intrinsic.Control.EndIf

F.Global.Security.GetUsernameFromID(V.Local.sGSUser, V.Local.sGSUser)
F.Intrinsic.Control.If(V.Local.sGSUser.IsNotNoReturn)
	F.Intrinsic.String.Split(V.Local.sGSUser, "*!*", V.Local.sSplit)
	V.Local.sGSUser.Set(V.Local.sSplit(0))
F.Intrinsic.Control.Else
	V.Local.sGSUser.Set("")
F.Intrinsic.Control.EndIf

F.Intrinsic.Variable.AddRV("GSUser", V.Local.sGSUser)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("GetGSUserFromWindowsUser_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.GetGSUserFromWindowsUser.End

Program.Sub.cmdSignIn_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdSignIn_Click_Err")
F.Intrinsic.Control.ClearErrors

v.Local.sFilter.Declare
v.Local.sPass.Declare
v.Local.sUser.Declare
v.Local.bLogin.Declare

GUI.fLogin..Enabled(False)
v.Local.sUser.Set(v.Screen.fLogin!txtUser.text)
v.Local.sPass.Set(v.Screen.fLogin!txtPassword.text)
F.Intrinsic.Control.If(v.Local.sUser.trim,=,"")
	F.Intrinsic.UI.Msgbox("Please enter a User Name to login.")
	GUI.fLogin.lblUsrName.Visible(True)
	GUI.fLogin..Enabled(True)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Else
	GUI.fLogin.lblUsrName.Visible(False)
F.Intrinsic.Control.EndIf
F.Intrinsic.String.Build("GS_USER = '{0}'",v.Local.sUser.UCase,v.Local.sFilter)
F.Data.DataView.SetFilter("USERDT","USERVw",v.Local.sFilter)
F.Intrinsic.Control.If(v.DataView.USERDT!USERVw.RowCount,=,0)
	F.Intrinsic.UI.Msgbox("Please enter a Valid User Name to login.")
	GUI.fLogin.lblUsrName.Visible(True)
	GUI.fLogin..Enabled(True)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Else
	GUI.fLogin.lblUsrName.Visible(False)
F.Intrinsic.Control.EndIf

F.Global.Security.ValidateUser(v.Caller.CompanyCode,v.Local.sUser.UCase,v.Local.sPass,v.Local.bLogin)
F.Intrinsic.Control.If(v.Local.bLogin)
	GUI.fLogin.lblPassWord.Visible(False)
	GUI.fLogin..Visible(False)
	v.Global.sUser.set(v.Local.sUser.UCase)
	F.Intrinsic.Control.CallSub(PostSignIn)
F.Intrinsic.control.Else
	F.Intrinsic.UI.Msgbox("Password is Incorrect. Please enter a Valid Password.")
	GUI.fLogin.lblPassWord.Visible(True)
	GUI.fLogin..Enabled(True)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdSignIn_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdSignIn_Click.End

Program.Sub.PostSignIn.Start
F.Intrinsic.Control.SetErrorHandler("PostSignIn_Err")
F.Intrinsic.Control.ClearErrors

F.ODBC.Connection!con.OpenCompanyConnection(7200)
'F.ODBC.Connection!con.OpenConnection(V.Ambient.PDSN,V.Ambient.PUser,V.Ambient.PPass,7200)
F.Intrinsic.Control.CallSub(Admin_mode)
F.Intrinsic.Control.CallSub(Dtpweek_change)

'F.data.dictionary.CreateFromSQL("DescDict","con","Select RTRIM(JOB) + RTRIM(SUFFIX) AS JS,DESCRIPTION from V_JOB_HEADER ")
'F.Data.Dictionary.SetDefaultReturn("DescDict","")
'F.data.dictionary.CreateFromSQL("FGDict","con","Select RTRIM(JOB) + RTRIM(SUFFIX) AS JS,PART from V_JOB_HEADER ")
'F.Data.Dictionary.SetDefaultReturn("FGDict","")
'F.Data.Dictionary.CreateFromSQL("dictSeqDesc", "Con", "Select RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) AS JSS, RTRIM(DESCRIPTION) as DESCRIPTION from V_JOB_OPERATIONS where LMO = 'L'")
'F.Data.Dictionary.SetDefaultReturn("dictSeqDesc", "")
'F.data.dictionary.CreateFromSQL("FGDict","con","Select Case When Suffix = '' or Suffix is null Then Job Else Job +'-'+Suffix End AS JS,PART from V_JOB_HEADER")
'F.Data.Dictionary.SetDefaultReturn("FGDict","")
'F.Data.Dictionary.CreateFromSQL("WCDESC","con","Select Machine, rtrim(WC_NAME) From WORKCENTERS")
F.Data.Dictionary.CreateFromSQL("WCDESC","con","Select LTRIM(RTRIM(Machine)), rtrim(WC_NAME) From WORKCENTERS")
F.Data.Dictionary.SetDefaultReturn("WCDESC","")

F.Data.Dictionary.CreateFromSQL("CustName","con","Select Order_No, B.Name_Customer From V_Order_Header A Join V_Customer_Master B on A.Customer = B.Customer Union Select Order_No, D.Name_Customer From V_Order_Hist_Head C Join V_Customer_Master D on C.Customer = D.Customer")
F.Data.Dictionary.SetDefaultReturn("CustName","")

F.Intrinsic.Control.CallSub(EmptyTotals)
F.Intrinsic.Control.CallSub(Gridload)

F.Intrinsic.Control.CallSub(Gridtitle)
F.Intrinsic.Control.CallSub(ComputeTotals)

GUI.FormTimesheet..Show

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("PostSignIn_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.PostSignIn.End

Program.Sub.fLogin_UnLoad.Start
F.Intrinsic.Control.SetErrorHandler("fLogin_UnLoad_Err")
F.Intrinsic.Control.ClearErrors

F.Intrinsic.Control.End

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("fLogin_UnLoad_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.fLogin_UnLoad.End

Program.Sub.dtpweek_change.Start
F.Intrinsic.Control.SetErrorHandler("dtpweek_change_Err")
F.Intrinsic.Control.ClearErrors

V.Local.dDate.Declare(Date)
V.Local.dCur.Declare(Date)
V.Local.dMin2.Declare(Date)

F.Intrinsic.Control.BlockEvents

F.Intrinsic.Date.BeginningOfWeek(V.Ambient.Date,V.Local.dCur)
F.Intrinsic.Date.DateAdd("D",-14,V.Local.dCur,V.Local.dMin2)

'get the date value from the screen and compute the beginning of the week for that data. in this case we are looking for the Monday of that week
V.Local.dDate.Set(V.Screen.FormTimesheet!dtpWeek.Value)
F.Intrinsic.Date.BeginningOfWeek(V.Local.dDate,V.Local.dDate)

F.Intrinsic.Control.If(V.Local.dDate,>=,V.Local.dMin2,"AND",V.Local.dDate,<=,V.Local.dCur)

	'set this as initial value
	GUI.FormTimesheet.dtpWeek.Value(V.Local.dDate)
F.Intrinsic.Control.Else
	F.Intrinsic.UI.Msgbox("Select Current week, previous week, or 2 weeks back.","Attention")
	GUI.FormTimesheet.dtpWeek.Value(V.Local.dCur)
F.Intrinsic.Control.EndIf

V.Global.dDate.Set(V.Screen.FormTimesheet!dtpWeek.Value)

Gui.FormTimesheet.txtASO.SetFocus

F.Intrinsic.Control.UnBlockEvents

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("dtpweek_change_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.dtpweek_change.End

Program.Sub.FormTimesheet_unload.Start
F.Intrinsic.Control.SetErrorHandler("FormTimesheet_unload_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sRet.Declare(String)
V.Local.sSQL.Declare(String)
v.Local.bReady.Declare(Boolean)
V.Local.sSerialize.Declare(String)

F.Intrinsic.String.Build("Select Distinct(Flag_Ready) as Flag_Ready from GCG_6667_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}' ORDER BY SALESORDER,WORKORDER,DEPT,WC",V.Global.sUser,V.Global.dDate.PervasiveDate,V.Local.sSql)
F.ODBC.Connection!con.OpenRecordsetRO("rst",V.Local.sSql)

F.Intrinsic.Control.DoUntil(V.ODBC.con!rst.EOF,=,"True")
	'check against the ready flag. If it's ready marked as true we are going to disable the save and enable the print.
	'and if we are not in admin mode.
	F.Intrinsic.Control.If(V.Global.bAdminMode,=,False)
		F.Intrinsic.Control.If(V.ODBC.con!rst.FieldValTrim!Flag_Ready,=,"True")
			V.Local.bReady.Set(True)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	F.ODBC.con!rst.MoveNext
F.Intrinsic.Control.Loop
F.ODBC.con!rst.Close

'check to see if the save varaible is true. this means changes were made and it asks if the user wants to save changes before exiting the application
f.Intrinsic.Control.If(v.DataTable.dtTimesheet.RowCount,>,0,"AND",v.Global.bAdminMode,=,false,v.Global.bSaveMsg,=,true)
	f.Intrinsic.Control.If(V.Local.bReady,=,false)
		F.Intrinsic.UI.Msgbox("Do you wish to save existing data before exiting?","Save Data?",3,V.Local.sRet)
		F.Intrinsic.Control.If(v.Local.sRet,=,2)
			F.Intrinsic.Control.ExitSub
		F.Intrinsic.Control.ElseIf(v.Local.sRet,=,6)
			v.Global.bSaveMsg.Set(false)
			F.Intrinsic.Control.CallSub(cmdsave_click)	
			v.Global.bSaveMsg.Set(false)
		F.Intrinsic.Control.Else
			v.Global.bSaveMsg.Set(false)			
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

GUI.FormTimesheet.gsgcTimesheet.Serialize("gvTimesheet", V.Local.sSerialize)
F.Global.Registry.AddValue(V.Caller.User, V.Caller.CompanyCode, "gvTimesheet", 6667, 1000, False, "Serialize", False, 0, -999.0 , 1/1/1980, 12:00:00 AM, V.Local.sSerialize)

F.ODBC.Connection!con.Close
F.Intrinsic.Control.End

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("FormTimesheet_unload_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.FormTimesheet_unload.End

Program.Sub.GridTitle.Start
F.Intrinsic.Control.SetErrorHandler("GridTitle_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sDate.Declare(String)
V.Local.dDate.Declare(String)
V.Local.iRow.Declare(Long)
V.Local.sSql.Declare(String)
V.Local.sWC.Declare(STring)
V.Local.iSun.Declare(Long)
V.Local.iMon.Declare(Long)
V.Local.iTue.Declare(Long)
V.Local.iWed.Declare(Long)
V.Local.iThu.Declare(Long)
V.Local.iFri.Declare(Long)
V.Local.iSat.Declare(Long)

'Set Table Header for Main Screen.
'set the header captions and column widths
F.Intrinsic.Control.BlockEvents
GUI.FormTimesheet.gsgcTimesheet.SuspendLayout

F.Intrinsic.String.Build("Sun: {0}",V.Global.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUNDAY_HOURS_EDIT","caption",v.Local.sDate)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUNDAY_HOURS_EDIT","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUNDAY_HOURS_EDIT","MaxWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUNDAY_HOURS_EDIT","Width", 60)
V.Local.sDate.Append(" (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS", "AllowShowHide", False)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","MaxWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","Width", 60)

F.Intrinsic.Date.DateAdd("D",1,V.Global.dDate,V.local.dDate)
F.Intrinsic.String.Build("Mon: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MONDAY_HOURS_EDIT","caption",v.Local.sDate)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MONDAY_HOURS_EDIT","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MONDAY_HOURS_EDIT","MaxWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MONDAY_HOURS_EDIT","Width", 60)
V.Local.sDate.Append(" (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS", "AllowShowHide", False)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","MaxWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","Width", 60)

F.Intrinsic.Date.DateAdd("D",1,V.local.dDate,V.Local.dDate)
F.Intrinsic.String.Build("Tues: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUESDAY_HOURS_EDIT","caption",v.Local.sDate)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUESDAY_HOURS_EDIT","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUESDAY_HOURS_EDIT","MaxWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUESDAY_HOURS_EDIT","Width", 60)
V.Local.sDate.Append(" (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS", "AllowShowHide", False)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","MaxWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","Width", 60)

F.Intrinsic.Date.DateAdd("D",1,V.Local.dDate,V.Local.dDate)
F.Intrinsic.String.Build("Wed: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WEDNESDAY_HOURS_EDIT","caption",v.Local.sDate)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WEDNESDAY_HOURS_EDIT","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WEDNESDAY_HOURS_EDIT","MaxWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WEDNESDAY_HOURS_EDIT","Width", 60)
V.Local.sDate.Append(" (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS", "AllowShowHide", False)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","MaxWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","Width", 60)

F.Intrinsic.Date.DateAdd("D",1,V.Local.dDate,V.Local.dDate)
F.Intrinsic.String.Build("Thur: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THURSDAY_HOURS_EDIT","caption",v.Local.sDate)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THURSDAY_HOURS_EDIT","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THURSDAY_HOURS_EDIT","MaxWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THURSDAY_HOURS_EDIT","Width", 60)
V.Local.sDate.Append(" (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS", "AllowShowHide", False)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","MaxWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","Width", 60)

F.Intrinsic.Date.DateAdd("D",1,V.Local.dDate,V.Local.dDate)
F.Intrinsic.String.Build("Fri: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRIDAY_HOURS_EDIT","caption",v.Local.sDate)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRIDAY_HOURS_EDIT","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRIDAY_HOURS_EDIT","MaxWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRIDAY_HOURS_EDIT","Width", 60)
V.Local.sDate.Append(" (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS", "AllowShowHide", False)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","MaxWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","Width", 60)

F.Intrinsic.Date.DateAdd("D",1,V.Local.dDate,V.Local.dDate)
F.Intrinsic.String.Build("Sat: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SATURDAY_HOURS_EDIT","caption",v.Local.sDate)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SATURDAY_HOURS_EDIT","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SATURDAY_HOURS_EDIT","MaxWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SATURDAY_HOURS_EDIT","Width", 60)
V.Local.sDate.Append(" (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS", "AllowShowHide", False)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","MinWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","MaxWidth", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","Width", 60)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_SUM","caption","WC Total (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","UPDATED","Caption", "Submitted")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "JOB_TOTAL_TIME", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "JOB_TOTAL_TIME", "AllowShowHide", False)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "ReadOnly", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "ReadOnly", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "ReadOnly", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "ReadOnly", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "ReadOnly", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "ReadOnly", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "ReadOnly", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","UPDATED","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","UPDATED","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Delete","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Delete","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.ColumnEdit("gvTimesheet","Delete","EditorButton","Delete")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SALESORDER","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SALESORDER","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_SUM","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_SUM","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_TOTAL_TIME","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_TOTAL_TIME","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WORKORDER","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WORKORDER","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","DEPT","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","DEPT","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","NAME_CUSTOMER","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","NAME_CUSTOMER","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC_DESC","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC_DESC","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_NOTES","allowedit", true)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","USER_ID","caption","User")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","USER_ID","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","USER_ID","allowedit", false)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FLAG_READY","Caption", "Ready")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FLAG_READY","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FLAG_READY","allowedit", false)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "EditMask", "#0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "EditMask", "#0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "EditMask", "#0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "EditMask", "#0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "EditMask", "#0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "EditMask", "#0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "EditMask", "#0.00")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SALESORDER","caption","Sales Order")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WORKORDER","caption","Work Order")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","DEPT","caption","Dept.")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","NAME_CUSTOMER","caption","Customer")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC_DESC","caption","WC Description")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","caption","WC")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_NOTES","caption","Sun Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_NOTES","caption","Mon Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_NOTES","caption","Tues Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_NOTES","caption","Wed Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_NOTES","caption","Th Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_NOTES","caption","Fri Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_NOTES","caption","Sat Notes")

GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "SUNDAY_HOURS_EDIT", "Condition1", "NotEqual", "0")
GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "Condition1", "FontBold", True)
GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "MONDAY_HOURS_EDIT", "Condition2", "NotEqual", "0")
GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "Condition2", "FontBold", True)
GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "TUESDAY_HOURS_EDIT", "Condition3", "NotEqual", "0")
GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "Condition3", "FontBold", True)
GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "Condition4", "NotEqual", "0")
GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "Condition4", "FontBold", True)
GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "THURSDAY_HOURS_EDIT", "Condition5", "NotEqual", "0")
GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "Condition5", "FontBold", True)
GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "FRIDAY_HOURS_EDIT", "Condition6", "NotEqual", "0")
GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "Condition6", "FontBold", True)
GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "SATURDAY_HOURS_EDIT", "Condition7", "NotEqual", "0")
GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "Condition7", "FontBold", True)

GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "JOB_SUM", "Condition8", "NotEqual", "0")
GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "JOB_SUM", "Condition8", "FontBold", True)

GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "Flag_Ready", "Condition9", "Expression","FLAG_READY = TRUE AND UPDATED = FALSE")
GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "Flag_Ready", "Condition9", "BackColor", "#90ee90")
Gui.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet","Flag_Ready","Condition9","ApplyToRow",True)

GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "Updated", "Condition10", "Equal",TRUE)
GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "Updated", "Condition10", "BackColor", "#9dceea")
Gui.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet","Updated","Condition10","ApplyToRow",True)

v.Local.sSQL.Set("select distinct MACHINE from WORKCENTERS")
F.data.DataTable.CreateFromSQL("WCDT","con",v.Local.sSQL)
F.Data.Dataview.Create("WCDT","WCDTVW",22)
F.data.DataView.ToString("WCDT","WCDTVW","MACHINE","@!@","*!*",v.Local.sWC)
F.Data.DataView.Close("WCDT","WCDTVW")
F.Data.DataTable.Close("WCDT")

GUI.FormTimesheet.gsgcTimesheet.ColumnEdit("gvTimesheet","WC","Dropdownlist",v.Local.sWC)

Gui.FormTimesheet.gsgcTimesheet.GetColumnIndexByName("gvTimesheet","SUNDAY_HOURS_EDIT",V.Local.iSun)
Gui.FormTimesheet.gsgcTimesheet.GetColumnIndexByName("gvTimesheet","MONDAY_HOURS_EDIT",V.Local.iMon)
Gui.FormTimesheet.gsgcTimesheet.GetColumnIndexByName("gvTimesheet","TUESDAY_HOURS_EDIT",V.Local.iTue)
Gui.FormTimesheet.gsgcTimesheet.GetColumnIndexByName("gvTimesheet","WEDNESDAY_HOURS_EDIT",V.Local.iWed)
Gui.FormTimesheet.gsgcTimesheet.GetColumnIndexByName("gvTimesheet","THURSDAY_HOURS_EDIT",V.Local.iThu)
Gui.FormTimesheet.gsgcTimesheet.GetColumnIndexByName("gvTimesheet","FRIDAY_HOURS_EDIT",V.Local.iFri)
Gui.FormTimesheet.gsgcTimesheet.GetColumnIndexByName("gvTimesheet","SATURDAY_HOURS_EDIT",V.Local.iSat)

F.Intrinsic.Control.For(V.Local.iRow,0,V.DataTable.dtTimesheet.RowCount--,1)
	F.Intrinsic.Control.If(V.DataTable.dtTimesheet(V.Local.iRow).Updated!FieldVal,=,False,"AND",V.DataTable.dtTimesheet(V.Local.iRow).Flag_Ready!FieldVal,=,False)
		Gui.FormTimesheet.gsgcTimesheet.SetCellProperty("gvTimesheet",V.Local.iSun,V.Local.iRow,"Locked",False)
		Gui.FormTimesheet.gsgcTimesheet.SetCellProperty("gvTimesheet",V.Local.iMon,V.Local.iRow,"Locked",False)
		Gui.FormTimesheet.gsgcTimesheet.SetCellProperty("gvTimesheet",V.Local.iTue,V.Local.iRow,"Locked",False)
		Gui.FormTimesheet.gsgcTimesheet.SetCellProperty("gvTimesheet",V.Local.iWed,V.Local.iRow,"Locked",False)
		Gui.FormTimesheet.gsgcTimesheet.SetCellProperty("gvTimesheet",V.Local.iThu,V.Local.iRow,"Locked",False)
		Gui.FormTimesheet.gsgcTimesheet.SetCellProperty("gvTimesheet",V.Local.iFri,V.Local.iRow,"Locked",False)
		Gui.FormTimesheet.gsgcTimesheet.SetCellProperty("gvTimesheet",V.Local.iSat,V.Local.iRow,"Locked",False)
	F.Intrinsic.Control.ElseIf(V.DataTable.dtTimesheet(V.Local.iRow).Updated!FieldVal,=,False,"AND",V.DataTable.dtTimesheet(V.Local.iRow).Flag_Ready!FieldVal,=,True)
		F.Intrinsic.Control.If(V.Global.bAdminMode)
			Gui.FormTimesheet.gsgcTimesheet.SetCellProperty("gvTimesheet",V.Local.iSun,V.Local.iRow,"Locked",False)
			Gui.FormTimesheet.gsgcTimesheet.SetCellProperty("gvTimesheet",V.Local.iMon,V.Local.iRow,"Locked",False)
			Gui.FormTimesheet.gsgcTimesheet.SetCellProperty("gvTimesheet",V.Local.iTue,V.Local.iRow,"Locked",False)
			Gui.FormTimesheet.gsgcTimesheet.SetCellProperty("gvTimesheet",V.Local.iWed,V.Local.iRow,"Locked",False)
			Gui.FormTimesheet.gsgcTimesheet.SetCellProperty("gvTimesheet",V.Local.iThu,V.Local.iRow,"Locked",False)
			Gui.FormTimesheet.gsgcTimesheet.SetCellProperty("gvTimesheet",V.Local.iFri,V.Local.iRow,"Locked",False)
			Gui.FormTimesheet.gsgcTimesheet.SetCellProperty("gvTimesheet",V.Local.iSat,V.Local.iRow,"Locked",False)
		F.Intrinsic.Control.Else
			Gui.FormTimesheet.gsgcTimesheet.SetCellProperty("gvTimesheet",V.Local.iSun,V.Local.iRow,"Locked",True)
			Gui.FormTimesheet.gsgcTimesheet.SetCellProperty("gvTimesheet",V.Local.iMon,V.Local.iRow,"Locked",True)
			Gui.FormTimesheet.gsgcTimesheet.SetCellProperty("gvTimesheet",V.Local.iTue,V.Local.iRow,"Locked",True)
			Gui.FormTimesheet.gsgcTimesheet.SetCellProperty("gvTimesheet",V.Local.iWed,V.Local.iRow,"Locked",True)
			Gui.FormTimesheet.gsgcTimesheet.SetCellProperty("gvTimesheet",V.Local.iThu,V.Local.iRow,"Locked",True)
			Gui.FormTimesheet.gsgcTimesheet.SetCellProperty("gvTimesheet",V.Local.iFri,V.Local.iRow,"Locked",True)
			Gui.FormTimesheet.gsgcTimesheet.SetCellProperty("gvTimesheet",V.Local.iSat,V.Local.iRow,"Locked",True)
		F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.ElseIf(V.DataTable.dtTimesheet(V.Local.iRow).Updated!FieldVal,=,True)
		Gui.FormTimesheet.gsgcTimesheet.SetCellProperty("gvTimesheet",V.Local.iSun,V.Local.iRow,"Locked",True)
		Gui.FormTimesheet.gsgcTimesheet.SetCellProperty("gvTimesheet",V.Local.iMon,V.Local.iRow,"Locked",True)
		Gui.FormTimesheet.gsgcTimesheet.SetCellProperty("gvTimesheet",V.Local.iTue,V.Local.iRow,"Locked",True)
		Gui.FormTimesheet.gsgcTimesheet.SetCellProperty("gvTimesheet",V.Local.iWed,V.Local.iRow,"Locked",True)
		Gui.FormTimesheet.gsgcTimesheet.SetCellProperty("gvTimesheet",V.Local.iThu,V.Local.iRow,"Locked",True)
		Gui.FormTimesheet.gsgcTimesheet.SetCellProperty("gvTimesheet",V.Local.iFri,V.Local.iRow,"Locked",True)
		Gui.FormTimesheet.gsgcTimesheet.SetCellProperty("gvTimesheet",V.Local.iSat,V.Local.iRow,"Locked",True)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Next(V.Local.iRow)

F.Intrinsic.Control.UnBlockEvents
GUI.FormTimesheet.gsgcTimesheet.ResumeLayout

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("GridTitle_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.GridTitle.End

Program.Sub.cmdrefresh_click.Start
F.Intrinsic.Control.SetErrorHandler("cmdrefresh_click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sSerialize.Declare(String)

GUI.FormTimesheet.gsgcTimesheet.Serialize("gvTimesheet", V.Local.sSerialize)
F.Global.Registry.AddValue(V.Caller.User, V.Caller.CompanyCode, "gvTimesheet", 6667, 1000, False, "Serialize", False, 0, -999.0 , 1/1/1980, 12:00:00 AM, V.Local.sSerialize)

v.Global.bSaveMsg.Set(false)
F.Intrinsic.Control.CallSub(EmptyTotals)
F.Intrinsic.Control.CallSub(Gridload)
F.Intrinsic.Control.CallSub(Gridtitle)
F.Intrinsic.Control.CallSub(ComputeTotals)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdrefresh_click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdrefresh_click.End

Program.Sub.GridLoad.Start
F.Intrinsic.Control.SetErrorHandler("GridLoad_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sJSS.Declare(String)
V.Local.sJS.Declare(String)
V.Local.sJob.Declare(String)
V.Local.sSeq.Declare(String)
V.Local.sSuffix.Declare(String)
V.Local.sSql.Declare(String)
V.Local.iUB.Declare(Long)
V.Local.i.Declare(Long)
V.Local.iCheck.Declare(Long)
V.Local.bReady.Declare
v.Local.sWC.Declare(String)
V.Local.bUpdated.Declare(Boolean, False)
V.Local.sDept.Declare(String)
V.Local.sSerialize.Declare(String)
V.Local.sSOTemp.Declare(String)
V.Local.sDeptTemp.Declare(String)
V.Local.sWCTemp.Declare(String)
V.Local.sUserTemp.Declare(String)
V.Local.sTemp.Declare(String)
V.Local.sWOTemp.Declare(String)

V.Local.sDeptTemp.Set(V.Screen.FormTimesheet!txtADept.Text)
V.Local.sSOTemp.Set(V.Screen.FormTimesheet!txtASO.Text)
V.Local.sWCTemp.Set(V.Screen.FormTimesheet!txtWC.Text)
V.Local.sUserTemp.Set(V.Screen.FormTimesheet!txtUser.Text)
V.Local.sWOTemp.Set(V.Screen.FormTimesheet!txtAWO.Text)

GUI.FormTimesheet.gsgcTimesheet.Visible(False)

V.Local.bReady.Set(False)
V.Local.bUpdated.Set(False)
F.Intrinsic.Control.BlockEvents
GUI.FormTimesheet.gsgcTimesheet.SuspendLayout

F.Intrinsic.Control.If(V.Global.bAdminMode,=,False)
	'check for updated records for that week. 
	F.Intrinsic.String.Build("Select UPDATED from GCG_6667_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}' AND UPDATED = '1'",V.Global.sUser,V.Global.dDate.PervasiveDate,V.Local.sSql)
	F.ODBC.Connection!con.OpenRecordsetRO("rstChk",V.Local.sSql)
	F.Intrinsic.Control.If(v.DataTable.dtTimesheet.exists,=,true)
		F.Data.DataTable.Close("dtTimesheet")
	F.Intrinsic.Control.EndIf
	
	'if no updated records
	F.Intrinsic.Control.If(V.ODBC.con!rstChk.EOF,=,True)
		'build empty datatable using filler values
	'	F.Intrinsic.String.Build("Select JOB, SUFFIX, SEQ,RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) AS JSS,RTRIM(JOB) + RTRIM(SUFFIX) AS JS,RTRIM(' ') as DESCRIPTION,RTRIM(' ') as PART,RTRIM(' ') as WC, CAST(0 AS DOUBLE) AS SUN_HRS,CAST(' ' as LONGVARCHAR) as SUN_NOTES, CAST(0 AS DOUBLE) AS MON_HRS,CAST(' ' as LONGVARCHAR) as MON_NOTES, CAST(0 AS DOUBLE) AS TUES_HRS,CAST(' ' as LONGVARCHAR)  as TUES_NOTES, CAST(0 AS DOUBLE) AS WED_HRS,CAST(' ' as LONGVARCHAR)  as WED_NOTES, CAST(0 AS DOUBLE) AS THUR_HRS,CAST(' ' as LONGVARCHAR)  as THUR_NOTES, CAST(0 AS DOUBLE) AS FRI_HRS,CAST(' ' as LONGVARCHAR)  as FRI_NOTES, CAST(0 AS DOUBLE) AS SAT_HRS,CAST(' ' as LONGVARCHAR)  as SAT_NOTES,CAST(0 AS BIT) AS UPDATED,CAST(0 AS BIT) AS FLAG_READY,CAST('A' as  CHAR(1)) as Wrapper  from GCG_6667_TIMSHT where UPPER(USER_ID) = 'XXXXXXX{0}' ORDER BY JOB,SUFFIX, SEQ",v.Ambient.null,V.Local.sSql)
		F.Intrinsic.String.Build("Select USER_ID, SALESORDER, WORKORDER, DEPT,RTRIM(' ') as NAME_CUSTOMER,RTRIM(' ') as WC, CAST(0 AS DOUBLE) AS SUN_HRS,CAST(' ' as LONGVARCHAR) as SUN_NOTES, CAST(0 AS DOUBLE) AS MON_HRS,CAST(' ' as LONGVARCHAR) as MON_NOTES, CAST(0 AS DOUBLE) AS TUES_HRS,CAST(' ' as LONGVARCHAR)  as TUES_NOTES, CAST(0 AS DOUBLE) AS WED_HRS,CAST(' ' as LONGVARCHAR)  as WED_NOTES, CAST(0 AS DOUBLE) AS THUR_HRS,CAST(' ' as LONGVARCHAR)  as THUR_NOTES, CAST(0 AS DOUBLE) AS FRI_HRS,CAST(' ' as LONGVARCHAR)  as FRI_NOTES, CAST(0 AS DOUBLE) AS SAT_HRS,CAST(' ' as LONGVARCHAR)  as SAT_NOTES,CAST(0 AS BIT) AS UPDATED,CAST(0 AS BIT) AS FLAG_READY,CAST('A' as  CHAR(1)) as Wrapper  from GCG_6667_TIMSHT where UPPER(USER_ID) = 'XXXXXXX{0}' ORDER BY SALESORDER",v.Ambient.null,V.Local.sSql)
		F.Data.DataTable.CreateFromSQL("dtTimesheet","con",V.Local.sSql,true)
	
		'get all records fromso we can go and set thre ready flag
	'	F.Intrinsic.String.Build("Select * from GCG_6667_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}' ORDER BY JOB, SUFFIX, SEQ",V.Global.sUser,V.Global.dDate.PervasiveDate,V.Local.sSql)
		F.Intrinsic.String.Build("Select * from GCG_6667_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}' ORDER BY SALESORDER,WORKORDER,DEPT,WC",V.Global.sUser,V.Global.dDate.PervasiveDate,V.Local.sSql)
		F.ODBC.Connection!con.OpenRecordsetRO("rst",V.Local.sSql)
	
		F.Intrinsic.Control.DoUntil(V.ODBC.con!rst.EOF,=,"True")
	
			F.Intrinsic.Control.If(V.ODBC.con!rst.FieldValTrim!Flag_Ready,=,"True")
				V.Local.bReady.Set(True)
			F.Intrinsic.Control.EndIf
				
			F.Intrinsic.Control.If(V.ODBC.con!rst.FieldVal!UPDATED,=,"True")
				V.Local.bUpdated.Set(True)
			F.Intrinsic.Control.EndIf
	
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet.exists,=,True)
				
				'add row if exists
	'			F.intrinsic.String.Concat(V.ODBC.con!rst.FieldValTrim!JOB,V.ODBC.con!rst.FieldValTrim!SUFFIX,V.ODBC.con!rst.FieldValTrim!SEQ,v.Local.sJSS)
	'			F.intrinsic.String.Concat(V.ODBC.con!rst.FieldValTrim!JOB,V.ODBC.con!rst.FieldValTrim!SUFFIX,v.Local.sJS)
	'			F.Data.DataTable.AddRow("dtTimesheet","JSS",v.Local.sJSS,"JS",v.Local.sJS,"Job",V.ODBC.con!rst.FieldValTrim!JOB,"Suffix",V.ODBC.con!rst.FieldValTrim!SUFFIX,"Seq",V.ODBC.con!rst.FieldValTrim!SEQ,"WC",V.ODBC.con!rst.FieldValTrim!WC,"SUN_HRS",V.ODBC.con!rst.FieldVal!SUN_HRS,"MON_HRS",V.ODBC.con!rst.FieldVal!MON_HRS,"TUES_HRS",V.ODBC.con!rst.FieldVal!TUES_HRS,"WED_HRS",V.ODBC.con!rst.FieldVal!WED_HRS,"THUR_HRS",V.ODBC.con!rst.FieldVal!THUR_HRS,"FRI_HRS",V.ODBC.con!rst.FieldVal!FRI_HRS,"SAT_HRS",V.ODBC.con!rst.FieldVal!SAT_HRS,"SUN_NOTES",V.ODBC.con!rst.FieldVal!SUN_NOTES,"MON_NOTES",V.ODBC.con!rst.FieldVal!MON_NOTES,"TUES_NOTES",V.ODBC.con!rst.FieldVal!TUES_NOTES,"WED_NOTES",V.ODBC.con!rst.FieldVal!WED_NOTES,"THUR_NOTES",V.ODBC.con!rst.FieldVal!THUR_NOTES,"FRI_NOTES",V.ODBC.con!rst.FieldVal!FRI_NOTES,"SAT_NOTES",V.ODBC.con!rst.FieldVal!SAT_NOTES,"UPDATED",V.ODBC.con!rst.FieldVal!UPDATED,"FLAG_READY",V.ODBC.con!rst.FieldVal!FLAG_READY,"WRAPPER","A")
				F.Data.DataTable.AddRow("dtTimesheet","USER_ID",V.ODBC.con!rst.FieldValTrim!USER_ID,"SALESORDER",V.ODBC.con!rst.FieldValTrim!SALESORDER,"WORKORDER",V.ODBC.con!rst.FieldValTrim!WORKORDER,"DEPT",V.ODBC.con!rst.FieldValTrim!DEPT,"WC",V.ODBC.con!rst.FieldValTrim!WC,"SUN_HRS",V.ODBC.con!rst.FieldVal!SUN_HRS,"MON_HRS",V.ODBC.con!rst.FieldVal!MON_HRS,"TUES_HRS",V.ODBC.con!rst.FieldVal!TUES_HRS,"WED_HRS",V.ODBC.con!rst.FieldVal!WED_HRS,"THUR_HRS",V.ODBC.con!rst.FieldVal!THUR_HRS,"FRI_HRS",V.ODBC.con!rst.FieldVal!FRI_HRS,"SAT_HRS",V.ODBC.con!rst.FieldVal!SAT_HRS,"SUN_NOTES",V.ODBC.con!rst.FieldVal!SUN_NOTES,"MON_NOTES",V.ODBC.con!rst.FieldVal!MON_NOTES,"TUES_NOTES",V.ODBC.con!rst.FieldVal!TUES_NOTES,"WED_NOTES",V.ODBC.con!rst.FieldVal!WED_NOTES,"THUR_NOTES",V.ODBC.con!rst.FieldVal!THUR_NOTES,"FRI_NOTES",V.ODBC.con!rst.FieldVal!FRI_NOTES,"SAT_NOTES",V.ODBC.con!rst.FieldVal!SAT_NOTES,"UPDATED",V.ODBC.con!rst.FieldVal!UPDATED,"FLAG_READY",V.ODBC.con!rst.FieldVal!FLAG_READY,"WRAPPER","A")
			F.Intrinsic.Control.Else
				'create dtTimesheet
	'			F.Intrinsic.String.Build("Select RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) AS JSS, RTRIM(JOB) + RTRIM(SUFFIX) AS JS, JOB, SUFFIX, SEQ,RTRIM(' ') as DESCRIPTION,RTRIM(' ') as PART,WC,SUN_HRS,SUN_NOTES, MON_HRS,MON_NOTES, TUES_HRS,TUES_NOTES, WED_HRS,WED_NOTES, THUR_HRS,THUR_NOTES, FRI_HRS,FRI_NOTES, SAT_HRS,SAT_NOTES,UPDATED,FLAG_READY,CAST('A' as CHAR(1)) as Wrapper   from GCG_6667_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}' AND JOB = '{2}' AND SUFFIX = '{3}' AND SEQ = '{4}'",V.Global.sUser,V.Global.dDate.PervasiveDate,V.ODBC.con!rst.FieldValTrim!JOB,V.ODBC.con!rst.FieldValTrim!SUFFIX,V.ODBC.con!rst.FieldValTrim!SEQ,V.Local.sSql)
				F.Intrinsic.String.Build("Select USER_ID, SALESORDER, WORKORDER, DEPT,RTRIM(' ') as DESCRIPTION,WC,SUN_HRS,SUN_NOTES, MON_HRS,MON_NOTES, TUES_HRS,TUES_NOTES, WED_HRS,WED_NOTES, THUR_HRS,THUR_NOTES, FRI_HRS,FRI_NOTES, SAT_HRS,SAT_NOTES,UPDATED,FLAG_READY,CAST('A' as CHAR(1)) as Wrapper   from GCG_6667_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}' AND SALESORDER = '{2}'",V.Global.sUser,V.Global.dDate.PervasiveDate,V.Screen.FormTimesheet!txtASO.Text,V.Local.sSql)
				F.DATA.DataTable.CreateFromSQL("dtTimesheet","con",V.Local.sSql,true)
	
			F.Intrinsic.Control.EndIf
	
			F.ODBC.con!rst.MoveNext
		F.Intrinsic.Control.Loop
		F.ODBC.con!rst.Close
	
		GUI.FormTimesheet.cmdSave.Enabled(True)
		GUI.FormTimesheet.cmdAdd.Enabled(True)
		GUI.FormTimesheet.cmdFrmTemp.Enabled(True)
		GUI.FormTimesheet.cmdUpdate.Enabled(True)
		gui.FormTimesheet.cmdAddSOBrows.Enabled(True)
		gui.FormTimesheet.cmdAddDeptBrows.Enabled(True)
		GUI.FormTimesheet.gsgcTimesheet.Enabled(True)
	F.Intrinsic.Control.Else
		'if there are updated records
	'	F.Intrinsic.String.Build("Select Distinct(Flag_Ready) as Flag_Ready, UPDATED from GCG_6667_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}' ORDER BY JOB, SUFFIX, SEQ",V.Global.sUser,V.Global.dDate.PervasiveDate,V.Local.sSql)
		F.Intrinsic.String.Build("Select Distinct(Flag_Ready) as Flag_Ready, UPDATED from GCG_6667_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}' ORDER BY SALESORDER,WORKORDER,DEPT,WC",V.Global.sUser,V.Global.dDate.PervasiveDate,V.Local.sSql)
			F.ODBC.Connection!con.OpenRecordsetRO("rst",V.Local.sSql)
		'set ready flag to enable ready button
		F.Intrinsic.Control.DoUntil(V.ODBC.con!rst.EOF,=,"True")
	
			F.Intrinsic.Control.If(V.Global.bAdminMode,=,False)
				F.Intrinsic.Control.If(V.ODBC.con!rst.FieldValTrim!Flag_Ready,=,"True")
	
					V.Local.bReady.Set(True)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.Control.If(V.ODBC.con!rst.FieldVal!UPDATED,=,"True")
					V.Local.bUpdated.Set(True)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			
			F.ODBC.con!rst.MoveNext
		F.Intrinsic.Control.Loop
		F.ODBC.con!rst.Close
		F.Intrinsic.String.Build("Select * from GCG_6667_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}' ORDER BY SALESORDER,WORKORDER,DEPT,WC",V.Global.sUser,V.Global.dDate.PervasiveDate,V.Local.sSql)
		F.ODBC.Connection!con.OpenRecordsetRO("rst",V.Local.sSql)
	
		F.Intrinsic.Control.DoUntil(V.ODBC.con!rst.EOF,=,"True")
			F.Intrinsic.Control.If(v.DataTable.dtTimesheet.exists,=,True)
	'			F.intrinsic.String.Concat(V.ODBC.con!rst.FieldValTrim!JOB,V.ODBC.con!rst.FieldValTrim!SUFFIX,V.ODBC.con!rst.FieldValTrim!SEQ,v.Local.sJSS)
	'			F.intrinsic.String.Concat(V.ODBC.con!rst.FieldValTrim!JOB,V.ODBC.con!rst.FieldValTrim!SUFFIX,v.Local.sJS)
	'			F.Data.DataTable.AddRow("dtTimesheet","JSS",v.Local.sJSS,"JS",v.Local.sJS,"Job",V.ODBC.con!rst.FieldValTrim!JOB,"Suffix",V.ODBC.con!rst.FieldValTrim!SUFFIX,"SEQ",V.ODBC.con!rst.FieldValTrim!SEQ,"WC",V.ODBC.con!rst.FieldValTrim!WC,"SUN_HRS",V.ODBC.con!rst.FieldVal!SUN_HRS,"MON_HRS",V.ODBC.con!rst.FieldVal!MON_HRS,"TUES_HRS",V.ODBC.con!rst.FieldVal!TUES_HRS,"WED_HRS",V.ODBC.con!rst.FieldVal!WED_HRS,"THUR_HRS",V.ODBC.con!rst.FieldVal!THUR_HRS,"FRI_HRS",V.ODBC.con!rst.FieldVal!FRI_HRS,"SAT_HRS",V.ODBC.con!rst.FieldVal!SAT_HRS,"UPDATED",V.ODBC.con!rst.FieldVal!UPDATED,"FLAG_READY",V.ODBC.con!rst.FieldVal!FLAG_READY,"WRAPPER","A")
				F.Data.DataTable.AddRow("dtTimesheet","USER_ID",V.ODBC.con!rst.FieldValTrim!USER_ID,"SALESORDER",V.ODBC.con!rst.FieldValTrim!SALESORDER,"WORKORDER",V.ODBC.con!rst.FieldValTrim!WORKORDER,"DEPT",V.ODBC.con!rst.FieldValTrim!DEPT,"WC",V.ODBC.con!rst.FieldValTrim!WC,"SUN_HRS",V.ODBC.con!rst.FieldVal!SUN_HRS,"MON_HRS",V.ODBC.con!rst.FieldVal!MON_HRS,"TUES_HRS",V.ODBC.con!rst.FieldVal!TUES_HRS,"WED_HRS",V.ODBC.con!rst.FieldVal!WED_HRS,"THUR_HRS",V.ODBC.con!rst.FieldVal!THUR_HRS,"FRI_HRS",V.ODBC.con!rst.FieldVal!FRI_HRS,"SAT_HRS",V.ODBC.con!rst.FieldVal!SAT_HRS,"UPDATED",V.ODBC.con!rst.FieldVal!UPDATED,"FLAG_READY",V.ODBC.con!rst.FieldVal!FLAG_READY,"WRAPPER","A")
			F.Intrinsic.Control.Else
	'			F.Intrinsic.String.Build("Select RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) AS JSS,RTRIM(JOB) + RTRIM(SUFFIX) AS JS, JOB, SUFFIX, SEQ,RTRIM(' ') as DESCRIPTION,RTRIM(' ') as PART,WC,MON_HRS,MON_NOTES, TUES_HRS,TUES_NOTES, WED_HRS,WED_NOTES, THUR_HRS,THUR_NOTES, FRI_HRS,FRI_NOTES, SAT_HRS,SAT_NOTES,SUN_HRS,SUN_NOTES,UPDATED,FLAG_READY,CAST('A' as CHAR(1)) as Wrapper from GCG_6667_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}' AND JOB = '{2}' AND SUFFIX = '{3}' AND SEQ = '{4}'",V.Global.sUser,V.Global.dDate.PervasiveDate,V.ODBC.con!rst.FieldValTrim!JOB,V.ODBC.con!rst.FieldValTrim!SUFFIX,V.ODBC.con!rst.FieldValTrim!SEQ,V.Local.sSql)
				F.Intrinsic.String.Build("Select USER_ID, SALESORDER, WORKORDER, DEPT,RTRIM(' ') as NAME_CUSTOMER,WC,MON_HRS,MON_NOTES, TUES_HRS,TUES_NOTES, WED_HRS,WED_NOTES, THUR_HRS,THUR_NOTES, FRI_HRS,FRI_NOTES, SAT_HRS,SAT_NOTES,SUN_HRS,SUN_NOTES,UPDATED,FLAG_READY,CAST('A' as CHAR(1)) as Wrapper from GCG_6667_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}' AND SALESORDER = '{2}' and WORKORDER = '{3}' and DEPT = '{4}' and WC = '{5}'",V.Global.sUser,V.Global.dDate.PervasiveDate,V.ODBC.con!rst.FieldValTrim!SALESORDER,V.ODBC.con!rst.FieldValTrim!WORKORDER,V.ODBC.con!rst.FieldValTrim!DEPT,V.ODBC.con!rst.FieldValTrim!WC,V.Local.sSql)
				F.DATA.DataTable.CreateFromSQL("dtTimesheet","con",V.Local.sSql,true)
			F.Intrinsic.Control.EndIf
	
			F.ODBC.con!rst.MoveNext
		F.Intrinsic.Control.Loop
	
		F.ODBC.con!rst.Close
	
	'	F.Intrinsic.Control.If(v.DataTable.dtTimesheet.RowCount,=,0)
	
	'		GUI.FormTimesheet.cmdSave.Enabled(False)
	'		GUI.FormTimesheet.cmdUpdate.Enabled(False)
	'		gui.FormTimesheet.cmdAddSOBrows.Enabled(False)
	'		GUI.FormTimesheet.cmdSave.Enabled(False)
	'		gui.FormTimesheet.cmdAddDeptBrows.Enabled(False)
	'	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.EndIf
	F.ODBC.con!rstChk.Close
F.Intrinsic.Control.Else
	F.Intrinsic.Control.If(v.DataTable.dtTimesheet.exists,=,true)
		F.Data.DataTable.Close("dtTimesheet")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.String.Build("BEG_WEEK = '{0}'",V.Global.dDate.PervasiveDate,V.Local.sTemp)
	F.Intrinsic.Control.If(V.Local.sUserTemp.Trim,<>,"")
		F.Intrinsic.String.Build("{0} and USER_ID = '{1}'",V.Local.sTemp,V.Local.sUserTemp.Trim,V.Local.sTemp)
	F.Intrinsic.Control.ElseIf(V.Local.sDeptTemp.Trim,<>,"")
		F.Intrinsic.Control.If(V.Local.sTemp.Trim,=,"")
			F.Intrinsic.String.Build("DEPT = '{0}'",V.Local.sDeptTemp.Trim,V.Local.sTemp)
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("{0} and DEPT = '{1}'",V.Local.sTemp,V.Local.sDeptTemp.Trim,V.Local.sTemp)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.ElseIf(V.Local.sSOTemp.Trim,<>,"")
		F.Intrinsic.Control.If(V.Local.sTemp.Trim,=,"")
			F.Intrinsic.String.Build("SALESORDER = '{0}'",V.Local.sSOTemp.Trim,V.Local.sTemp)
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("{0} and SALESORDER = '{1}'",V.Local.sTemp,V.Local.sSOTemp.Trim,V.Local.sTemp)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.ElseIf(V.Local.sWCTemp.Trim,<>,"")
		F.Intrinsic.Control.If(V.Local.sTemp.Trim,=,"")
			F.Intrinsic.String.Build("WC = '{0}'",V.Local.sWCTemp.Trim,V.Local.sTemp)
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("{0} and WC = '{1}'",V.Local.sTemp,V.Local.sWCTemp.Trim,V.Local.sTemp)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.ElseIf(V.Local.sWOTemp.Trim,<>,"")
		F.Intrinsic.Control.If(V.Local.sTemp.Trim,=,"")
			F.Intrinsic.String.Build("WORKORDER = '{0}'",V.Local.sWOTemp.Trim,V.Local.sTemp)
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("{0} and WORKORDER = '{1}'",V.Local.sTemp,V.Local.sWOTemp.Trim,V.Local.sTemp)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	'F.Intrinsic.String.Build("Select USER_ID, SALESORDER, WORKORDER, DEPT,RTRIM(' ') as NAME_CUSTOMER,WC,MON_HRS,MON_NOTES, TUES_HRS,TUES_NOTES, WED_HRS,WED_NOTES, THUR_HRS,THUR_NOTES, FRI_HRS,FRI_NOTES, SAT_HRS,SAT_NOTES,SUN_HRS,SUN_NOTES,UPDATED,FLAG_READY,CAST('A' as CHAR(1)) as Wrapper from GCG_6667_TIMSHT where {0}",V.Local.sTemp,V.Local.sSql)
	F.Intrinsic.String.Build("Select USER_ID, SALESORDER, WORKORDER, DEPT,RTRIM(' ') as NAME_CUSTOMER,LTRIM(RTRIM(WC)) as WC,MON_HRS,MON_NOTES, TUES_HRS,TUES_NOTES, WED_HRS,WED_NOTES, THUR_HRS,THUR_NOTES, FRI_HRS,FRI_NOTES, SAT_HRS,SAT_NOTES,SUN_HRS,SUN_NOTES,UPDATED,FLAG_READY,CAST('A' as CHAR(1)) as Wrapper from GCG_6667_TIMSHT where {0}",V.Local.sTemp,V.Local.sSql)
	F.DATA.DataTable.CreateFromSQL("dtTimesheet","con",V.Local.sSql,true)
F.Intrinsic.Control.EndIf
'F.Intrinsic.Control.If(V.Local.bReady)
'	GUI.FormTimesheet.cmdSave.Enabled(False)
'	GUI.FormTimesheet.cmdAdd.Enabled(False)
'	GUI.FormTimesheet.cmdUpdate.Enabled(True)
'	GUI.FormTimesheet.cmdFrmTemp.Enabled(False)
	GUI.FormTimesheet.cmdPrint.Enabled(True)
'	GUI.FormTimesheet.cmdReady.Enabled(False)
	GUI.FormTimesheet.cmdUnlock.Enabled(True)
'	F.Intrinsic.Control.If(V.Global.bAdminMode.Not)
'		GUI.FormTimesheet.gsgcTimesheet.Enabled(False)
'	F.Intrinsic.Control.Else
'		GUI.FormTimesheet.gsgcTimesheet.Enabled(True)
'	F.Intrinsic.Control.EndIf
'F.Intrinsic.Control.Else
	GUI.FormTimesheet.gsgcTimesheet.Enabled(True)
'	GUI.FormTimesheet.cmdUpdate.Enabled(False)
	F.Intrinsic.Control.If(V.Global.bAdminMode.Not)
		GUI.FormTimesheet.cmdReady.Enabled(True)
		GUI.FormTimesheet.cmdUpdate.Enabled(False)
	F.Intrinsic.Control.Else
		GUI.FormTimesheet.cmdReady.Enabled(False)
		GUI.FormTimesheet.cmdUpdate.Enabled(True)
	F.Intrinsic.Control.EndIf
'	GUI.FormTimesheet.cmdUnlock.Enabled(False)
'F.Intrinsic.Control.EndIf

'F.Intrinsic.Control.If(V.Local.bUpdated)
'	GUI.FormTimesheet.cmdSave.Enabled(False)
'	GUI.FormTimesheet.cmdAdd.Enabled(False)
'	GUI.FormTimesheet.cmdUpdate.Enabled(False)
'	GUI.FormTimesheet.cmdFrmTemp.Enabled(False)
'	GUI.FormTimesheet.cmdPrint.Enabled(True)
'	GUI.FormTimesheet.cmdReady.Enabled(False)
'	GUI.FormTimesheet.cmdUnlock.Enabled(False)
''	GUI.FormTimesheet.gsgcTimesheet.Enabled(False)
'F.Intrinsic.Control.Else

'F.Intrinsic.Control.EndIf

'F.Data.Datatable.FillFromDictionary("dtTimesheet","DescDict","JS","Description")
'F.Data.Datatable.FillFromDictionary("dtTimesheet","FGDict","WORKORDER","Part")
F.Data.DataTable.FillFromDictionary("dtTimesheet","CustName","SALESORDER","NAME_CUSTOMER")

'--------------------------------------------------------------------------------------------------------------------------------
'Angel T Edit: Create dictionaries to bring in proj names, part, and part description for each record
F.Data.Dictionary.CreateFromSQL("dictProjName", "con", "select ORDER_NO, CODE_SORT from V_ORDER_HEADER")
F.Data.Dictionary.CreateFromSQL("dictPart", "con", "select Case When Suffix = '' or Suffix is null Then Job Else Job + '-' + Suffix End as WorkOrder, PART from V_ORDER_TO_WO")
F.Data.Dictionary.CreateFromSQL("dictLine", "con", "select Case When Suffix = '' or Suffix is null Then Job Else Job + '-' + Suffix End as WorkOrder, (ORDER_NO + ORDER_LINE) ORDER_AND_LINE from V_ORDER_TO_WO")
F.Data.Dictionary.CreateFromSQL("dictLineDescription", "con", "select (ORDER_NO + RECORD_NO) ORDER_AND_LINE, DESCRIPTION from V_ORDER_LINES")
'F.Data.Dictionary.CreateFromSQL("dictDesc", "con", "select Case When Suffix = '' or Suffix is null Then Job Else Job + '-' + Suffix End as WorkOrder, DESCRIPTION from V_ORDER_TO_WO")
'Set default returns
F.Data.Dictionary.SetDefaultReturn("dictProjName", "")
F.Data.Dictionary.SetDefaultReturn("dictPart", "")
F.Data.Dictionary.SetDefaultReturn("dictLine", "")
F.Data.Dictionary.SetDefaultReturn("dictLineDescription", "")
'F.Data.Dictionary.SetDefaultReturn("dictDesc", "")
'Add columns to dt
F.Data.Datatable.AddColumn("dtTimesheet", "PROJ_NAME", "String")
F.Data.Datatable.AddColumn("dtTimesheet", "PART", "String")
F.Data.Datatable.AddColumn("dtTimesheet", "ORDER_AND_LINE", "String")
F.Data.Datatable.AddColumn("dtTimesheet", "DESCRIPTION", "String")
'Fill table from dictionaries
F.Data.Datatable.FillFromDictionary("dtTimesheet", "dictProjName", "SALESORDER", "PROJ_NAME")
F.Data.Datatable.FillFromDictionary("dtTimesheet", "dictPart", "WORKORDER", "PART")
F.Data.Datatable.FillFromDictionary("dtTimesheet", "dictLine", "WORKORDER", "ORDER_AND_LINE")
F.Data.Datatable.FillFromDictionary("dtTimesheet", "dictLineDescription", "ORDER_AND_LINE", "DESCRIPTION")
'Close dictionaries
F.Data.Dictionary.Close("dictProjName")
F.Data.Dictionary.Close("dictPart")
F.Data.Dictionary.Close("dictLine")
F.Data.Dictionary.Close("dictLineDescription")
'--------------------------------------------------------------------------------------------------------------------------------


F.Data.DataTable.AddColumn("dtTimesheet", "WC_DESC", "String")
'F.Data.Datatable.FillFromDictionary("dtTimesheet","dictSeqDesc", "JSS", "SEQ_DESCRIPTION")
F.Data.DataTable.FillFromDictionary("dtTimesheet","WCDESC","WC","WC_DESC")

F.Data.DataTable.AddColumn("dtTimesheet","Delete","String")

F.Data.DataTable.AddExpressionColumn("dtTimesheet", "JOB_SUM", "Float", "MON_HRS + TUES_HRS + WED_HRS + THUR_HRS + FRI_HRS + SAT_HRS + SUN_HRS")

F.Data.DataView.Create("dtTimesheet","dvTimesheet",22)

F.Intrinsic.Control.CallSub(LoadGridJobTime)

F.Data.DataTable.AddColumn("dtTimesheet", "SUNDAY_HOURS_EDIT", "String", "0.00")
F.Data.DataTable.AddColumn("dtTimesheet", "MONDAY_HOURS_EDIT", "String", "0.00")
F.Data.DataTable.AddColumn("dtTimesheet", "TUESDAY_HOURS_EDIT", "String", "0.00")
F.Data.DataTable.AddColumn("dtTimesheet", "WEDNESDAY_HOURS_EDIT", "String", "0.00")
F.Data.DataTable.AddColumn("dtTimesheet", "THURSDAY_HOURS_EDIT", "String", "0.00")
F.Data.DataTable.AddColumn("dtTimesheet", "FRIDAY_HOURS_EDIT", "String", "0.00")
F.Data.DataTable.AddColumn("dtTimesheet", "SATURDAY_HOURS_EDIT", "String", "0.00")
F.Data.DataTable.AddColumn("dtTimesheet", "JOB_TOTAL_TIME", "String", "0.00")

v.Local.sSQL.Set("select distinct MACHINE from WORKCENTERS")
F.data.DataTable.CreateFromSQL("WCDT","con",v.Local.sSQL)
F.Data.Dataview.Create("WCDT","WCDTVW",22)
F.data.DataView.ToString("WCDT","WCDTVW","MACHINE","@!@","*!*",v.Local.sWC)
F.Data.DataView.Close("WCDT","WCDTVW")
F.Data.DataTable.Close("WCDT")

F.Intrinsic.Control.CallSub(CalculateAllTimeColumns)

F.Intrinsic.Control.If(V.Global.bAdminMode.Not)
	F.Intrinsic.String.Build("Select Dept_Employee From V_Employee_Mstr Where Employee = '{0}'",V.Screen.FormTimesheet!txtEmployee.Text,V.Local.sSql)
	F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sDept)
	Gui.FormTimesheet.txtADept.Text(V.Local.sDept)
F.Intrinsic.Control.EndIf

GUI.FormTimesheet.gsgcTimesheet.AddGridviewFromDataview("gvTimesheet","dtTimesheet","dvTimesheet")

GUI.FormTimesheet.gsgcTimesheet.SetGridviewProperty("gvTimesheet", "OptionsViewColumnAutoWidth", False)
'GUI.FormTimesheet.gsgcTimesheet.SetGridviewProperty("gvTimesheet","AllowColumnMoving",False)
GUI.FormTimesheet.gsgcTimesheet.SetGridviewProperty("gvTimesheet","OptionsViewRowAutoHeight",False)
GUI.FormTimesheet.gsgcTimesheet.SetGridviewProperty("gvTimesheet","OptionsSelectionEnableAppearanceFocusedRow",False)
GUI.FormTimesheet.gsgcTimesheet.SetGridviewProperty("gvTimesheet","OptionsViewShowAutoFilterRow",True)
GUI.FormTimesheet.gsgcTimesheet.SetGridviewProperty("gvTimesheet","ColumnPanelRowHeight",40)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "ORDER_AND_LINE", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "ORDER_AND_LINE", "AllowShowHide", False)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "Width", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "ReadOnly", False)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "EditMaskType", "RegEx")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "EditMask", "00.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "Caption", "Sunday")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "Width", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "ReadOnly", False)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "EditMaskType", "RegEx")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "EditMask", "00.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "Caption", "Monday")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "Width", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "ReadOnly", False)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "EditMaskType", "RegEx")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "EditMask", "00.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "Caption", "Tuesday")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "Width", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "ReadOnly", False)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "EditMaskType", "RegEx")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "EditMask", "00.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "Caption", "Wednesday")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "Width", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "ReadOnly", False)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "EditMaskType", "RegEx")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "EditMask", "00.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "Caption", "Thursday")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "Width", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "ReadOnly", False)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "EditMaskType", "RegEx")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "EditMask", "00.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "Caption", "Friday")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "Width", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "ReadOnly", False)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "EditMaskType", "RegEx")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "EditMaskType", "Numeric")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "EditMask", "00.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "Caption", "Saturday")

'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JSS","visible","false")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JS","visible","false")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Wrapper","visible","False")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","UPDATED","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","UPDATED","Caption", "Submitted")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","UPDATED","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","UPDATED","visible","False")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","UPDATED","Width", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","UPDATED","MaxWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","UPDATED","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","UPDATED","allowedit", false)

'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FLAG_READY","visible","false")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FLAG_READY","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FLAG_READY","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FLAG_READY","visible","True")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FLAG_READY","Width", 60)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","UPDATED","MaxWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FLAG_READY","Caption", "Ready")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FLAG_READY","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FLAG_READY","allowedit", false)

GUI.FormTimesheet.gsgcTimesheet.ColumnEdit("gvTimesheet","Delete","EditorButton","Delete")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Delete","Width", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Delete","MaxWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Delete","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Delete","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Delete","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Delete","allowedit", false)

'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB","headerforecolor", v.Color.PRI-GSS-00)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB","headerfontbold", true)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB","caption","Job")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB","readonly", true)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB","allowedit", false)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB","MinWidth", 50)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB","MaxWidth", 50)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","USER_ID","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","USER_ID","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","USER_ID","caption","User")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","USER_ID","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","USER_ID","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","USER_ID","Width", 90)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SALESORDER","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SALESORDER","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SALESORDER","caption","Sales Order")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SALESORDER","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SALESORDER","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SALESORDER","Width", 90)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SALESORDER","MaxWidth", 90)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_SUM","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_SUM","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_SUM","caption","WC Total (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_SUM","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_SUM","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_SUM","Width", 70)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_SUM","MaxWidth", 70)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "JOB_SUM", "DisplayCustomNumeric", "0.00")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "JOB_SUM", "Visible",True)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_TOTAL_TIME","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_TOTAL_TIME","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_TOTAL_TIME","caption","WC Total")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_TOTAL_TIME","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_TOTAL_TIME","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_TOTAL_TIME","Width", 70)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_TOTAL_TIME","MaxWidth", 70)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "JOB_TOTAL_TIME", "DisplayCustomNumeric", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "JOB_TOTAL_TIME", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "JOB_TOTAL_TIME", "AllowShowHide", False)

'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JSS","headerforecolor", v.Color.PRI-GSS-00)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JSS","headerfontbold", true)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JSS","caption","Job SS")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JSS","readonly", true)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JSS","allowedit", false)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JSS","MinWidth", 80)

'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Suffix","headerforecolor", v.Color.PRI-GSS-00)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Suffix","headerfontbold", true)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Suffix","caption","Suffix")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Suffix","readonly", true)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Suffix","allowedit", false)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Suffix","MinWidth", 50)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Suffix","MaxWidth", 50)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WORKORDER","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WORKORDER","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WORKORDER","caption","Work Order")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WORKORDER","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WORKORDER","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WORKORDER","Width", 90)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WORKORDER","MaxWidth", 90)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Delete","visible","True")

'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq","headerforecolor", v.Color.PRI-GSS-00)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq","headerfontbold", true)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq","caption","Seq")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq","readonly", true)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq","allowedit", false)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq","MinWidth", 50)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq","MaxWidth", 50)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","DEPT","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","DEPT","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","DEPT","caption","Dept.")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","DEPT","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","DEPT","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","DEPT","Width", 50)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","DEPT","MaxWidth", 50)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","DEPT","Visible", False)

'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Description","headerforecolor", v.Color.PRI-GSS-00)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Description","headerfontbold", true)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Description","caption","Description (Job)")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Description","HeaderWordWrap", "Wrap")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Description","readonly", true)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Description","allowedit", false)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Description","MinWidth", 110)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","NAME_CUSTOMER","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","NAME_CUSTOMER","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","NAME_CUSTOMER","caption","Customer")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","NAME_CUSTOMER","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","NAME_CUSTOMER","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","NAME_CUSTOMER","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","NAME_CUSTOMER","Width", 120)

'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","seq_Description","headerforecolor", v.Color.PRI-GSS-00)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","seq_Description","headerfontbold", true)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","seq_Description","caption","Description (Seq)")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","seq_Description","HeaderWordWrap", "Wrap")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","seq_Description","readonly", true)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","seq_Description","allowedit", false)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","seq_Description","MinWidth", 110)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC_DESC","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC_DESC","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC_DESC","caption","WC Description")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC_DESC","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC_DESC","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC_DESC","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC_DESC","Width", 50)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PROJ_NAME","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PROJ_NAME","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PROJ_NAME","caption","Proj Name")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PROJ_NAME","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PROJ_NAME","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PROJ_NAME","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PROJ_NAME","Width", 150)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PART","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PART","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PART","caption","Part")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PART","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PART","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PART","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PART","Width", 150)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","DESCRIPTION","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","DESCRIPTION","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","DESCRIPTION","caption","Part Desc")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","DESCRIPTION","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","DESCRIPTION","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","DESCRIPTION","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","DESCRIPTION","Width", 250)

'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PART","headerforecolor", v.Color.PRI-GSS-00)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PART","headerfontbold", true)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PART","caption","Part/Project")
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PART","readonly", true)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PART","allowedit", false)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PART","MinWidth", 50)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","caption","WC")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.ColumnEdit("gvTimesheet","WC","Dropdownlist",v.Local.sWC)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","Width", 50)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","MaxWidth", 50)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS", "AllowShowHide", False)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_NOTES","caption","Sun Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_NOTES","Width", 70)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_NOTES","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS", "AllowShowHide", False)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_NOTES","caption","Mon Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_NOTES","Width", 70)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_NOTES","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS", "AllowShowHide", False)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_NOTES","caption","Tues Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_NOTES","Width", 70)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_NOTES","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS", "AllowShowHide", False)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_NOTES","caption","Wed Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_NOTES","Width", 70)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_NOTES","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS", "AllowShowHide", False)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_NOTES","caption","Th Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_NOTES","Width", 70)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_NOTES","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS", "AllowShowHide", False)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_NOTES","caption","Fri Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_NOTES","Width", 70)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_NOTES","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS", "Visible", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS", "AllowShowHide", False)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_NOTES","caption","Sat Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_NOTES","Width", 70)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_NOTES","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_NOTES","Visible", "False")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_NOTES","Visible", "False")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_NOTES","Visible", "False")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_NOTES","Visible", "False")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_NOTES","Visible", "False")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_NOTES","Visible", "False")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_NOTES","Visible", "False")

'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB","VisibleIndex", 0)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUFFIX","VisibleIndex", 1)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Description","VisibleIndex", 2)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SEQ","VisibleIndex", 3)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","seq_Description","VisibleIndex", 4)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","USER_ID","VisibleIndex", 0)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SALESORDER","VisibleIndex", 1)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WORKORDER","VisibleIndex", 2)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","NAME_CUSTOMER","VisibleIndex", 3)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","DEPT","VisibleIndex", 4)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","VisibleIndex", 5)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC_DESC","VisibleIndex", 6)
'GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Part","VisibleIndex", 6)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUNDAY_HOURS_EDIT","VisibleIndex", 7)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MONDAY_HOURS_EDIT","VisibleIndex", 8)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUESDAY_HOURS_EDIT","VisibleIndex", 9)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WEDNESDAY_HOURS_EDIT","VisibleIndex", 10)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THURSDAY_HOURS_EDIT","VisibleIndex", 11)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRIDAY_HOURS_EDIT","VisibleIndex", 12)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SATURDAY_HOURS_EDIT","VisibleIndex", 13)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_SUM","VisibleIndex", 14)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Updated","VisibleIndex", 15)
Gui.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Flag_Ready","VisibleIndex",16)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Delete","VisibleIndex", 17)

'GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "SUNDAY_HOURS_EDIT", "Condition1", "NotEqual", "0")
'GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "Condition1", "FontBold", True)
'GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "MONDAY_HOURS_EDIT", "Condition2", "NotEqual", "0")
'GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "Condition2", "FontBold", True)
'GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "TUESDAY_HOURS_EDIT", "Condition3", "NotEqual", "0")
'GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "Condition3", "FontBold", True)
'GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "Condition4", "NotEqual", "0")
'GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "Condition4", "FontBold", True)
'GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "THURSDAY_HOURS_EDIT", "Condition5", "NotEqual", "0")
'GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "Condition5", "FontBold", True)
'GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "FRIDAY_HOURS_EDIT", "Condition6", "NotEqual", "0")
'GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "Condition6", "FontBold", True)
'GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "SATURDAY_HOURS_EDIT", "Condition7", "NotEqual", "0")
'GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "Condition7", "FontBold", True)

'GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "JOB_SUM", "Condition8", "NotEqual", "0")
'GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "JOB_SUM", "Condition8", "FontBold", True)

'GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "Updated", "Condition9", "Equal","True")
'GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "Updated", "Condition9", "BackColor", "#90ee90")
'Gui.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet","Updated","Condition9","ApplyToRow",True)

GUI.FormTimesheet.gsgcTimesheet.MainView("gvTimesheet")

F.Global.Registry.ReadValue(V.Caller.User, V.Caller.CompanyCode, "gvTimesheet", 6667, 1000, 6, "", V.Local.sSerialize)
F.Intrinsic.Control.If(V.Local.sSerialize.Trim,<>,"")
	Gui.FormTimesheet.gsgcTimesheet.Deserialize(V.Local.sSerialize)
F.Intrinsic.Control.EndIf

GUI.FormTimesheet.gsgcTimesheet.Visible(True)
F.Intrinsic.Control.UnBlockEvents
GUI.FormTimesheet.gsgcTimesheet.ResumeLayout

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("GridLoad_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.GridLoad.End

Program.Sub.ComputeTotals.Start
F.Intrinsic.Control.SetErrorHandler("ComputeTotals_Err")
F.Intrinsic.Control.ClearErrors

v.Local.fMonHrs.Declare(float)
v.Local.fTuesHrs.Declare(float)
v.Local.fWedHrs.Declare(float)
v.Local.fThurHrs.Declare(float)
v.Local.fFriHrs.Declare(float)
v.Local.fSatHrs.Declare(float)
v.Local.fSunHrs.Declare(float)
v.Local.fTotHrs.Declare(float)
v.Local.sHold.Declare(String)
V.Local.fTemp.Declare(Float)
V.Local.sTemp.Declare(String)
V.Local.fHours1.Declare(Float)
V.Local.fHours2.Declare(Float)
V.Local.fHours3.Declare(Float)
V.Local.fUnrounded.Declare(Float)
V.Local.iCounter.Declare(Long)
V.Local.sTime.Declare(String)

V.Local.sTime.Redim(0, 6)
V.Local.fUnrounded.Redim(0, 7)

'computes the total hours and loads them onto text boxes to the side
F.Data.DataView.ToDataTable("dtTimesheet","dvTimesheet","CompDT")
F.Intrinsic.Control.If(v.DataTable.CompDT.RowCount,<>,0)

	F.Data.DataTable.Compute("CompDT","Sum(SUN_HRS)","",V.Local.fUnrounded(0))
	'F.Intrinsic.Math.Round(V.Local.fUnrounded(0), 4, V.Local.fSunHrs)
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fUnrounded(0))
	GUI.FormTimesheet.txtSunHrs.Text(V.Args.Time)
	V.Local.sTime(0).Set(V.Args.Time)
	
	F.Data.DataTable.Compute("CompDT","Sum(MON_HRS)","",V.Local.fUnrounded(1))
	'F.Intrinsic.Math.Round(V.Local.fUnrounded(1), 4, V.Local.fMonHrs)
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fUnrounded(1))
	GUI.FormTimesheet.txtMonHrs.Text(V.Args.Time)
	V.Local.sTime(1).Set(V.Args.Time)
	
	F.Data.DataTable.Compute("CompDT","Sum(TUES_HRS)","",V.Local.fUnrounded(2))
	'F.Intrinsic.Math.Round(V.Local.fUnrounded(2), 4, V.Local.fTuesHrs)
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fUnrounded(2))
	GUI.FormTimesheet.txtTuesHrs.Text(V.Args.Time)
	V.Local.sTime(2).Set(V.Args.Time)
	
	F.Data.DataTable.Compute("CompDT","Sum(WED_HRS)","",V.Local.fUnrounded(3))
	'F.Intrinsic.Math.Round(V.Local.fUnrounded(3), 4, V.Local.fWedHrs)
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fUnrounded(3))
	GUI.FormTimesheet.txtWedHrs.Text(V.Args.Time)
	V.Local.sTime(3).Set(V.Args.Time)
	
	F.Data.DataTable.Compute("CompDT","Sum(THUR_HRS)","",V.Local.fUnrounded(4))
	'F.Intrinsic.Math.Round(V.Local.fUnrounded(4), 4, V.Local.fThurHrs)
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fUnrounded(4))
	GUI.FormTimesheet.txtThurHrs.Text(V.Args.Time)
	V.Local.sTime(4).Set(V.Args.Time)
	
	F.Data.DataTable.Compute("CompDT","Sum(FRI_HRS)","",V.Local.fUnrounded(5))
	'F.Intrinsic.Math.Round(V.Local.fUnrounded(5), 4, V.Local.fFriHrs)
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fUnrounded(5))
	GUI.FormTimesheet.txtFriHrs.Text(V.Args.Time)
	V.Local.sTime(5).Set(V.Args.Time)
	
	F.Data.DataTable.Compute("CompDT","Sum(SAT_HRS)","",V.Local.fUnrounded(6))
	'F.Intrinsic.Math.Round(V.Local.fUnrounded(6), 4, V.Local.fSatHrs)
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fUnrounded(6))
	GUI.FormTimesheet.txtSatHrs.Text(V.Args.Time)
	V.Local.sTime(6).Set(V.Args.Time)
	
	'F.Intrinsic.math.Add(v.Local.fSunHrs,v.Local.fMonHrs,v.Local.fTuesHrs,v.Local.fWedHrs,v.Local.fThurHrs,v.Local.fFriHrs,v.Local.fSatHrs,v.Local.fTotHrs)
	'F.Intrinsic.Math.Round(V.Local.fTotHrs, 4, V.Local.fTotHrs)
	V.Local.fTotHrs.Set(0)
'	F.Intrinsic.Control.For(V.Local.iCounter, 0, V.Local.sTime.UBound, 1)
'		F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Local.sTime(V.Local.iCounter))
'		F.Intrinsic.Math.Add(V.Local.fTotHrs, V.Args.Decimal, V.Local.fTotHrs)
'	F.Intrinsic.Control.Next(V.Local.iCounter)
	F.Intrinsic.Math.Add(V.Local.fUnrounded(0), V.Local.fUnrounded(1), V.Local.fUnrounded(2), V.Local.fUnrounded(3), V.Local.fUnrounded(4), V.Local.fUnrounded(5), V.Local.fUnrounded(6), V.Local.fTotHrs)
	
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTotHrs)
	GUI.FormTimesheet.txtTotHrs.Text(V.Args.Time)
	
	F.Data.DataTable.Close("CompDT")
F.Intrinsic.Control.Else
	F.Intrinsic.Control.CallSub(EmptyTotals)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.CallSub(LoadClockInTime)

V.Local.sTemp.Set(V.Screen.FormTimesheet!lblClockHrsMon.Caption)
'F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
'	GUI.FormTimesheet.txtMonHrs.BackColor(12648384)
'F.Intrinsic.Control.Else
'	GUI.FormTimesheet.txtMonHrs.BackColor(V.Color.Pink)
'F.Intrinsic.Control.EndIf

V.Local.sTemp.Set(V.Screen.FormTimesheet!lblClockHrsTues.Caption)
'F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
'	GUI.FormTimesheet.txtTuesHrs.BackColor(12648384)
'F.Intrinsic.Control.Else
'	GUI.FormTimesheet.txtTuesHrs.BackColor(V.Color.Pink)
'F.Intrinsic.Control.EndIf

V.Local.sTemp.Set(V.Screen.FormTimesheet!lblClockHrsWed.Caption)
'F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
'	GUI.FormTimesheet.txtWedHrs.BackColor(12648384)
'F.Intrinsic.Control.Else
'	GUI.FormTimesheet.txtWedHrs.BackColor(V.Color.Pink)
'F.Intrinsic.Control.EndIf

V.Local.sTemp.Set(V.Screen.FormTimesheet!lblClockHrsThur.Caption)
'F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
'	GUI.FormTimesheet.txtThurHrs.BackColor(12648384)
'F.Intrinsic.Control.Else
'	GUI.FormTimesheet.txtThurHrs.BackColor(V.Color.Pink)
'F.Intrinsic.Control.EndIf

V.Local.sTemp.Set(V.Screen.FormTimesheet!lblClockHrsFri.Caption)
'F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
'	GUI.FormTimesheet.txtFriHrs.BackColor(12648384)
'F.Intrinsic.Control.Else
'	GUI.FormTimesheet.txtFriHrs.BackColor(V.Color.Pink)
'F.Intrinsic.Control.EndIf

V.Local.sTemp.Set(V.Screen.FormTimesheet!lblClockHrsSat.Caption)
'F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
'	GUI.FormTimesheet.txtSatHrs.BackColor(12648384)
'F.Intrinsic.Control.Else
'	GUI.FormTimesheet.txtSatHrs.BackColor(V.Color.Pink)
'F.Intrinsic.Control.EndIf

V.Local.sTemp.Set(V.Screen.FormTimesheet!lblClockHrsSun.Caption)
'F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
'	GUI.FormTimesheet.txtSunHrs.BackColor(12648384)
'F.Intrinsic.Control.Else
'	GUI.FormTimesheet.txtSunHrs.BackColor(V.Color.Pink)
'F.Intrinsic.Control.EndIf

F.Intrinsic.Control.CallSub(LoadJobTime)

F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtHoursTA.Text.Trim)
V.Local.fHours1.Set(V.Args.Decimal)
F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtTotHrs.Text.Trim)
V.Local.fHours2.Set(V.Args.Decimal)
F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtGUIHours.Text.Trim)
V.Local.fHours3.Set(V.Args.Decimal)

F.Intrinsic.Math.Add(V.Local.fHours2, V.Local.fHours3, V.Local.fTemp)
F.Intrinsic.Math.Sub(V.Local.fHours1, V.Local.fTemp, V.Local.fTemp)
F.Intrinsic.Math.Sub(0, V.Local.fTemp, V.Local.fTemp)
F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTemp)
GUI.FormTimesheet.txtHoursBalance.Text(V.Args.Time)

V.Local.sTemp.Set(V.Screen.FormTimesheet!txtHoursBalance.Caption)
'F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
'	GUI.FormTimesheet.txtHoursBalance.BackColor(12648384)
'F.Intrinsic.Control.Else
'	GUI.FormTimesheet.txtHoursBalance.BackColor(V.Color.Pink)
'F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("ComputeTotals_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.ComputeTotals.End

Program.Sub.LoadClockInTime.Start
'get the actual time and attendance clock in time for the selected employee/week
F.Intrinsic.Control.SetErrorHandler("LoadClockInTime_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sEmployee.Declare(String)
V.Local.dStartDate.Declare(Date)
V.Local.dEndDate.Declare(Date)
V.Local.sSQL.Declare(String)
V.Local.sMessage.Declare(String)
V.Local.iCounter.Declare(Long)
V.Local.dInTemp.Declare(Date)
V.Local.dOutTemp.Declare(Date)
V.Local.iMinutes.Declare(Long)
V.Local.iTotalMinutes.Declare(Long)
V.Local.iHours.Declare(Long)
V.Local.fHours.Declare(Float)
V.Local.fTotalHours.Declare(Float)
V.Local.dDate.Declare(Date)
V.Local.sFilter.Declare(String)
V.Local.fTemp.Declare(Float)
V.Local.sTemp.Declare(String)
V.Local.sMonday.Declare(String)
V.Local.sTuesday.Declare(String)
V.Local.sWednesday.Declare(String)
V.Local.sThursday.Declare(String)
V.Local.sFriday.Declare(String)
V.Local.sSaturday.Declare(String)
V.Local.sSunday.Declare(String)
V.Local.sTotal.Declare(String)

'get employee
F.Intrinsic.Control.If(v.Global.bAdminMode)
'	V.Local.sEmployee.Set(V.Screen.FormTimesheet!txtEmployee.Text.Trim)
	F.Data.DataView.Create("dtTimesheet","TempUser",22,"","")
	F.Data.DataView.ToDataTableDistinct("dtTimesheet","TempUser","User","USER_ID",True)
	F.Data.DataView.Close("dtTimesheet","TempUser")
	F.Intrinsic.Control.For(V.Local.iCounter,0,V.DataTable.User.RowCount--,1)
		F.Global.Security.GetEmpNoFromUser(V.DataTable.User(V.Local.iCounter).User_Id!FieldValTrim, V.Local.sTemp)
		F.Intrinsic.Control.If(V.Local.sTemp.Trim,<>,"")
			F.Intrinsic.Control.If(V.Local.sEmployee.Trim,=,"")
				V.Local.sEmployee.Set(V.Local.sTemp.Trim)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("{0}','{1}",V.Local.sEmployee,V.Local.sTemp.Trim,V.Local.sEmployee)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iCounter)
	F.Data.DataTable.Close("User")
F.Intrinsic.Control.Else
	F.Global.Security.GetEmpNoFromUser(V.Global.sUser, V.Local.sEmployee)
	F.Intrinsic.Control.If(V.Local.sEmployee.IsNoReturn)
		F.Intrinsic.String.Build("No employee tied to the user '{0}', clock in time will not be pulled in.", V.Global.sUser, V.Local.sMessage)
		F.Intrinsic.UI.Msgbox(V.Local.sMessage)
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

'get date range
V.Local.dStartDate.Set(V.Screen.FormTimesheet!dtpWeek.Value)
F.Intrinsic.Date.DateAdd("D", 6, V.Local.dStartDate, V.Local.dEndDate)

'get data
F.Intrinsic.String.Build("select CHARGE_DATE, DATE_IN, DATE_OUT, IsNull(HOURS_HH, 0) as HOURS_HH, IsNull(HOURS_MM, 0) as HOURS_MM, OUT_TS_MIN, IN_TS_MIN, TIME_IN, TIME_OUT from V_TIME_ATTENDANCE where CHARGE_DATE between '{0}' and '{1}' and EMPLOYEE In ('{2}')", V.Local.dStartDate.FormatYYYY-MM-DD, V.Local.dEndDate.FormatYYYY-MM-DD, V.Local.sEmployee, V.Local.sSQL)
F.Data.DataTable.CreateFromSQL("dtClock", "Con", V.Local.sSQL)

'if still clocked in will need to calculate
'currently I'm assuming there's no overnight
F.Data.DataTable.AddColumn("dtClock", "Hours", "Long", 0)
F.Data.DataTable.AddColumn("dtClock", "Minutes", "Long", 0)
F.Data.DataTable.AddColumn("dtClock", "Curr_Hours_Float", "Float", 0)
F.Data.DataTable.AddColumn("dtClock", "Total_Minutes", "Long", 0)
F.Data.DataView.Create("dtClock", "dvClockedIn", 22, "DATE_OUT = '1900-01-01'", "")
F.Intrinsic.Control.For(V.Local.iCounter, 0, V.DataView.dtClock!dvClockedIn.RowCount--, 1)
	V.Local.dInTemp.Set(V.DataView.dtClock!dvClockedIn(V.Local.iCounter).Time_In!FieldVal)
	V.Local.dOutTemp.Set(V.Ambient.Time)
	F.Intrinsic.Date.DateDiff("N", V.Local.dInTemp, V.Local.dOutTemp, V.Local.iTotalMinutes)
	F.Intrinsic.Math.Mod(V.Local.iTotalMinutes, 60, V.Local.iMinutes)
	F.Intrinsic.Math.Div(V.Local.iTotalMinutes, 60, V.Local.fHours)
	F.Intrinsic.Math.Round(V.Local.fHours, 0, V.Local.iHours)
	'F.Intrinsic.Math.Round(V.Local.fHours, 4, V.Local.fHours)
	F.Data.DataView.SetValue("dtClock", "dvClockedIn", V.Local.iCounter, "Total_Minutes", V.Local.iTotalMinutes, "Hours", V.Local.iHours, "Minutes", V.Local.iMinutes, "Curr_Hours_Float", V.Local.fHours)
	
F.Intrinsic.Control.Next(V.Local.iCounter)
F.Data.DataView.Close("dtClock", "dvClockedIn")

F.Data.DataTable.AddExpressionColumn("dtClock", "Prev_Hours_Float", "Float", "[HOURS_HH] + ([HOURS_MM] / 60)")
F.Data.DataTable.AddExpressionColumn("dtClock", "Hours_Float", "Float", "[Prev_Hours_Float] + [Curr_Hours_Float]")

F.Data.DataTable.AddColumn("dtClock", "FInal_Time", "Float")
F.Data.DataTable.SetValueFormat("dtClock", -1, "Hours_Float", "Final_Time", "##############.00##")

'create job time datatable to remove it from the sum
F.Intrinsic.String.Build("select DATE_SEQUENCE, EMPL, SUM(HOURS_WORKED) HOURS from V_JOB_DETAIL where EMPL In ('{0}') and DATE_SEQUENCE between '{1}' and '{2}' group by DATE_SEQUENCE, EMPL", V.Local.sEmployee, V.Local.dStartDate.FormatYYYY-MM-DD, V.Local.dEndDate.FormatYYYY-MM-DD, V.Local.sSQL)
F.Data.DataTable.CreateFromSQL("dtJobDetail", "con", V.Local.sSQL)
F.Data.DataView.Create("dtJobDetail", "dvJobDetail", 22)

V.Local.dDate.Set(V.Local.dStartDate)
V.Local.fTotalHours.Redim(0, 7)
F.Intrinsic.Control.For(V.Local.iCounter, 0, 6, 1)
	F.Intrinsic.String.Build("CHARGE_DATE = '{0}'", V.Local.dDate, V.Local.sFilter)
	F.Data.DataTable.Compute("dtClock", "Sum(Final_Time)", V.Local.sFilter, V.Local.fHours)
	
	'subtract job hours
	F.Intrinsic.String.Build("DATE_SEQUENCE = '{0}'", V.Local.dDate, V.Local.sFilter)
	F.Data.DataView.SetFilter("dtJobDetail", "dvJobDetail", V.Local.sFilter)
	F.Intrinsic.Control.If(V.DataView.dtJobDetail!dvJobDetail.RowCount, >, 0)
		F.Intrinsic.Math.Sub(V.Local.fHours, V.DataView.dtJobDetail!dvJobDetail(0).HOURS!FieldValFloat, V.Local.fHours)
	F.Intrinsic.Control.EndIf
	
	'F.Intrinsic.Math.Round(V.Local.fHours, 4, V.Local.fHours)
	V.Local.fTotalHours(V.Local.iCounter).Set(V.Local.fHours)
	F.Intrinsic.Date.DateAdd("d", 1, V.Local.dDate, V.Local.dDate)
F.Intrinsic.Control.Next(V.Local.iCounter)

F.Data.DataTable.Compute("dtClock", "Sum(Final_Time)", "", V.Local.fHours)
'F.Intrinsic.Math.Round(V.Local.fHours, 4, V.Local.fHours)
V.Local.fTotalHours(7).Set(V.Local.fHours)

F.Data.DataView.Close("dtJobDetail", "dvJobDetail")
F.Data.DataTable.Close("dtJobDetail")

'Exergy wants the clock in time to count down to 0 (cancel out) as bucket time is entered
F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtSunHrs.Text.Trim)
'F.Intrinsic.Math.Sub(0, V.Args.Decimal, V.Local.fTemp)
'F.Intrinsic.Math.Add(V.Local.fTotalHours(0), V.Local.fTemp, V.Local.fTotalHours(0))
F.Intrinsic.Math.Add(V.Args.Decimal, V.Local.fTotalHours(0), V.Local.fTotalHours(0))
'F.Intrinsic.Math.Round(V.Local.fTotalHours(0), 4, V.Local.fTotalHours(0))
F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTotalHours(0))
V.Local.sSunday.Set(V.Args.Time)

F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtMonHrs.Text.Trim)
'F.Intrinsic.Math.Sub(0, V.Args.Decimal, V.Local.fTemp)
'F.Intrinsic.Math.Add(V.Local.fTotalHours(1), V.Local.fTemp, V.Local.fTotalHours(1))
F.Intrinsic.Math.Add(V.Args.Decimal, V.Local.fTotalHours(1), V.Local.fTotalHours(1))
'F.Intrinsic.Math.Round(V.Local.fTotalHours(1), 4, V.Local.fTotalHours(1))
F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTotalHours(1))
V.Local.sMonday.Set(V.Args.Time)

F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtTuesHrs.Text.Trim)
'F.Intrinsic.Math.Sub(0, V.Args.Decimal, V.Local.fTemp)
'F.Intrinsic.Math.Add(V.Local.fTotalHours(2), V.Local.fTemp, V.Local.fTotalHours(2))
F.Intrinsic.Math.Add(V.Args.Decimal, V.Local.fTotalHours(2), V.Local.fTotalHours(2))
'F.Intrinsic.Math.Round(V.Local.fTotalHours(2), 4, V.Local.fTotalHours(2))
F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTotalHours(2))
V.Local.sTuesday.Set(V.Args.Time)

F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtWedHrs.Text.Trim)
'F.Intrinsic.Math.Sub(0, V.Args.Decimal, V.Local.fTemp)
'F.Intrinsic.Math.Add(V.Local.fTotalHours(3), V.Local.fTemp, V.Local.fTotalHours(3))
F.Intrinsic.Math.Add(V.Args.Decimal, V.Local.fTotalHours(3), V.Local.fTotalHours(3))
'F.Intrinsic.Math.Round(V.Local.fTotalHours(3), 4, V.Local.fTotalHours(3))
F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTotalHours(3))
V.Local.sWednesday.Set(V.Args.Time)

F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtThurHrs.Text.Trim)
'F.Intrinsic.Math.Sub(0, V.Args.Decimal, V.Local.fTemp)
'F.Intrinsic.Math.Add(V.Local.fTotalHours(4), V.Local.fTemp, V.Local.fTotalHours(4))
F.Intrinsic.Math.Add(V.Args.Decimal, V.Local.fTotalHours(4), V.Local.fTotalHours(4))
'F.Intrinsic.Math.Round(V.Local.fTotalHours(4), 4, V.Local.fTotalHours(4))
F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTotalHours(4))
V.Local.sThursday.Set(V.Args.Time)

F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtFriHrs.Text.Trim)
'F.Intrinsic.Math.Sub(0, V.Args.Decimal, V.Local.fTemp)
'F.Intrinsic.Math.Add(V.Local.fTotalHours(5), V.Local.fTemp, V.Local.fTotalHours(5))
F.Intrinsic.Math.Add(V.Args.Decimal, V.Local.fTotalHours(5), V.Local.fTotalHours(5))
'F.Intrinsic.Math.Round(V.Local.fTotalHours(5), 4, V.Local.fTotalHours(5))
F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTotalHours(5))
V.Local.sFriday.Set(V.Args.Time)

F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtSatHrs.Text.Trim)
'F.Intrinsic.Math.Sub(0, V.Args.Decimal, V.Local.fTemp)
'F.Intrinsic.Math.Add(V.Local.fTotalHours(6), V.Local.fTemp, V.Local.fTotalHours(6))
F.Intrinsic.Math.Add(V.Args.Decimal, V.Local.fTotalHours(6), V.Local.fTotalHours(6))
'F.Intrinsic.Math.Round(V.Local.fTotalHours(6), 4, V.Local.fTotalHours(6))
F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTotalHours(6))
V.Local.sSaturday.Set(V.Args.Time)

F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTotalHours(7))
V.Local.sTotal.Set(V.Args.Time)

GUI.FormTimesheet.lblClockHrsMon.Caption(V.Local.sMonday)
GUI.FormTimesheet.lblClockHrsTues.Caption(V.Local.sTuesday)
GUI.FormTimesheet.lblClockHrsWed.Caption(V.Local.sWednesday)
GUI.FormTimesheet.lblClockHrsThur.Caption(V.Local.sThursday)
GUI.FormTimesheet.lblClockHrsFri.Caption(V.Local.sFriday)
GUI.FormTimesheet.lblClockHrsSat.Caption(V.Local.sSaturday)
GUI.FormTimesheet.lblClockHrsSun.Caption(V.Local.sSunday)

'GUI.FormTimesheet.txtHoursTA.Text(V.Local.sTotal)

F.Data.DataTable.Close("dtClock")

F.Intrinsic.String.Build("select SUM(HOURS_WORKED) HOURS from V_JOB_DETAIL where EMPL In ('{0}') and DATE_SEQUENCE between '{1}' and '{2}'", V.Local.sEmployee, V.Local.dStartDate.FormatYYYY-MM-DD, V.Local.dEndDate.FormatYYYY-MM-DD, V.Local.sSQL)
F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSQL,V.Local.fHours)

F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fHours)
V.Local.sTotal.Set(V.Args.Time)

GUI.FormTimesheet.txtHoursTA.Text(V.Local.sTotal)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("LoadClockInTime_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.LoadClockInTime.End

Program.Sub.EmptyTotals.Start
F.Intrinsic.Control.SetErrorHandler("EmptyTotals_Err")
F.Intrinsic.Control.ClearErrors

GUI.FormTimesheet.txtSunHrs.Text("0:00")
GUI.FormTimesheet.txtMonHrs.Text("0:00")
GUI.FormTimesheet.txtTuesHrs.Text("0:00")
GUI.FormTimesheet.txtWedHrs.Text("0:00")
GUI.FormTimesheet.txtThurHrs.Text("0:00")
GUI.FormTimesheet.txtFriHrs.Text("0:00")
GUI.FormTimesheet.txtSatHrs.Text("0:00")
GUI.FormTimesheet.txtTotHrs.Text("0:00")
GUI.FormTimesheet.txtHoursTA.Text("0:00")
GUI.FormTimesheet.txtHoursBalance.Text("0:00")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("EmptyTotals_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.EmptyTotals.End

Program.Sub.cmdAddSOBrows_click.Start
F.Intrinsic.Control.SetErrorHandler("cmdAddSOBrows_click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sSql.Declare(String)
V.Local.sTitle.Declare(String)
V.Local.sWidth.Declare(String)
V.Local.sRet.Declare(String)
V.Local.sJob.Declare(String)

'V.Local.sTitle.Set("Job*!*Suffix*!*Part*!*Description")
V.Local.sTitle.Set("Sales Order*!*Work Order*!*Customer Name*!*Proj Name*!*Part*!*Description")
V.Local.sWidth.Set("1200*!*1200*!*2700*!*2200*!*2000*!*3100")
V.Local.sJob.Set(v.screen.FormTimesheet!txtASO.text)
'F.Intrinsic.Control.If(V.Local.sJob.trim,<>,"")
'''	V.Local.sSql.Set("Select JOB, SUFFIX, PART, DESCRIPTION from V_JOB_HEADER ORDER BY JOB, SUFFIX")
'''	F.Intrinsic.String.Build("Select JOB, SUFFIX, PART, DESCRIPTION from V_JOB_HEADER where job >= '{0}' ORDER BY JOB, SUFFIX",v.screen.FormTimesheet!txtASO.text.trim,v.Local.sSql)
'	F.Intrinsic.String.Build("Select Distinct A.Order_No, Case When D.Suffix = '' or D.Suffix is null Then D.Job Else D.Job +'-'+D.Suffix End as WorkOrder, Name_Customer From V_Order_Header A Join V_Order_Lines B on A.Order_No = B.Order_No Left Join V_Customer_Master C on A.Customer = C.Customer Left Join V_Order_TO_WO D on B.Order_No = D.Order_NO and B.Record_No = D.Order_Line Where A.Order_No >= '{0}' Order by A.Order_No,D.Job,D.Suffix",V.Screen.FormTimesheet!txtASO.Text,V.Local.sSql)
'F.Intrinsic.Control.Else
''	V.Local.sSql.Set("Select JOB, SUFFIX, PART, DESCRIPTION from V_JOB_HEADER ORDER BY JOB, SUFFIX")
'	V.Local.sSql.Set("Select Distinct A.Order_No, Case When D.Suffix = '' or D.Suffix is null Then D.Job Else D.Job +'-'+D.Suffix End as WorkOrder, Name_Customer From V_Order_Header A Join V_Order_Lines B on A.Order_No = B.Order_No Left Join V_Customer_Master C on A.Customer = C.Customer Left Join V_Order_TO_WO D on B.Order_No = D.Order_NO and B.Record_No = D.Order_Line Order by A.Order_No,D.Job,D.Suffix")
'F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Global.bAdminMode)
	V.Local.sSql.Set("Select Distinct A.Order_No, Case When D.Suffix = '' or D.Suffix is null Then D.Job Else D.Job +'-'+D.Suffix End as WorkOrder, Name_Customer, A.CODE_SORT, B.PART, B.DESCRIPTION From V_Order_Header A Join V_Order_Lines B on A.Order_No = B.Order_No Left Join V_Customer_Master C on A.Customer = C.Customer Left Join V_Order_TO_WO D on B.Order_No = D.Order_NO and B.Record_No = D.Order_Line Order by A.Order_No,D.Job,D.Suffix")
F.Intrinsic.Control.Else
	V.Local.sSql.Set("Select Distinct A.Order_No, Case When D.Suffix = '' or D.Suffix is null Then D.Job Else D.Job +'-'+D.Suffix End as WorkOrder, Name_Customer, A.CODE_SORT, B.PART, B.DESCRIPTION From V_Order_Header A Join V_Order_Lines B on A.Order_No = B.Order_No Left Join V_Customer_Master C on A.Customer = C.Customer Left Join V_Order_TO_WO D on B.Order_No = D.Order_NO and B.Record_No = D.Order_Line Where D.Job <> '' Order by A.Order_No,D.Job,D.Suffix")
F.Intrinsic.Control.EndIf

'F.Intrinsic.Control.If(V.Global.bAdminMode)
'	V.Local.sSql.Set("Select Distinct A.Order_No, Case When D.Suffix = '' or D.Suffix is null Then D.Job Else D.Job +'-'+D.Suffix End as WorkOrder, Name_Customer, A.CODE_SORT, B.PART, B.DESCRIPTION From V_Order_Header A Join V_Order_Lines B on A.Order_No = B.Order_No Left Join V_Customer_Master C on A.Customer = C.Customer Left Join V_Order_TO_WO D on B.Order_No = D.Order_NO and B.Record_No = D.Order_Line Left Join V_INVENTORY_MSTR E on B.PART = E.PART Order by A.Order_No,D.Job,D.Suffix")
'F.Intrinsic.Control.Else
'	V.Local.sSql.Set("Select Distinct A.Order_No, Case When D.Suffix = '' or D.Suffix is null Then D.Job Else D.Job +'-'+D.Suffix End as WorkOrder, Name_Customer, A.CODE_SORT, B.PART, B.DESCRIPTION From V_Order_Header A Join V_Order_Lines B on A.Order_No = B.Order_No Left Join V_Customer_Master C on A.Customer = C.Customer Left Join V_Order_TO_WO D on B.Order_No = D.Order_NO and B.Record_No = D.Order_Line Left Join V_INVENTORY_MSTR E on B.PART = E.PART Where D.Job <> '' Order by A.Order_No,D.Job,D.Suffix")
'F.Intrinsic.Control.EndIf

F.Intrinsic.String.Split(V.Local.sTitle,"*!*",V.Local.sTitle)
F.Intrinsic.String.Split(V.Local.sWidth,"*!*",V.Local.sWidth)

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
F.Intrinsic.UI.Browser("Select Sales Order","con",V.Local.sSql,V.Local.sTitle,V.Local.sWidth,11500,8000,V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	gui.FormTimesheet.txtASO.Text(V.Local.sRet(0))
	gui.FormTimesheet.txtAWO.Text(V.Local.sRet(1))
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdAddSOBrows_click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdAddSOBrows_click.End

Program.Sub.cmdAddDeptBrows_click.Start
F.Intrinsic.Control.SetErrorHandler("cmdAddDeptBrows_click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sSql.Declare(String)
V.Local.sTitle.Declare(String)
V.Local.sWidth.Declare(String)
V.Local.sRet.Declare(String)
'V.Local.sWC.Declare(String)

'F.Intrinsic.Control.If(V.Screen.FormTimesheet!txtASO.Text,=,"")
'	F.Intrinsic.UI.Msgbox("No Order selected!","Select Sales Order")
'F.Intrinsic.Control.Else
'	V.Local.sTitle.Set("Sequence*!*Workcenter*!*Description")
'	V.Local.sWidth.Set("1200*!*1000*!*4800")
	V.Local.sTitle.Set("DEPT*!*DEPT NAME")
	V.Local.sWidth.Set("1000*!*4800")
	F.Intrinsic.String.Split(V.Local.sTitle,"*!*",V.Local.sTitle)
	F.Intrinsic.String.Split(V.Local.sWidth,"*!*",V.Local.sWidth)
	F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
'	F.Intrinsic.String.Build("Select SEQ, PART, DESCRIPTION from V_JOB_OPERATIONS where JOB = '{0}' AND SUFFIX = '{1}' AND LMO = 'L' and SEQ < 995000 order by job,suffix,seq",V.Screen.FormTimesheet!txtASO.Text,V.Screen.FormTimesheet!txtAWO.Text,V.Local.sSql)
	V.Local.sSql.Set("Select Dept_Id, rtrim(Dept_Name) From Departments Order by Dept_Id")
	F.Intrinsic.UI.Browser("Select Dept","con",V.Local.sSql,V.Local.sTitle,V.Local.sWidth,8000,8000,V.Local.sRet)

	F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
'		V.Local.sWC.set(V.Local.sRet(1))
'		F.Intrinsic.String.Left(v.Local.sWC,4,v.Local.sWC)
		gui.FormTimesheet.txtADept.Text(V.Local.sRet(0))
'		GUI.FormTimesheet.txtWC.Text(v.Local.sWC)
	F.Intrinsic.Control.EndIf

'F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdAddDeptBrows_click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdAddDeptBrows_click.End

Program.Sub.cmdadd_click.Start
F.Intrinsic.Control.SetErrorHandler("cmdadd_click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sSql.Declare(String)
v.Local.iCheck.Declare(Long)
v.Local.iCheck1.Declare(Long)
v.Local.iCheck2.Declare(Long)
v.Local.sWC.Declare(String)
v.Local.sJSS.Declare(String)
v.Local.sJS.Declare(String)
V.Local.sWCDesc.Declare(String)
V.Local.sPart.Declare(String)
V.Local.sJob.Declare(String)
V.Local.sSuffix.Declare(String)

v.Global.bSaveMsg.Set(False)
F.Intrinsic.Control.CallSub(cmdsave_click)

v.Local.sWC.Set(V.Screen.FormTimesheet!txtWC.text)

F.Intrinsic.String.UCase(v.Local.sWC,v.Local.sWC)
'F.Intrinsic.String.Build("Select count(JOB) from V_JOB_OPERATIONS WHERE JOB = '{0}' AND SUFFIX = '{1}' AND SEQ = '{2}'",V.Screen.FormTimesheet!txtASO.Text,V.Screen.FormTimesheet!txtAWO.Text,V.Screen.FormTimesheet!txtADept.Text,V.Local.sSql)
'F.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSql,V.Local.iCheck1)

'F.Intrinsic.String.Build("Select count(JOB) from V_JOB_HEADER WHERE JOB = '{0}' AND SUFFIX = '{1}'",V.Screen.FormTimesheet!txtASO.Text,V.Screen.FormTimesheet!txtAWO.Text,V.Local.sSql)
'F.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSql,V.Local.iCheck)
F.Intrinsic.String.Build("Select count(MACHINE) from WORKCENTERS WHERE MACHINE = '{0}'",v.Local.sWC,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSql,V.Local.iCheck2)

F.Intrinsic.Control.If(v.Global.bAdminMode)
	V.Global.sUser.Set(v.Screen.FormTimesheet!txtUser.text)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Screen.FormTimesheet!txtASO.Text.trim,=,"")
	F.Intrinsic.UI.Msgbox("No Sales Order selected or entered to save!","Add Sales Order")
F.Intrinsic.Control.ElseIf(V.Screen.FormTimesheet!txtADept.Text.TRIM,=,"")
	F.Intrinsic.UI.Msgbox("No Dept selected to save!","Select Dept")
F.Intrinsic.Control.ElseIf(V.Global.sUser.Trim,=,"")
	F.Intrinsic.UI.Msgbox("No Employee Selected!","Select Employee")
F.Intrinsic.Control.ElseIf(V.Screen.FormTimesheet!txtAWO.Text.trim,=,"")
	F.Intrinsic.UI.Msgbox("Select a Sales Order Record that has a Job","Attention")
'F.Intrinsic.Control.ElseIf(v.Local.iCheck,=,0)
'	F.Intrinsic.UI.Msgbox("Invalid Job and Suffix entered!","Incorrect Job or Suffix")
'F.Intrinsic.Control.ElseIf(v.Local.iCheck1,=,0)
'	F.Intrinsic.UI.Msgbox("Invalid Sequence entered!","Incorrect Sequence")
F.Intrinsic.Control.ElseIf(v.Local.iCheck2,=,0)
	F.Intrinsic.UI.Msgbox("Invalid Work Center entered!","Incorrect Work Center")
F.Intrinsic.Control.Else
'	F.Intrinsic.String.Build("Select * from GCG_6667_TIMSHT where UPPER(USER_ID) = '{0}' AND JOB = '{1}' AND SUFFIX = '{2}' AND SEQ = '{3}' AND BEG_WEEK = '{4}'",V.Global.sUser,V.Screen.FormTimesheet!txtASO.Text,V.Screen.FormTimesheet!txtAWO.Text,V.Screen.FormTimesheet!txtADept.Text,V.Global.dDate.PervasiveDate,V.Local.sSql)
	F.Intrinsic.String.Build("Select * from GCG_6667_TIMSHT where UPPER(USER_ID) = '{0}' AND SALESORDER = '{1}' AND WORKORDER = '{2}' AND DEPT = '{3}' AND BEG_WEEK = '{4}' AND WC = '{5}'",V.Global.sUser,V.Screen.FormTimesheet!txtASO.Text,V.Screen.FormTimesheet!txtAWO.Text,V.Screen.FormTimesheet!txtADept.Text,V.Global.dDate.PervasiveDate,V.Screen.FormTimesheet!txtWC.Text,V.Local.sSql)
	F.ODBC.Connection!con.OpenRecordsetRW("rst",V.Local.sSql)
	F.Intrinsic.Control.If(V.ODBC.con!rst.EOF,=,True)
		F.ODBC.con!rst.AddNew
		F.ODBC.con!rst.Set!USER_ID(V.Global.sUser)
		F.ODBC.con!rst.Set!SALESORDER(V.Screen.FormTimesheet!txtASO.Text)
		F.ODBC.con!rst.Set!WORKORDER(V.Screen.FormTimesheet!txtAWO.Text)
		F.ODBC.con!rst.Set!DEPT(V.Screen.FormTimesheet!txtADept.Text)
		F.ODBC.con!rst.Set!WC(v.Local.sWC)
		F.ODBC.con!rst.Set!BEG_WEEK(V.Global.dDate.PervasiveDate)
		F.ODBC.con!rst.Set!SUN_HRS(0)
		F.ODBC.con!rst.Set!SUN_NOTES("")
		F.ODBC.con!rst.Set!MON_HRS(0)
		F.ODBC.con!rst.Set!MON_NOTES("")
		F.ODBC.con!rst.Set!TUES_HRS(0)
		F.ODBC.con!rst.Set!TUES_NOTES("")
		F.ODBC.con!rst.Set!WED_HRS(0)
		F.ODBC.con!rst.Set!WED_NOTES("")
		F.ODBC.con!rst.Set!THUR_HRS(0)
		F.ODBC.con!rst.Set!THUR_NOTES("")
		F.ODBC.con!rst.Set!FRI_HRS(0)
		F.ODBC.con!rst.Set!FRI_NOTES("")
		F.ODBC.con!rst.Set!SAT_HRS(0)
		F.ODBC.con!rst.Set!SAT_NOTES("")
		F.ODBC.con!rst.Set!UPDATED(0)
		F.ODBC.con!rst.Set!Flag_Ready(0)
''		F.intrinsic.String.Concat(V.ODBC.con!rst.FieldValTrim!JOB,V.ODBC.con!rst.FieldValTrim!SUFFIX,V.ODBC.con!rst.FieldValTrim!SEQ,v.Local.sJSS)
''		F.intrinsic.String.Concat(V.ODBC.con!rst.FieldValTrim!JOB,V.ODBC.con!rst.FieldValTrim!SUFFIX,v.Local.sJS)
'		F.Data.DataTable.AddRow("dtTimesheet","JSS",v.Local.sJSS,"JS",v.Local.sJS,"Job",V.ODBC.con!rst.FieldValTrim!JOB,"Suffix",V.ODBC.con!rst.FieldValTrim!SUFFIX,"SEQ",V.ODBC.con!rst.FieldValTrim!SEQ,"WC",V.ODBC.con!rst.FieldValTrim!WC,"SUN_HRS",V.ODBC.con!rst.FieldVal!SUN_HRS,"MON_HRS",V.ODBC.con!rst.FieldVal!MON_HRS,"TUES_HRS",V.ODBC.con!rst.FieldVal!TUES_HRS,"WED_HRS",V.ODBC.con!rst.FieldVal!WED_HRS,"THUR_HRS",V.ODBC.con!rst.FieldVal!THUR_HRS,"FRI_HRS",V.ODBC.con!rst.FieldVal!FRI_HRS,"SAT_HRS",V.ODBC.con!rst.FieldVal!SAT_HRS,"UPDATED",V.ODBC.con!rst.FieldVal!UPDATED,"FLAG_READY",V.ODBC.con!rst.FieldVal!FLAG_READY,"Wrapper","A")
		F.Intrinsic.String.Split(V.ODBC.con!rst.FieldValTrim!WORKORDER,"-",V.Local.sJob)
		F.Intrinsic.Control.If(V.Local.sJob.UBound,>,0)
			V.Local.sSuffix.Set(V.Local.sJob(1))
		F.Intrinsic.Control.EndIf
'		F.Intrinsic.String.Build("Select Part From V_Job_Header where Job = '{0}' and Suffix = '{1}'",V.Local.sJob,V.Local.sSuffix,V.Local.sSql)
'		F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sPart)
		F.Intrinsic.String.Build("Select rtrim(WC_NAME) From WORKCENTERS Where Machine = '{0}'",v.Local.sWC,V.Local.sSql)
		F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sWCDesc)
		F.Data.DataTable.AddRow("dtTimesheet","USER_ID",V.Global.sUser.Trim,"SALESORDER",V.Screen.FormTimesheet!txtASO.Text,"WORKORDER",V.Screen.FormTimesheet!txtAWO.Text,"DEPT",V.Screen.FormTimesheet!txtADept.Text,"WC_DESC",V.Local.sWCDesc,"WC",v.Local.sWC,"SUN_HRS",V.ODBC.con!rst.FieldVal!SUN_HRS,"MON_HRS",V.ODBC.con!rst.FieldVal!MON_HRS,"TUES_HRS",V.ODBC.con!rst.FieldVal!TUES_HRS,"WED_HRS",V.ODBC.con!rst.FieldVal!WED_HRS,"THUR_HRS",V.ODBC.con!rst.FieldVal!THUR_HRS,"FRI_HRS",V.ODBC.con!rst.FieldVal!FRI_HRS,"SAT_HRS",V.ODBC.con!rst.FieldVal!SAT_HRS,"UPDATED",V.ODBC.con!rst.FieldVal!UPDATED,"FLAG_READY",V.ODBC.con!rst.FieldVal!FLAG_READY,"Wrapper","A")
'		F.Data.Datatable.FillFromDictionary("dtTimesheet","DescDict","JS","Description")
'		F.Data.Datatable.FillFromDictionary("dtTimesheet","FGDict","JS","Part")
'		F.Data.Datatable.FillFromDictionary("dtTimesheet","dictSeqDesc", "JSS", "SEQ_DESCRIPTION")
		F.Data.DataTable.FillFromDictionary("dtTimesheet","CustName","Salesorder","NAME_CUSTOMER")
		F.ODBC.con!rst.Update
		F.ODBC.con!rst.Close
		gui.FormTimesheet.txtASO.Text("")
		gui.FormTimesheet.txtAWO.Text("")
		gui.FormTimesheet.txtADept.Text("")
		GUI.FormTimesheet.txtWC.Text("")
		
	F.Intrinsic.Control.Else
		F.ODBC.con!rst.Close
		F.Intrinsic.UI.Msgbox("Job sequence already exists on timesheet!","Save Error")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.CallSub(cmdRefresh_click)
F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdadd_click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdadd_click.End

Program.Sub.cmdtemp_click.Start
F.Intrinsic.Control.SetErrorHandler("cmdtemp_click_Err")
F.Intrinsic.Control.ClearErrors

GUI.FormTimesheet..Enabled(False)
F.Intrinsic.Control.CallSub(Templist)
GUI.F_Template..Show

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdtemp_click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdtemp_click.End

Program.Sub.TempList.Start
F.Intrinsic.Control.SetErrorHandler("TempList_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sSql.Declare(String)
V.Local.sKey.Declare(String)
V.Local.sDesc.Declare(String)

'Loads Template listview with the template data found
GUI.F_Template.lvwTemp.ClearItems
'F.Intrinsic.String.Build("Select * from GCG_6667_TIMSHT_TEMP where UPPER(USER_ID) = '{0}' ORDER BY JOB,SUFFIX,SEQ",V.Global.sUser,V.Local.sSql)
F.Intrinsic.String.Build("Select * from GCG_6667_TIMSHT_TEMP where UPPER(USER_ID) = '{0}' ORDER BY SALESORDER,WORKORDER,DEPT,WC",V.Global.sUser,V.Local.sSql)
F.ODBC.Connection!con.OpenRecordsetRO("rst",V.Local.sSql)

F.Intrinsic.Control.DoUntil(V.ODBC.con!rst.EOF,=,True)
	F.Intrinsic.String.Build("{0}*!*{1}*!*{2}*!*{3}",V.ODBC.con!rst.FieldValTrim!SALESORDER,V.ODBC.con!rst.FieldValTrim!WORKORDER,V.ODBC.con!rst.FieldValTrim!WC,V.ODBC.con!rst.FieldValTrim!DEPT,V.Local.sKey)
	GUI.F_Template.lvwTemp.AddListItem(V.Local.sKey,V.ODBC.con!rst.FieldValTrim!SALESORDER)
	GUI.F_Template.lvwTemp.SetListItemSubItemText(V.Local.sKey,1,V.ODBC.con!rst.FieldValTrim!WORKORDER)
	GUI.F_Template.lvwTemp.SetListItemSubItemText(V.Local.sKey,2,V.ODBC.con!rst.FieldValTrim!DEPT)
	GUI.F_Template.lvwTemp.SetListItemSubItemText(V.Local.sKey,3,V.ODBC.con!rst.FieldValTrim!WC)
'	F.Intrinsic.String.Build("Select DESCRIPTION from V_JOB_OPERATIONS_WC where JOB = '{0}' AND SUFFIX = '{1}' AND SEQ = '{2}'",V.ODBC.con!rst.FieldValTrim!JOB,V.ODBC.con!rst.FieldValTrim!SUFFIX,V.ODBC.con!rst.FieldValTrim!SEQ,V.Local.sSql)
	F.Intrinsic.String.Build("Select B.Name_Customer From V_Order_Header A Join V_Customer_Master B on A.Customer = B.Customer Where A.Order_NO = '{0}'",V.ODBC.con!rst.FieldValTrim!SALESORDER,V.Local.sSql)
	F.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSql,V.Local.sDesc)
	F.Intrinsic.Control.If(V.Local.sDesc.Trim,=,"")
		F.Intrinsic.String.Build("Select B.Name_Customer From V_Order_Hist_Head A Join V_Customer_Master B on A.Customer = B.Customer Where A.Order_NO = '{0}'",V.ODBC.con!rst.FieldValTrim!SALESORDER,V.Local.sSql)
	F.Intrinsic.Control.EndIf
	
	GUI.F_Template.lvwTemp.SetListItemSubItemText(V.Local.sKey,4,V.Local.sDesc)
'	F.ODBC.Connection!con.OpenRecordsetRO("rstDesc",V.Local.sSql)

'	F.Intrinsic.Control.If(V.ODBC.con!rst.EOF,<>,True)
'		GUI.F_Template.lvwTemp.SetListItemSubItemText(V.Local.sKey,4,V.ODBC.con!rstDesc.FieldValTrim!DESCRIPTION)
'	F.Intrinsic.Control.EndIf

'	F.ODBC.con!rstDesc.Close
	F.ODBC.con!rst.MoveNext
F.Intrinsic.Control.Loop

F.ODBC.con!rst.Close

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("TempList_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.TempList.End

Program.Sub.f_template_unload.Start
F.Intrinsic.Control.SetErrorHandler("f_template_unload_Err")
F.Intrinsic.Control.ClearErrors

GUI.F_Template..Visible(False)
gui.F_Template.txtTmpSO.Text("")
gui.F_Template.txtTmpDept.Text("")
gui.F_Template.txtTmpWO.Text("")
GUI.FormTimesheet..Enabled(True)
GUI.FormTimesheet..setfocus

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("f_template_unload_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.f_template_unload.End

Program.Sub.cmdTmpSOBrows_click.Start
F.Intrinsic.Control.SetErrorHandler("cmdTmpSOBrows_click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sSql.Declare(String)
V.Local.sTitle.Declare(String)
V.Local.sWidth.Declare(String)
V.Local.sRet.Declare(String)

'V.Local.sTitle.Set("Job*!*Suffix*!*Part*!*Description")
'V.Local.sWidth.Set("1200*!*700*!*2200*!*2700")
'V.Local.sSql.Set("Select JOB, SUFFIX, PART, DESCRIPTION from V_JOB_HEADER ORDER BY JOB, SUFFIX")
V.Local.sTitle.Set("Sales Order*!*Work Order*!*Customer Name*!*Proj Name*!*Part*!*Description")
V.Local.sWidth.Set("1200*!*1200*!*2700*!*2200*!*2000*!*3100")
V.Local.sSql.Set("Select Distinct A.Order_No, Case When D.Suffix = '' or D.Suffix is null Then D.Job Else D.Job +'-'+D.Suffix End as WorkOrder, Name_Customer, A.CODE_SORT, B.PART, B.DESCRIPTION From V_Order_Header A Join V_Order_Lines B on A.Order_No = B.Order_No Left Join V_Customer_Master C on A.Customer = C.Customer Left Join V_Order_TO_WO D on B.Order_No = D.Order_NO and B.Record_No = D.Order_Line Where D.Job <> '' Order by A.Order_No,D.Job,D.Suffix")

F.Intrinsic.String.Split(V.Local.sTitle,"*!*",V.Local.sTitle)
F.Intrinsic.String.Split(V.Local.sWidth,"*!*",V.Local.sWidth)

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
'F.Intrinsic.UI.Browser("Select Job","con",V.Local.sSql,V.Local.sTitle,V.Local.sWidth,8000,8000,V.Local.sRet)
F.Intrinsic.UI.Browser("Select Sales Order","con",V.Local.sSql,V.Local.sTitle,V.Local.sWidth,11500,8000,V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	gui.F_Template.txtTmpSO.Text(V.Local.sRet(0))
	gui.F_Template.txtTmpWO.Text(V.Local.sRet(1))
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdTmpSOBrows_click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdTmpSOBrows_click.End

Program.Sub.cmdAddWC_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdAddWC_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sSql.Declare(String)
V.Local.sTitle.Declare(String)
V.Local.sWidth.Declare(String)
V.Local.sRet.Declare(String)

V.Local.sTitle.Set("Work Center*!*WC Name*!*WC Dept")
V.Local.sWidth.Set("1200*!*2700*!*1200")
V.Local.sSql.Set("Select MACHINE, WC_DEPT, WC_NAME from WORKCENTERS ORDER BY MACHINE, WC_DEPT")

F.Intrinsic.String.Split(V.Local.sTitle,"*!*",V.Local.sTitle)
F.Intrinsic.String.Split(V.Local.sWidth,"*!*",V.Local.sWidth)

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
F.Intrinsic.UI.Browser("Select WorkCenter","con",V.Local.sSql,V.Local.sTitle,V.Local.sWidth,8000,8000,V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	GUI.FormTimesheet.txtWC.Text(V.Local.sRet(0))
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdAddWC_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdAddWC_Click.End

Program.Sub.cmdTmpAddWC_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdTmpAddWC_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sSql.Declare(String)
V.Local.sTitle.Declare(String)
V.Local.sWidth.Declare(String)
V.Local.sRet.Declare(String)

V.Local.sTitle.Set("Work Center*!*WC Name*!*WC Dept")
V.Local.sWidth.Set("1200*!*2700*!*1200")
V.Local.sSql.Set("Select MACHINE, WC_DEPT, WC_NAME from WORKCENTERS ORDER BY MACHINE, WC_DEPT")

F.Intrinsic.String.Split(V.Local.sTitle,"*!*",V.Local.sTitle)
F.Intrinsic.String.Split(V.Local.sWidth,"*!*",V.Local.sWidth)

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
F.Intrinsic.UI.Browser("Select WorkCenter","con",V.Local.sSql,V.Local.sTitle,V.Local.sWidth,8000,8000,V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	GUI.F_Template.txtTmpWC.Text(V.Local.sRet(0))
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdTmpAddWC_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdTmpAddWC_Click.End

Program.Sub.cmdTmpDeptBrows_click.Start
F.Intrinsic.Control.SetErrorHandler("cmdTmpDeptBrows_click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sSql.Declare(String)
V.Local.sTitle.Declare(String)
V.Local.sWidth.Declare(String)
V.Local.sRet.Declare(String)
V.Local.sWC.Declare(String)

F.Intrinsic.Control.If(V.Screen.F_Template!txtTmpSO.Text,=,"")
	F.Intrinsic.UI.Msgbox("No Order selected!","Select Sales Order")
F.Intrinsic.Control.Else
'	V.Local.sTitle.Set("Sequence*!*Workcenter*!*Description")
'	V.Local.sWidth.Set("1200*!*1000*!*4800")
	V.Local.sTitle.Set("DEPT*!*DEPT NAME")
	V.Local.sWidth.Set("1000*!*4800")
	
	F.Intrinsic.String.Split(V.Local.sTitle,"*!*",V.Local.sTitle)
	F.Intrinsic.String.Split(V.Local.sWidth,"*!*",V.Local.sWidth)

	F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
'	F.Intrinsic.String.Build("Select SEQ, PART, DESCRIPTION from V_JOB_OPERATIONS where JOB = '{0}' AND SUFFIX = '{1}' AND LMO = 'L' and SEQ < 995000 ORDER BY Job,Suffix,SEQ",V.Screen.F_Template!txtTmpSO.Text,V.Screen.F_Template!txtTmpWO.Text,V.Local.sSql)
'	F.Intrinsic.UI.Browser("Select Sequence","con",V.Local.sSql,V.Local.sTitle,V.Local.sWidth,8000,8000,V.Local.sRet)
	V.Local.sSql.Set("Select Dept_Id, rtrim(Dept_Name) From Departments Order by Dept_Id")
	F.Intrinsic.UI.Browser("Select Dept","con",V.Local.sSql,V.Local.sTitle,V.Local.sWidth,8000,8000,V.Local.sRet)
	
	F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
'		V.Local.sWC.set(V.Local.sRet(1))
'		F.Intrinsic.String.Left(v.Local.sWC,4,v.Local.sWC)
		gui.F_Template.txtTmpDept.Text(V.Local.sRet(0))
'		GUI.F_Template.txtTmpWC.Text(v.Local.sWC)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdTmpDeptBrows_click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdTmpDeptBrows_click.End

Program.Sub.cmdtmpadd_click.Start
F.Intrinsic.Control.SetErrorHandler("cmdtmpadd_click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sSql.Declare(String)
v.Local.iCheck.Declare(Long)
v.Local.iCheck1.Declare(Long)
v.Local.iCheck2.Declare(Long)
v.Local.sWC.Declare(String)

v.Global.bSaveMsg.Set(False)

v.Local.sWC.Set(V.Screen.F_Template!txtTmpWC.text)

F.Intrinsic.String.UCase(v.Local.sWC,v.Local.sWC)
'F.Intrinsic.String.Build("Select count(JOB) from V_JOB_OPERATIONS WHERE JOB = '{0}' AND SUFFIX = '{1}' AND SEQ = '{2}'",V.Screen.F_Template!txtTmpSO.text,V.Screen.F_Template!txtTmpWO.text,V.Screen.F_Template!txtTmpDept.Text,V.Local.sSql)
'F.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSql,V.Local.iCheck1)

'F.Intrinsic.String.Build("Select count(JOB) from V_JOB_HEADER WHERE JOB = '{0}' AND SUFFIX = '{1}'",V.Screen.F_Template!txtTmpSO.Text,V.Screen.F_Template!txtTmpWO.Text,V.Local.sSql)
'F.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSql,V.Local.iCheck)
F.Intrinsic.String.Build("Select count(MACHINE) from WORKCENTERS WHERE MACHINE = '{0}'",v.Local.sWC,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSql,V.Local.iCheck2)

F.Intrinsic.Control.If(V.Screen.F_Template!txtTmpSO.Text,=,"")
	F.Intrinsic.UI.Msgbox("No Order selected to save!","Save Order")
F.Intrinsic.Control.ElseIf(V.Screen.F_Template!txtTmpDept.Text,=,"")
	F.Intrinsic.UI.Msgbox("No Dept selected to save!","Save Dept")
F.Intrinsic.Control.ElseIf(V.Screen.F_Template!txtTmpWC.Text,=,"")	
	F.Intrinsic.UI.Msgbox("No Workcenter selected to save!","Save Work Center")
'F.Intrinsic.Control.ElseIf(v.Local.iCheck,=,0)
'	F.Intrinsic.UI.Msgbox("Invalid Job and Suffix entered!","Incorrect Job or Suffix")
'F.Intrinsic.Control.ElseIf(v.Local.iCheck1,=,0)
'	F.Intrinsic.UI.Msgbox("Invalid Sequence entered!","Incorrect Sequence")
F.Intrinsic.Control.ElseIf(v.Local.iCheck2,=,0)
	F.Intrinsic.UI.Msgbox("Invalid Work Center entered!","Incorrect Work Center")
F.Intrinsic.Control.Else
	
	F.Intrinsic.String.Build("Select * from GCG_6667_TIMSHT_TEMP where UPPER(USER_ID) = '{0}' AND SALESORDER = '{1}' AND WORKORDER = '{2}' AND DEPT = '{3}' AND WC = '{4}'",V.Global.sUser,V.Screen.F_Template!txtTmpSO.Text,V.Screen.F_Template!txtTmpWO.Text,V.Screen.F_Template!txtTmpDept.Text,V.Screen.F_Template!txtTmpWC.Text,V.Local.sSql)
	F.ODBC.Connection!con.OpenRecordsetRW("rst",V.Local.sSql)

	F.Intrinsic.Control.If(V.ODBC.con!rst.EOF,=,True)
		F.ODBC.con!rst.AddNew
		F.ODBC.con!rst.Set!USER_ID(V.Global.sUser)
		F.ODBC.con!rst.Set!SalesOrder(V.Screen.F_Template!txtTmpSO.Text)
		F.ODBC.con!rst.Set!WorkOrder(V.Screen.F_Template!txtTmpWO.Text)
		F.ODBC.con!rst.Set!Dept(V.Screen.F_Template!txtTmpDept.Text)
		F.ODBC.con!rst.Set!WC(V.Screen.F_Template!txtTmpWC.Text)
		F.ODBC.con!rst.Update
		gui.F_Template.txtTmpSO.Text("")
		gui.F_Template.txtTmpWO.Text("")
		gui.F_Template.txtTmpDept.Text("")
		GUI.F_Template.txtTmpWC.Text("")
		F.ODBC.con!rst.Close
		F.Intrinsic.Control.CallSub(Templist)
	F.Intrinsic.Control.Else
		F.ODBC.con!rst.Close
		F.Intrinsic.UI.Msgbox("Job sequence already exists on template!","Sequence Exists")
	F.Intrinsic.Control.EndIf

F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdtmpadd_click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdtmpadd_click.End

Program.Sub.cmdtmpdelete_click.Start
F.Intrinsic.Control.SetErrorHandler("cmdtmpdelete_click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sSql.Declare(String)
V.Local.sRet.Declare(String)

F.Intrinsic.Control.If(V.Screen.F_Template!txtTmpSO.Text,=,"")
	F.Intrinsic.UI.Msgbox("No Order selected to delete!","Delete Order")
F.Intrinsic.Control.ElseIf(V.Screen.F_Template!txtTmpDept.Text,=,"")
	F.Intrinsic.UI.Msgbox("No Dept selected to delete!","Delete Dept")
F.Intrinsic.Control.Else
	F.Intrinsic.UI.Msgbox("Are you sure you want to delete this record from template?","Delete Record",4,V.Local.sRet)
	
	F.Intrinsic.Control.If(V.Local.sRet,=,"6")
		F.Intrinsic.String.Build("Delete from GCG_6667_TIMSHT_TEMP where UPPER(USER_ID) = '{0}' AND SALESORDER = '{1}' AND WORKORDER = '{2}' AND DEPT = '{3}' AND WC = '{4}'",v.Global.sUser,V.Screen.F_Template!txtTmpSO.Text,V.Screen.F_Template!txtTmpWO.Text,V.Screen.F_Template!txtTmpDept.Text,V.Screen.F_Template!txtTmpWC.Text,V.Local.sSql)
		F.ODBC.Connection!con.Execute(V.Local.sSql)
		gui.F_Template.txtTmpSO.Text("")
		gui.F_Template.txtTmpWO.Text("")
		gui.F_Template.txtTmpDept.Text("")
		F.Intrinsic.Control.CallSub(Templist)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdtmpdelete_click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdtmpdelete_click.End

Program.Sub.cmdtmpdeleteall_click.Start
F.Intrinsic.Control.SetErrorHandler("cmdtmpdeleteall_click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sSql.Declare(String)
V.Local.sRet.Declare(String)

F.Intrinsic.UI.Msgbox("This will delete your entire template, are you sure?","Delete Template",4,V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet,=,"6")
	F.Intrinsic.String.Build("Delete GCG_6667_TIMSHT_TEMP where UPPER(USER_ID) = '{0}'",V.Global.sUser,V.Local.sSql)
	F.ODBC.Connection!con.Execute(V.Local.sSql)
	gui.F_Template.txtTmpSO.Text("")
	gui.F_Template.txtTmpWO.Text("")
	gui.F_Template.txtTmpDept.Text("")
	F.Intrinsic.Control.CallSub(Templist)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdtmpdeleteall_click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdtmpdeleteall_click.End

Program.Sub.lvwtemp_itemclick.Start
F.Intrinsic.Control.SetErrorHandler("lvwtemp_itemclick_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sRet.Declare(String)

'Template Entries Screen, this sets the values of the textboxes to the values you selected in the grid
F.Intrinsic.String.Split(V.Screen.F_Template!lvwTemp.SelectedItemKey,"*!*",V.Local.sRet)
gui.F_Template.txtTmpSO.Text(V.Local.sRet(0))
gui.F_Template.txtTmpWO.Text(V.Local.sRet(1))
gui.F_Template.txtTmpWC.Text(V.Local.sRet(2))
gui.F_Template.txtTmpDept.Text(V.Local.sRet(3))

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("lvwtemp_itemclick_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.lvwtemp_itemclick.End

Program.Sub.cmdsave_click.Start
F.Intrinsic.Control.SetErrorHandler("cmdsave_click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.i.Declare(Long)
V.Local.sSql.Declare(String)
V.Local.iRow.Declare(Long)
V.Local.sRow.Declare(String)
V.Local.sRowArray.Declare(String)
V.Local.sMap.Declare(String)

F.Data.DataView.ToDataTable("dtTimesheet","dvTimesheet","SavinDT")

'F.Data.DataView.Create("SavinDT","SaveVw",22,"UPDATED = 0","")
F.Data.DataView.Create("SavinDT","SaveVw",22,"","")

F.Data.DataView.ToDataTable("SavinDT","SaveVw","SaveDT")

'F.Data.DataTable.AddColumn("SaveDT","USER_ID","STRING")
'F.Data.DataTable.SetValue("SaveDT",-1,"USER_ID",V.Global.sUser)

F.Data.DataTable.AddColumn("SaveDT","BEG_WEEK","STRING")
F.Data.DataTable.SetValue("SaveDT",-1,"BEG_WEEK",V.Global.dDate.PervasiveDate)

v.Local.sMap.set("USER_ID@!@USER_ID*!*SALESORDER@!@SALESORDER*!*WORKORDER@!@WORKORDER*!*DEPT@!@DEPT*!*BEG_WEEK@!@BEG_WEEK*!*WC@!@WC*!*SUN_HRS@!@SUN_HRS*!*MON_HRS@!@MON_HRS*!*TUES_HRS@!@TUES_HRS*!*WED_HRS@!@WED_HRS*!*THUR_HRS@!@THUR_HRS*!*FRI_HRS@!@FRI_HRS*!*SAT_HRS@!@SAT_HRS*!*UPDATED@!@UPDATED*!*FLAG_READY@!@FLAG_READY*!*SUN_NOTES@!@SUN_NOTES*!*MON_NOTES@!@MON_NOTES*!*TUES_NOTES@!@TUES_NOTES*!*WED_NOTES@!@WED_NOTES*!*THUR_NOTES@!@THUR_NOTES*!*FRI_NOTES@!@FRI_NOTES*!*SAT_NOTES@!@SAT_NOTES")
Function.Data.DataTable.SaveToDB("SaveDT","con","GCG_6667_TIMSHT","USER_ID*!*SALESORDER*!*WORKORDER*!*DEPT*!*WC*!*BEG_WEEK",256,v.Local.sMap)

F.Data.DataTable.Close("SaveDT")
F.Data.DataTable.Close("SavinDT")

F.Intrinsic.Control.If(v.Global.bSaveMsg,=,true)
	F.Intrinsic.UI.Msgbox("All records saved!","Save Records")
	v.Global.bSaveMsg.Set(false)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.CallSub(GridTitle)

F.Intrinsic.Control.CallSub(ComputeTotals)

v.Global.bSaveMsg.Set(false)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdsave_click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdsave_click.End

Program.Sub.cmdupdate_click.Start
F.Intrinsic.Control.SetErrorHandler("cmdupdate_click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sSql.Declare(String)
V.Local.iRet.Declare(Long)
V.Local.sEmp.Declare(String)
V.Local.sDay.Declare(String)
V.Local.sFile.Declare(String)
V.Local.sExecute.Declare(String)
V.Local.sRet.Declare(String)
V.Local.sQuery.Declare(String)
V.Local.sFilter.Declare(String)

'F.Intrinsic.Control.If(V.Global.iRun,<,1)
'	F.Intrinsic.Math.Add(V.Global.iRun,1,V.Global.iRun)
'	GUI.FormTimesheet.dtpWeek.Enabled(False)
'	F.Intrinsic.Control.If(V.Global.bAdminMode,=,True,"AND",V.Screen.FormTimesheet!chkAllEmployees.Value,=,1)
'		F.Intrinsic.UI.Msgbox("Are you sure you want to post this week's hours to Global Shop for ALL EMPLOYEES whose records are marked as READY?","Update Records",4,V.Local.iRet)
'	F.Intrinsic.Control.Else
'		F.Intrinsic.UI.Msgbox("Are you sure you want to post this week's hours to Global Shop?","Update Records",4,V.Local.iRet)
'	F.Intrinsic.Control.EndIf
'	V.Global.iChk.Set(1)
'	F.Intrinsic.Control.CallSub(Cmdsave_click)
'	V.Global.iChk.Set(0)

'	F.Intrinsic.Control.If(V.Local.iRet,=,6)
'		F.Intrinsic.Control.If(V.Screen.FormTimesheet!chkAllEmployees.Value,=,1)
'			F.Intrinsic.String.Build("Select Distinct UPPER(user_ID) AS user_ID from GCG_6667_TIMSHT Where BEG_WEEK = '{0}' And Flag_Ready = '1' and Updated = '0' Order By User_ID",V.Global.dDate.PervasiveDate,V.Local.sSql)
'		F.Intrinsic.Control.Else
'			F.Intrinsic.String.Build("Select Distinct UPPER(USER_ID) as USER_ID from GCG_6667_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}' And Flag_ready = '1' and Updated = '0'",V.Global.sUser,V.Global.dDate.PervasiveDate,V.Local.sSql)
'		F.Intrinsic.Control.EndIf

'		F.ODBC.Connection!con.OpenRecordsetRW("rst",V.Local.sSql)

'		F.Intrinsic.Control.If(V.ODBC.con!rst.EOF,=,True)
'			F.Intrinsic.UI.Msgbox("No saved records to update!","Save Records")
'		
'		F.Intrinsic.Control.Else
'	
'	'fudge
'	'we have to loop through our recordset, requery the info cause all we want is the current line, then do it all over again.
'				F.Intrinsic.Control.DoUntil(V.ODBC.con!rst.EOF,=,True)

'					F.Intrinsic.UI.InvokeWaitDialog("Loading records to Global Shop!","Update")
'					
'					F.Intrinsic.String.Build("Select EMPLOYEE from V_EMPLOYEE_MSTR where PR_USER_ID = '{0}'",V.ODBC.con!rst.FieldValTrim!User_ID,V.Local.sQuery)
'					F.ODBC.Connection!con.OpenLocalRecordsetRO("rstEmp",V.Local.sQuery)
'					F.Intrinsic.Control.If(V.ODBC.con!rstEmp.EOF,=,False)
'						V.Local.sEmp.Set(V.ODBC.con!rstEmp.FieldValTrim!Employee)
'					F.Intrinsic.Control.Else
''						letthemselecttheemployee? cause it's blank. may be a setup issue, but lets handle it.
'						F.Intrinsic.String.Build("Employee ID can't be found for User: {0}. Please select now.",V.ODBC.con!rst.FieldValTrim!User_ID,V.Local.sQuery)
'						F.Intrinsic.UI.Msgbox(V.Local.sQuery)
'						F.Intrinsic.UI.Browser(51,"",V.Local.sRet)
'						F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"***CANCEL***")
'							F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
'							V.Local.sEmp.Set(V.Local.sRet(0).Trim)
'						F.Intrinsic.Control.Else
'							V.Local.sEmp.Set("")
'						F.Intrinsic.Control.EndIf
'					F.Intrinsic.Control.EndIf
'					F.ODBC.con!rstEmp.Close

'					F.Intrinsic.Control.If(V.Local.sEmp.Trim,<>,"")
'						F.Intrinsic.Control.If(v.DataTable.DTtime.Exists,=,True)
'							F.Data.DataTable.Close("DTtime")
'						F.Intrinsic.Control.EndIf
'						F.Intrinsic.String.Build("Select * from GCG_6667_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}' And Flag_ready = '1' and updated = '0'",V.ODBC.con!rst.FieldValTrim!USER_ID,V.Global.dDate.PervasiveDate,V.Local.sSql)
'						F.Data.DataTable.CreateFromSQL("DTtime","con",v.local.sSql,true)
'						F.Intrinsic.String.Build("Update GCG_6667_Timsht Set Updated = '1' Where Beg_Week = '{0}' And UPPER(USER_ID) = '{1}'",V.Global.dDate.PervasiveDate,V.ODBC.con!rst.FieldValTrim!User_ID,V.Local.sSql)
'						F.ODBC.Connection!con.Execute(V.Local.sSql)
'						
'						V.Local.sDay.Set("Sun")
'						F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","SUN_HRS")
'								
'						V.Local.sDay.Set("Mon")
'						F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","MON_HRS")
'						
'						V.Local.sDay.Set("Tues")
'						F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","TUES_HRS")
'						
'						V.Local.sDay.Set("Wed")
'						F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","WED_HRS")
'						
'						V.Local.sDay.Set("Thur")
'						F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","THUR_HRS")
'						
'						V.Local.sDay.Set("Fri")
'						F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","FRI_HRS")
'						
'						V.Local.sDay.Set("Sat")
'						F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","SAT_HRS")

'						F.Intrinsic.Control.CallSub(JB0455Sync)
'						
''						F.ODBC.Connection!con.Execute(V.Local.sSql)
'					F.Intrinsic.Control.EndIf

'					F.ODBC.con!rst.MoveNext
'				F.Intrinsic.Control.Loop
'				
'				GUI.FormTimesheet.cmdUpdate.Enabled(False)
'				GUI.FormTimesheet.gsgcTimesheet.Enabled(False)
'				F.Intrinsic.UI.CloseWaitDialog

'		F.Intrinsic.Control.EndIf
'		F.ODBC.con!rst.close
'	F.Intrinsic.Control.EndIf

'	V.Global.iRun.Set(0)
'	GUI.FormTimesheet.dtpWeek.Enabled(True)
'F.Intrinsic.Control.EndIf

F.Data.DataView.Create("dtTimesheet","JobDtl",22,"[Flag_Ready] = True and [Updated] = False","USER_ID")
F.Data.DataView.ToDataTableDistinct("dtTimesheet","JobDtl","Users","USER_ID",True)
F.Data.DataView.Close("dtTimesheet","JobDtl")
F.Intrinsic.Control.For(V.Local.iRet,0,V.DataTable.Users.RowCount--,1)
	F.Intrinsic.String.Build("Select EMPLOYEE from V_EMPLOYEE_MSTR where PR_USER_ID = '{0}'",V.DataTable.Users(V.Local.iRet).User_Id!FieldValTrim,V.Local.sQuery)
	F.ODBC.Connection!con.OpenLocalRecordsetRO("rstEmp",V.Local.sQuery)
	F.Intrinsic.Control.If(V.ODBC.con!rstEmp.EOF,=,False)
		V.Local.sEmp.Set(V.ODBC.con!rstEmp.FieldValTrim!Employee)
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("Employee ID can't be found for User: {0}. Please select now.",V.DataTable.Users(V.Local.iRet).User_Id!FieldValTrim,V.Local.sQuery)
		F.Intrinsic.UI.Msgbox(V.Local.sQuery)
		F.Intrinsic.UI.Browser(51,"",V.Local.sRet)
		F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"***CANCEL***")
			F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
			V.Local.sEmp.Set(V.Local.sRet(0).Trim)
		F.Intrinsic.Control.Else
			V.Local.sEmp.Set("")
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	F.ODBC.con!rstEmp.Close
	F.Intrinsic.Control.If(V.Local.sEmp.Trim,<>,"")
		F.Intrinsic.String.Build("[Flag_Ready] = True and [Updated] = False and [User_ID] = '{0}'",V.DataTable.Users(V.Local.iRet).User_Id!FieldValTrim,V.Local.sFilter)
		F.Data.DataView.Create("dtTimesheet","JobDtl",22,V.Local.sFilter,"USER_ID")
		F.Intrinsic.Control.If(V.DataView.dtTimesheet!JobDtl.RowCount--,<>,-1)
			F.Data.DataView.ToDataTable("dtTimesheet","JobDtl","DTtime",True)
			V.Local.sDay.Set("Sun")
			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","SUN_HRS")
					
			V.Local.sDay.Set("Mon")
			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","MON_HRS")
			
			V.Local.sDay.Set("Tues")
			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","TUES_HRS")
			
			V.Local.sDay.Set("Wed")
			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","WED_HRS")
			
			V.Local.sDay.Set("Thur")
			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","THUR_HRS")
			
			V.Local.sDay.Set("Fri")
			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","FRI_HRS")
			
			V.Local.sDay.Set("Sat")
			F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","SAT_HRS")

			F.Intrinsic.Control.CallSub(JB0455Sync)
			F.Data.DataTable.Close("DTtime")
			F.Data.DataView.SetValue("dtTimesheet","JobDtl",-1,"Updated",True)
		F.Intrinsic.Control.EndIf
		F.Data.DataView.Close("dtTimesheet","JobDtl")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Next(V.Local.iRet)

F.Data.DataTable.Close("Users")

F.Intrinsic.Control.CallSub(cmdSave_Click)

GUI.FormTimesheet..AlwaysOnTop(True)
GUI.FormTimesheet..AlwaysOnTop(False)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdupdate_click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdupdate_click.End

Program.Sub.BuildFile.Start
F.Intrinsic.Control.SetErrorHandler("BuildFile_Err")
F.Intrinsic.Control.ClearErrors

V.Local.dDate.Declare(Date)
V.Local.sDate.Declare(String)
V.Local.iDay.Declare(Long)
V.Local.sDay.Declare(String)
V.Local.sBegTime.Declare(String)
V.Local.i.Declare(Long)
V.Local.sHrs.Declare(String)
V.Local.sTime.Declare(String)
V.Local.sStart.Declare(String)
V.Local.sStop.Declare(String)
V.Local.sStartHH.Declare(String)
V.Local.sStartMM.Declare(String)
V.Local.sStopHH.Declare(String)
V.Local.sStopMM.Declare(String)
V.Local.sSql.Declare(String)
V.Local.sJob.Declare(String)
V.Local.sSuff.Declare(String)
V.Local.sSeq.Declare(String)
V.Local.sWC.Declare(String)
v.Local.fMm.Declare(Float)
V.Local.sRet.Declare(String)
V.Local.sWG.Declare(String)

F.Intrinsic.Control.If(V.Args.Day,=,"Sun")
	V.Local.dDate.Set(V.Global.dDate)
	V.Local.iDay.Set(7)
	V.Local.sDay.Set("START_SUN")
F.Intrinsic.Control.ElseIf(V.Args.Day,=,"Mon")
	F.Intrinsic.Date.DateAdd("D",1,V.Global.dDate,V.Local.dDate)
	V.Local.iDay.Set(1)
	V.Local.sDay.Set("START_MON")
F.Intrinsic.Control.ElseIf(V.Args.Day,=,"Tues")
	F.Intrinsic.Date.DateAdd("D",2,V.Global.dDate,V.Local.dDate)
	V.Local.iDay.Set(2)
	V.Local.sDay.Set("START_TUE")
F.Intrinsic.Control.ElseIf(V.Args.Day,=,"Wed")
	F.Intrinsic.Date.DateAdd("D",3,V.Global.dDate,V.Local.dDate)
	V.Local.iDay.Set(3)
	V.Local.sDay.Set("START_WED")
F.Intrinsic.Control.ElseIf(V.Args.Day,=,"Thur")
	F.Intrinsic.Date.DateAdd("D",4,V.Global.dDate,V.Local.dDate)
	V.Local.iDay.Set(4)
	V.Local.sDay.Set("START_THR")
F.Intrinsic.Control.ElseIf(V.Args.Day,=,"Fri")
	F.Intrinsic.Date.DateAdd("D",5,V.Global.dDate,V.Local.dDate)
	V.Local.iDay.Set(5)
	V.Local.sDay.Set("START_FRI")
F.Intrinsic.Control.ElseIf(V.Args.Day,=,"Sat")
	F.Intrinsic.Date.DateAdd("D",6,V.Global.dDate,V.Local.dDate)
	V.Local.iDay.Set(6)
	V.Local.sDay.Set("START_SAT")
F.Intrinsic.Control.EndIf

'grab actual clock in time for start time
F.Intrinsic.String.Build("select RTRIM(SUBSTRING(TIME_IN, 1, 4)) from TIME_ATTENDANCE where EMPLOYEE = '{0}' and CHARGE_DATE = '{1}'", V.Args.Emp, V.Local.dDate.FormatYYYYMMDD, V.Local.sSQL)
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql, V.Local.sRet)
F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
	V.Local.sBegTime.Set("0800")
	V.Local.sStart.Set("0800")
	V.Local.sStop.Set("0800")
F.Intrinsic.Control.Else
	F.Intrinsic.Control.If(V.Local.sRet.Trim, =, "")
		V.Local.sBegTime.Set("0800")
		V.Local.sStart.Set("0800")
		V.Local.sStop.Set("0800")
	F.Intrinsic.Control.Else
		V.Local.sBegTime.Set(V.Local.sRet)
		F.Intrinsic.Math.Div(V.Local.sRet.Right2, 0.6, V.Local.sRet)
		F.Intrinsic.String.Format(V.Local.sRet, "00", V.Local.sRet)
		F.Intrinsic.String.Build("{0}{1}", V.Local.sBegTime.Left2, V.Local.sRet, V.Local.sStart)
		V.Local.sStop.Set(V.Local.sStart)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.For(V.Local.i,0,v.DataTable.DTtime.RowCount--,1)
	F.Intrinsic.Control.If(v.DataTable.DTtime(V.Local.i).[V.Args.Col]!FieldValFloat,<>,0)
	
		F.Intrinsic.String.Format(v.DataTable.DTtime(V.Local.i).[V.Args.Col]!FieldValFloat,"#0.0000",V.Local.sHrs)
		F.Intrinsic.String.Format(v.DataTable.DTtime(V.Local.i).[V.Args.Col]!FieldValFloat,"00.00",V.Local.sTime)
		
		V.Local.sStart.Set(V.Local.sStop)
		F.Intrinsic.String.Right(V.Local.sStart,2,V.Local.sStartMM)
		F.Intrinsic.String.Left(V.Local.sStart,2,V.Local.sStartHH)
		F.Intrinsic.String.Right(V.Local.sTime,2,V.Local.sStopMM)
		F.Intrinsic.String.Left(V.Local.sTime,2,V.Local.sStopHH)
		F.Intrinsic.Math.Add(V.Local.sStartHH,V.Local.sStopHH,V.Local.sStopHH)
		
		'at this point, stop is in decimal and start is in minutes
		F.Intrinsic.Math.Mult(V.Local.sStopMM, 0.6, V.Local.sStopMM)
		F.Intrinsic.Math.Add(V.Local.sStartMM,V.Local.sStopMM,V.Local.sStopMM)
		
		F.Intrinsic.Control.If(V.Local.sStopMM.Long, >= , 60)
			F.Intrinsic.Math.Add(V.Local.sStopHH,1,V.Local.sStopHH)
			F.Intrinsic.Math.Sub(V.Local.sStopMM,60,V.Local.sStopMM)
		F.Intrinsic.Control.EndIf

		F.Intrinsic.String.Format(V.Local.sStopHH,"00",V.Local.sStopHH)
		F.Intrinsic.String.Format(V.Local.sStopMM,"00",V.Local.sStopMM)
		F.Intrinsic.String.Build("{0}{1}",V.Local.sStopHH,V.Local.sStopMM,V.Local.sStop)

		F.Intrinsic.Control.If(V.Local.sStop,=,"2400")
			V.Local.sStop.Set("2359")
		F.Intrinsic.Control.EndIf

'		V.Local.sJob.Set(v.DataTable.DTtime(V.Local.i).Job!FieldVal)
'		V.Local.sSuff.Set(v.DataTable.DTtime(V.Local.i).Suffix!FieldVal)
'		V.Local.sSeq.Set(v.DataTable.DTtime(V.Local.i).Seq!FieldVal)
'		F.Intrinsic.String.Build("Select WORKCENTER from V_JOB_OPERATIONS_WC where JOB = '{0}' AND SUFFIX = '{1}' AND SEQ = '{2}'",V.Local.sJob,V.Local.sSuff,V.Local.sSeq,V.Local.sSql)
'		F.Intrinsic.String.Build("Select WORKCENTER from V_JOB_OPERATIONS_WC where JOB = '{0}' AND SUFFIX = '{1}' AND SEQ = '{2}'",V.Local.sJob,V.Local.sSuff,V.Local.sSeq,V.Local.sSql)
'		F.ODBC.Connection!con.OpenLocalRecordsetRO("rstWC",V.Local.sSql)
		V.Local.sWC.Set(v.DataTable.DTtime(V.Local.i).WC!FieldValTrim)
		F.Intrinsic.String.Split(v.DataTable.DTtime(V.Local.i).WorkOrder!FieldValTrim,"-",V.Local.sJob)
		F.Intrinsic.Control.If(V.Local.sJob.UBound,>,0)
			V.Local.sSuff.Set(V.Local.sJob(1))
		F.Intrinsic.Control.EndIf
'		F.ODBC.con!rstWC.Close
		F.Intrinsic.String.Format(V.Local.dDate,"MMDDYY",V.Local.sDate)
		
		F.Intrinsic.Control.If(V.Local.sJob.Trim,<>,"")
			F.Intrinsic.String.Build("Select WorkGroup From WorkGroup_Line where WorkCenter = '{0}'",V.Local.sWC,V.Local.sWG)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sWG)
			F.Intrinsic.String.Build("Select Top 1 Seq from V_JOB_OPERATIONS where JOB = '{0}' AND SUFFIX = '{1}' AND (Part = '{2}' or Part = '{3}') and LMO = 'L'",V.Local.sJob,V.Local.sSuff,V.Local.sWC,V.Local.sWG,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sSeq)
			F.Intrinsic.Control.If(V.Local.sSeq.Trim,=,"")
				V.Local.sSeq.Set("996000")
			F.Intrinsic.Control.EndIf
			F.Data.DataTable.AddRow("JB0455","Date",V.Local.sDate,"Employee",V.Args.Emp,"Job",V.Local.sJob,"Suffix",V.Local.sSuff,"Seq",V.Local.sSeq,"WC",V.Local.sWC,"Closed","N","Indirect","D","StartTime",V.Local.sStart,"StopTime",V.Local.sStop,"RateType","R","GoodPcs","0","ScrapPcs","0")
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Next(V.Local.i)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("BuildFile_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.BuildFile.End

Program.Sub.cmdready_click.Start
F.Intrinsic.Control.SetErrorHandler("cmdready_click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sRet.Declare(String)
V.Local.sSQL.Declare(String)
v.Local.bReady.Declare(Boolean)

F.Intrinsic.Control.If(V.Global.suSer.Trim,=,"")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(v.DataTable.dtTimesheet.RowCount,>,0,"AND",v.Global.bAdminMode,=,false)
	F.Intrinsic.Control.CallSub(MessageBox, "Title", "Flag as ready?", "Message", "Do you wish to flag the displayed time as Ready for Approval?", "YesAndNo", True)

	F.Intrinsic.Control.If(V.Global.sMessageBoxReturn.Trim, =, "YES")
		F.Intrinsic.Control.CallSub(cmdsave_click)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Update GCG_6667_TIMSHT Set FLAG_READY = '1' Where UPPER(USER_ID) = '{0}' And Beg_Week = '{1}'",V.Global.sUser,V.Global.dDate.PervasiveDate,V.Local.sSQL)
F.ODBC.Connection!con.Execute(V.Local.sSQL)

F.Data.DataTable.SetValue("dtTimesheet",-1,"Flag_ready",true)

F.Intrinsic.String.Build("Records with date {0} and User {1} have been marked as Ready.",V.Global.dDate,V.Global.sUser,V.Local.sSQL)
F.Intrinsic.Control.CallSub(MessageBox, "Title", "", "Message", V.Local.sSQL, "YesAndNo", False)

GUI.FormTimesheet.cmdReady.Enabled(False)
GUI.FormTimesheet.cmdUpdate.Enabled(true)
F.Intrinsic.Control.If(V.Global.bAdminMode,=,False)
	'disable save
'	GUI.FormTimesheet.cmdSave.Enabled(False)
'	GUI.FormTimesheet.cmdAdd.Enabled(False)
'	GUI.FormTimesheet.cmdFrmTemp.Enabled(False)
	
	'disable the add button cause when they can adda a new job it some how re enables the save.
'	GUI.FormTimesheet.cmdAdd.Enabled(False)

	'rintGushee
	GUI.FormTimesheet.cmdPrint.Enabled(True)
	
	'flexgridGUI.F_Ti
'	GUI.FormTimesheet.gsgcTimesheet.Enabled(False)

F.Intrinsic.Control.Else
	GUI.FormTimesheet.cmdUnlock.Enabled(True)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdready_click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdready_click.End

Program.Sub.cmdprint_click.Start
F.Intrinsic.Control.SetErrorHandler("cmdprint_click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sSQL.Declare(String)
V.Local.iRPTID.Declare(Long)
V.Local.sParam.Declare(String)
V.Local.sVals.Declare(String)
V.Local.sRet.Declare(String)
V.Local.bExcel.Declare(Boolean)
V.Local.bFileLocked.Declare(String)
V.Local.sMsg.Declare(String)
V.Local.sFileExport.Declare(String)

F.Automation.MSExcel.CheckPresence(V.Local.bExcel)
F.Intrinsic.Control.If(V.Local.bExcel)
	F.Intrinsic.String.Build("{0}\GCG_6667_{1}_Export.xlsx",V.Caller.LocalGssTempDir,V.Caller.User,V.Local.sFileExport)
	F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
	F.Intrinsic.Control.If(V.Local.bFileLocked)
		F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
		F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
	F.Intrinsic.Control.Else
		Gui.FormTimesheet.gsgcTimesheet.Export(V.Local.sFileExport,"xlsx")
		F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("{0}\GCG_6667_{1}_Export.csv",V.Caller.LocalGssTempDir,V.Caller.User,V.Local.sFileExport)
	F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
	F.Intrinsic.Control.If(V.Local.bFileLocked)
		F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
		F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
	F.Intrinsic.Control.Else
		Gui.FormTimesheet.gsgcTimesheet.Export(V.Local.sFileExport,"xlsx")
		F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf
'V.Local.sParam.Set("START_DATE*!*BIRUNID*!*GUI_HOURS*!*BALANCE_HOURS*!*HOURS_TA")

'F.Intrinsic.UI.InvokeWaitDialog("Printing Report...")

'F.global.BI.GetIDFromName("GCG_6667_TimeSheet.rpt",V.Local.iRPTID)

'F.Intrinsic.Control.If(V.Local.iRPTID,=,-1)
'	F.Intrinsic.UI.CloseWaitDialog
'	F.Intrinsic.UI.Msgbox("GCG_6667_Timesheet.rpt not found as an active report. Please Activate within Report Maintenance")

'	F.Intrinsic.Control.ExitSub
'F.Intrinsic.Control.EndIf
'F.Intrinsic.Control.BlockEvents

'F.Global.BI.GetRunID(V.Global.iBIRUNID)
'F.Global.BI.StartLogging(V.Global.iBIRUNID,V.Local.iRptID,-1,"",V.Global.iLogID)
'F.Intrinsic.String.Build("{0}*!*{1}*!*{2}*!*{3}*!*{4}",V.Global.dDate.formatYYYYMMDD,V.Global.iBIRUNID, V.Screen.FormTimesheet!txtGUIHours.Text.Trim, V.Screen.FormTimesheet!txtHoursBalance.Text.Trim, V.Screen.FormTimesheet!txtHoursTA.Text.Trim, V.Local.sVals)

''ask user in admin mode if they want to print all ready recrods for all employees or just employee selected.
'F.Intrinsic.Control.If(V.Global.bAdminMode,=,True)
'	'Print Records for all or just selected.")
'	F.Intrinsic.UI.Msgbox("Print ready time for ALL employees?","All Employees?",4,V.Local.sRet)
'F.Intrinsic.Control.EndIf

''so we have to figure out if it's for all users or employee selected.
''we can only print the users ready time

'F.Intrinsic.Control.If(V.Local.sRet,=,6)
'	'tey want all users.
''	F.Intrinsic.String.Build("select UPPER(USER_ID) AS USER_ID,E.Employee,E.Name,GCG.Job,GCG.Suffix,GCG.Seq as SEQUENCE,JO.Description,WC,Sun_HRS,Mon_HRS,Tues_HRS,WED_HRS,THUR_HRS, FRI_HRS,SAT_HRS from GCG_6667_TIMSHT As GCG Left Join V_Employee_Mstr As E On GCG.USER_ID = E.PR_USER_ID Left Join V_Job_Operations AS JO On GCG.Job = JO.Job And GCG.Suffix = JO.Suffix and GCG.Seq = JO.SEQ Where Flag_Ready = '1' And BEG_WEEK = '{0}' ",V.Global.dDate.Pervasivedate,V.Local.sSQL)
'	F.Intrinsic.String.Build("select UPPER(USER_ID) AS USER_ID,E.Employee,E.Name,GCG.SALESORDER,GCG.WORKORDER,GCG.DEPT,' ' as NAME_CUSTOMER,WC,Sun_HRS,Mon_HRS,Tues_HRS,WED_HRS,THUR_HRS, FRI_HRS,SAT_HRS from GCG_6667_TIMSHT As GCG Left Join V_Employee_Mstr As E On GCG.USER_ID = E.PR_USER_ID Where Flag_Ready = '1' And BEG_WEEK = '{0}' ",V.Global.dDate.Pervasivedate,V.Local.sSQL)
'F.Intrinsic.Control.Else
''	F.Intrinsic.String.Build("select UPPER(USER_ID) AS USER_ID,E.Employee,E.Name,GCG.Job,GCG.Suffix,GCG.Seq as SEQUENCE,JO.Description,WC,Sun_HRS,Mon_HRS,Tues_HRS,WED_HRS,THUR_HRS, FRI_HRS,SAT_HRS from GCG_6667_TIMSHT As GCG Left Join V_Employee_Mstr As E On GCG.USER_ID = E.PR_USER_ID Left Join V_Job_Operations AS JO On GCG.Job = JO.Job And GCG.Suffix = JO.Suffix and GCG.Seq = JO.SEQ Where GCG.USER_ID ='{0}' And BEG_WEEK = '{1}' ",V.Global.sUser,V.Global.dDate.Pervasivedate,V.Local.sSQL)
'	F.Intrinsic.String.Build("select UPPER(USER_ID) AS USER_ID,E.Employee,E.Name,GCG.SALESORDER,GCG.WORKORDER,GCG.DEPT,' ' as NAME_CUSTOMER,WC,Sun_HRS,Mon_HRS,Tues_HRS,WED_HRS,THUR_HRS, FRI_HRS,SAT_HRS from GCG_6667_TIMSHT As GCG Left Join V_Employee_Mstr As E On GCG.USER_ID = E.PR_USER_ID Where GCG.USER_ID ='{0}' And BEG_WEEK = '{1}' ",V.Global.sUser,V.Global.dDate.Pervasivedate,V.Local.sSQL)
'F.Intrinsic.Control.EndIf

'F.Data.DataTable.CreateFromSQL("DTGetData","con",v.Local.sSQL)
'F.Intrinsic.Control.if(v.DataTable.DTGetData.RowCount,=,0)
'	F.Intrinsic.UI.Msgbox("There are no records made ready for printing.")
'	F.Data.DataTable.Close("DTGetData")
'	F.Intrinsic.Control.UnBlockEvents
'	F.Intrinsic.UI.CloseWaitDialog
'	F.Intrinsic.Control.ExitSub
'F.Intrinsic.Control.Else
'	F.Intrinsic.String.Build("Select * from GCG_6667_TIMESHT_BI where BIRUNID = '{0}'",V.Global.iBIRUNID,v.Local.sSQL)
'	F.data.DataTable.CreateFromSQL("DTBiUpload","con",v.Local.sSQL)
'	F.Data.DataTable.RemoveColumn("DTGetData","USER_ID")
'	F.Data.DataTable.AddColumn("DTGetData","BIRUNID","Long")
'	F.Data.DataTable.SetValue("DTGetData",-1,"BIRUNID",V.Global.iBIRUNID)
'	F.Data.datatable.Merge("DTGetData","DTBiUpload",false,2)
'	F.Data.DataTable.Close("DTGetData")

'	F.Intrinsic.Control.If(V.DataTable.DTBiUpload.RowCount,>,0)
'		F.ODBC.Connection!con.Execute("Delete From GCG_6667_TIMESHT_BI")
'		F.Data.DataTable.FillFromDictionary("DTBiUpload","CustName","SALESORDER","NAME_CUSTOMER")
'		F.Data.DataTable.SaveToDB("DTBiUpload","con","GCG_6667_TIMESHT_BI","",128)
'		F.Data.DataTable.Close("DTBiUpload")
'	
'		F.Global.BI.RunReportPreProcessor(V.Global.iBIRUNID,V.Global.iLogID,V.Local.sParam,V.Local.sVals,"",-1,False,"",-1,"",-1,"","",V.Global.iBIRUNID)

'	F.Intrinsic.Control.EndIf

'F.Intrinsic.Control.endif

'F.Intrinsic.UI.CloseWaitDialog

'F.Intrinsic.Control.UnBlockEvents

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdprint_click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdprint_click.End

Program.Sub.Admin_Mode.Start
F.Intrinsic.Control.SetErrorHandler("Admin_Mode_Err")
F.Intrinsic.Control.ClearErrors

v.Local.iRet.Declare

'Are we Admin or not?
'We are looking for Group PYRLADMN
F.Intrinsic.Control.If(v.Global.sUser.Trim,=,"")
	v.Global.sUser.Set(v.Caller.User)
	F.Intrinsic.String.Format(V.Global.sUser,">",V.Global.sUser)
F.Intrinsic.Control.EndIf

F.Global.Security.IsInGroup(v.Global.sUser,"PYRLADMN",V.Caller.CompanyCode,V.Global.bAdminMode)

F.Intrinsic.Control.If(V.Global.bAdminMode)
	F.Intrinsic.UI.Msgbox("Your User ID has been flagged as an Admin for this Dashboard. Do you want to continue as an Admin or Launch the dashboard as a user to update your personal time sheet? Click 'Yes' to Launch as Admin or 'No' to Launch as a User.","Launch in Admin Mode?",4,v.Local.iRet)
	F.Intrinsic.Control.If(v.Local.iRet,=,7)
		v.Global.bAdminMode.Set(False)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

'If we admin we have to Remove the Template buton and shiFt the ready and print buttons
F.Intrinsic.Control.If(V.Global.bAdminMode)
	GUI.FormTimesheet.cmdTemp.Visible(True)
	GUI.FormTimesheet.chkAllEmployees.Position(8190,9795)
	GUI.FormTimesheet.cmdTemp.Position(6990,9720)
	GUI.FormTimesheet.cmdUpdate.Position(2990,9720)
	GUI.FormTimesheet.cmdUnlock.Position(4980,9720)
 	GUI.FormTimesheet.cmdPrint.Position(5990,9720)
 	GUI.FormTimesheet.cmdReady.position(1095,9720)
	'unhide the employee search options and the unlock button
	GUI.FormTimesheet.lblEmp.Visible(True)
	GUI.FormTimesheet.txtEmployee.Visible(True)
	GUI.FormTimesheet.txtEmployee.Enabled(True)
	GUI.FormTimesheet.cmdEmpBrws.Visible(True)
	GUI.FormTimesheet.cmdEmpBrws.Enabled(True)
	GUI.FormTimesheet.cmdEmpSearch.Visible(True)
	GUI.FormTimesheet.cmdEmpSearch.Enabled(True)
	GUI.FormTimesheet.cmdUnlock.Visible(True)
	GUI.FormTimesheet.cmdPrint.Enabled(True)
	GUI.FormTimesheet.lblUser.Visible(True)
	GUI.FormTimesheet.txtUser.Visible(True)
	GUI.FormTimesheet.txtUser.Enabled(True)
'	GUI.FormTimesheet.chkAllEmployees.Visible(True)
	'not making this visible but leaving in code incase customer changes their mind about being able to update all employess
	GUI.FormTimesheet.chkAllEmployees.Visible(False)
	'V.Global.sUser.Set(v.Screen.FormTimesheet!txtUser.text)
	GUI.FormTimesheet..Caption("Timesheet Entry (Admin Mode)")
F.Intrinsic.Control.Else
	'if we aint admins, we need to remove the update button and shift temp ready and print buttons
	GUI.FormTimesheet.cmdUpdate.Visible(False)
	GUI.FormTimesheet.cmdUpdate.Position(5080,9720)
	GUI.FormTimesheet.cmdTemp.Position(1100,9720)
	GUI.FormTimesheet.cmdReady.Position(2200,9720)
	GUI.FormTimesheet.cmdPrint.Position(4050,9720)
F.Intrinsic.Control.EndIf

GUI.FormTimesheet.txtUser.Text(v.Global.sUser)
F.Intrinsic.Control.CallSub(txtUser_LostFocus)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Admin_Mode_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.Admin_Mode.End

Program.Sub.cmdempbrws_click.Start
F.Intrinsic.Control.SetErrorHandler("cmdempbrws_click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sTitle.Declare(String)
V.Local.iWidth.Declare(Long)
V.Local.sRet.Declare(String)

F.Intrinsic.String.Split("Employee*!*Name*!*GS User ID","*!*",V.Local.sTitle)
F.Intrinsic.String.Split("3500*!*3500*!*0","*!*",V.Local.iWidth)
F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
F.Intrinsic.UI.Browser("Select an Employee","con","Select Employee,Name,PR_USER_ID FROM V_EMPLOYEE_MSTR",V.Local.sTitle,V.Local.iWidth,V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"***CANCEL***")
	
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	F.Intrinsic.Control.If(V.Local.sRet(0).Trim,<>,V.Screen.FormTimesheet!txtEmployee.Text)
		
		GUI.FormTimesheet.txtEmployee.Text(V.Local.sRet(0).Trim)
		V.Global.sUser.Set(V.Local.sRet(2).Trim)
		F.Intrinsic.String.Format(V.Global.sUser,">",V.Global.sUser)
		GUI.FormTimesheet.txtUser.Text(V.Global.sUser.Trim)
		F.Intrinsic.Control.If(V.Global.sUser.Trim,=,"")
	'		Askthemfortheuser.
			F.Intrinsic.UI.Browser(10,"",V.Local.sRet)
			F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"***CANCEL***")
				F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
				V.Global.sUser.Set(V.Local.sret(1).Trim)
				F.Intrinsic.String.Format(V.Global.sUser,">",V.Global.sUser)
				GUI.FormTimesheet.txtUser.Text(V.Global.sUser.Trim)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdempbrws_click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdempbrws_click.End

Program.Sub.cmdempsearch_click.Start
F.Intrinsic.Control.SetErrorHandler("cmdempsearch_click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sSQL.Declare(String)
V.Local.sUser.Declare(String)
V.Local.sRet.Declare(String)
V.Local.sEmployee.Declare(String)

'F.Intrinsic.Control.If(V.Screen.FormTimesheet!txtEmployee.Text,=,"")
'	F.Intrinsic.Control.ExitSub
'F.Intrinsic.Control.EndIf

F.Intrinsic.Control.BlockEvents

F.Intrinsic.Control.CallSub(EmptyTotals)
F.Intrinsic.Control.CallSub(Gridload)
F.Intrinsic.Control.CallSub(GridTitle)
F.Intrinsic.Control.CallSub(ComputeTotals)

F.Intrinsic.Control.UnBlockEvents

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdempsearch_click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdempsearch_click.End

Program.Sub.cmdunlock_click.Start
F.Intrinsic.Control.SetErrorHandler("cmdunlock_click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sSQL.Declare(String)
v.Local.iCount.Declare(Long)
V.Local.bSave.Declare(Boolean)

F.Intrinsic.Control.If(V.Global.suSer.Trim,=,"")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

'F.Intrinsic.String.Build("Select Count(UPDATED) from GCG_6667_TIMSHT Where UPPER(USER_ID) = '{0}' And Beg_Week = '{1}' and UPDATED = 1",V.Global.sUser,V.Global.dDate.PervasiveDate,V.Local.sSQL)
'F.ODBC.Connection!con.executeandreturn(v.Local.sSQL,v.Local.iCount)
'F.Intrinsic.Control.If(v.Local.iCount,>,0)
'	F.Intrinsic.Control.CallSub(MessageBox, "Title", "", "Message", "Records have already been posted to GSS and cannot be unlocked.", "YesAndNo", False)
'	F.Intrinsic.Control.ExitSub
'F.Intrinsic.Control.EndIf

'F.Intrinsic.String.Build("Update GCG_6667_TIMSHT Set FLAG_READY = '0' Where UPPER(USER_ID) = '{0}' And Beg_Week = '{1}'",V.Global.sUser,V.Global.dDate.PervasiveDate,V.Local.sSQL)
'F.ODBC.Connection!con.Execute(V.Local.sSQL)

'F.Intrinsic.UI.Msgbox("Records have been Unlocked...")

F.Intrinsic.Control.For(V.Local.iCount,0,V.DataTable.dtTimesheet.RowCount--,1)
	F.Intrinsic.Control.If(V.DataTable.dtTimesheet(V.Local.iCount).Flag_Ready!FieldVal,=,True,"AND",V.DataTable.dtTimesheet(V.Local.iCount).Updated!FieldVal,=,False)
		F.Data.DataTable.SetValue("dtTimesheet",V.Local.iCount,"Flag_ready",False)
		V.Local.bSave.Set(True)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Next(V.Local.iCount)

F.Intrinsic.Control.If(V.Local.bSave)
	F.Intrinsic.Control.If(V.Global.bSaveMsg)
		V.Global.bSaveMsg.Set(False)
		F.Intrinsic.Control.CallSub(cmdsave_click)
		V.Global.bSaveMsg.Set(True)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(cmdsave_click)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.CallSub(cmdRefresh_Click)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdunlock_click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdunlock_click.End

Program.Sub.gsgcTimesheet_RowCellClick.Start
F.Intrinsic.Control.SetErrorHandler("gsgcTimesheet_RowCellClick_Err")
F.Intrinsic.Control.ClearErrors

v.Local.ssql.Declare(string)
v.Local.sParam.Declare(string)
v.Local.sJob.Declare(string)
v.Local.sSuffix.Declare(string)
V.Local.iRet.Declare(Long)

F.Intrinsic.Control.If(v.Args.Column,=,"Delete")
	F.Intrinsic.Control.If(V.DataTable.dtTimesheet(V.Args.RowIndex).Updated!FieldVal,=,False,"AND",V.DataTable.dtTimesheet(V.Args.RowIndex).Flag_Ready!FieldVal,=,False)
		F.Intrinsic.UI.Msgbox("Are you sure you want to delete this record?","Delete Record",4,V.Local.iRet)
		F.Intrinsic.Control.If(V.Local.iRet,=,6)
			F.Intrinsic.String.Build("DELETE from GCG_6667_TIMSHT where UPPER(USER_ID) = '{0}' AND SALESORDER = '{1}' AND WORKORDER = '{2}' AND DEPT = '{3}' AND BEG_WEEK = '{4}'",V.Global.sUser,v.DataTable.dtTimesheet(v.Args.RowIndex).SALESORDER!FieldVal,v.DataTable.dtTimesheet(v.Args.RowIndex).WORKORDER!FieldVal,v.DataTable.dtTimesheet(v.Args.RowIndex).DEPT!FieldVal,V.Global.dDate.PervasiveDate,V.Local.sSql)	
			F.odbc.Connection!con.execute(v.Local.ssql)
			F.data.DataTable.DeleteRow("dtTimesheet",v.Args.RowIndex)	
			F.Intrinsic.Control.CallSub(ComputeTotals)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.ElseIf(V.DataTable.dtTimesheet(V.Args.RowIndex).Updated!FieldVal,=,False,"AND",V.DataTable.dtTimesheet(V.Args.RowIndex).Flag_Ready!FieldVal,=,True)
		F.Intrinsic.Control.If(V.Global.bAdminMode)
			F.Intrinsic.UI.Msgbox("Are you sure you want to delete this record?","Delete Record",4,V.Local.iRet)
			F.Intrinsic.Control.If(V.Local.iRet,=,6)
				F.Intrinsic.String.Build("DELETE from GCG_6667_TIMSHT where UPPER(USER_ID) = '{0}' AND SALESORDER = '{1}' AND WORKORDER = '{2}' AND DEPT = '{3}' AND BEG_WEEK = '{4}'",V.Global.sUser,v.DataTable.dtTimesheet(v.Args.RowIndex).SALESORDER!FieldVal,v.DataTable.dtTimesheet(v.Args.RowIndex).WORKORDER!FieldVal,v.DataTable.dtTimesheet(v.Args.RowIndex).DEPT!FieldVal,V.Global.dDate.PervasiveDate,V.Local.sSql)	
				F.odbc.Connection!con.execute(v.Local.ssql)
				F.data.DataTable.DeleteRow("dtTimesheet",v.Args.RowIndex)	
				F.Intrinsic.Control.CallSub(ComputeTotals)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Else
			F.Intrinsic.UI.Msgbox("Record has already been submitted for Approval. Contact Supervisor","Attention")
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Else
		F.Intrinsic.UI.Msgbox("Record has already been Posted To GSS. Contact Supervisor","Attention")
	F.Intrinsic.Control.EndIf
'F.Intrinsic.Control.ElseIf(v.Args.Column.UCase,=,"JOB","OR",v.Args.Column.UCase,=,"SUFFIX",v.Args.Column.UCase,=,"SEQ", v.Args.Column.UCase,=,"JSS")
F.Intrinsic.Control.ElseIf(v.Args.Column.UCase,=,"WORKORDER")
'	v.Local.sJob.Set(v.DataTable.dtTimesheet(v.Args.RowIndex).JOB!FieldVal)
'	v.Local.sSuffix.Set(v.DataTable.dtTimesheet(v.Args.RowIndex).SUFFIX!FieldVal)
	F.Intrinsic.String.Split(v.DataTable.dtTimesheet(v.Args.RowIndex).WORKORDER!FieldVal,"-",V.Local.sJob)
	F.Intrinsic.Control.If(v.Local.sJob.UBound,>,0)
		V.Local.sSuffix.Set(v.Local.sJob(1).Trim)
	F.Intrinsic.Control.EndIf
	GUI.FormTimesheet..Enabled(False)
	F.Intrinsic.String.RPad(v.Local.sJob," ",6,v.Local.sJob)
	F.Intrinsic.String.RPad(v.Local.sSuffix," ",3,v.Local.sSuffix)

	F.Intrinsic.String.Build("7!*!{0}!*!{1}!*!A",v.Local.sJob,v.Local.sSuffix,v.Local.sParam)

	F.Global.General.CallWrapperSync(450000,v.Local.sParam)
	GUI.FormTimesheet..SetFocus
	GUI.FormTimesheet..Enabled(True)
F.Intrinsic.Control.ElseIf(v.Args.Column.UCase,=,"FLAG_READY")
	F.Intrinsic.Control.If(V.Global.bAdminMode)
		F.Intrinsic.Control.If(V.DataTable.dtTimesheet(V.Args.RowIndex).Updated!FieldVal,=,False)
			V.Global.bSaveMsg.Set(True)
			F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,"Flag_Ready",V.DataTable.dtTimesheet(V.Args.RowIndex).Flag_Ready!FieldValNot)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("gsgcTimesheet_RowCellClick_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.gsgcTimesheet_RowCellClick.End

Program.Sub.txtEmployee_Change.Start
F.Intrinsic.Control.SetErrorHandler("txtEmployee_Change_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sEmployee.Declare(string)
V.Local.iCheck.Declare(Long)
v.Local.sSql.Declare(String)
v.Local.sRet.Declare(String)
v.Local.sRet1.Declare(String)
V.Local.sEmployee.set(V.Screen.FormTimesheet!txtEmployee.Text)

F.Intrinsic.Control.If(v.Local.sEmployee.trim,=,"")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Select Employee,PR_USER_ID FROM V_EMPLOYEE_MSTR where employee = '{0}'",v.Local.sEmployee,v.Local.sSql)
F.odbc.Connection!con.ExecuteAndReturn(v.Local.sSql,v.Local.sRet)
F.Intrinsic.Control.BlockEvents
F.Intrinsic.Control.If(v.Local.sRet.Trim,=,"")
	F.Intrinsic.UI.Msgbox("The employee ID does not exist in the database.")
	GUI.FormTimesheet.txtUser.Text("")
	GUI.FormTimesheet.txtEmployee.Text("")
	F.Intrinsic.Control.UnBlockEvents
	GUI.FormTimesheet.txtEmployee.SetFocus
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Split(v.Local.sRet,"*!*",v.Local.sRet)

V.Global.sUser.Set(V.Local.sRet(1).Trim)
F.Intrinsic.String.Format(V.Global.sUser,">",V.Global.sUser)
GUI.FormTimesheet.txtUser.Text(V.Global.sUser.Trim)
F.Intrinsic.Control.If(V.Global.sUser.Trim,=,"")
'		Askthemfortheuser.
	F.Intrinsic.UI.Browser(10,"",V.Local.sRet1)
	F.Intrinsic.Control.If(V.Local.sRet1.Trim,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet1,"*!*",V.Local.sRet1)
		V.Global.sUser.Set(V.Local.sRet1(1).Trim)
		F.Intrinsic.String.Format(V.Global.sUser,">",V.Global.sUser)
		GUI.FormTimesheet.txtUser.Text(V.Global.sUser.Trim)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf
GUI.FormTimesheet.txtUser.SetFocus
F.Intrinsic.Control.UnBlockEvents

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtEmployee_Change_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.txtEmployee_Change.End

Program.Sub.gsgcTimesheet_CellValueChanged.Start
F.Intrinsic.Control.SetErrorHandler("gsgcTimesheet_CellValueChanged_Err")
F.Intrinsic.Control.ClearErrors

V.Local.bInString.Declare(Boolean)
V.Local.fHours.Declare(Float)
V.Local.fMinutes.Declare(Float)
V.Local.sTime.Declare(String)
V.Local.sSplit.Declare(String)
V.Local.sWriteColumn.Declare(String)
V.Local.fFullDecimal.Declare(Float)
V.Local.sHours.Declare(String)
V.Local.sMinutes.Declare(String)
V.Local.sName.Declare(String)
V.Local.bUpdate.Declare(Boolean)
V.Local.bCont.Declare(Boolean,True)

'get which column to modify
F.Data.Dictionary.Create("dictColumns")
F.Data.Dictionary.AddItem("dictColumns", "SUNDAY_HOURS_EDIT", "SUN_HRS")
F.Data.Dictionary.AddItem("dictColumns", "MONDAY_HOURS_EDIT", "MON_HRS")
F.Data.Dictionary.AddItem("dictColumns", "TUESDAY_HOURS_EDIT", "TUES_HRS")
F.Data.Dictionary.AddItem("dictColumns", "WEDNESDAY_HOURS_EDIT", "WED_HRS")
F.Data.Dictionary.AddItem("dictColumns", "THURSDAY_HOURS_EDIT", "THUR_HRS")
F.Data.Dictionary.AddItem("dictColumns", "FRIDAY_HOURS_EDIT", "FRI_HRS")
F.Data.Dictionary.AddItem("dictColumns", "SATURDAY_HOURS_EDIT", "SAT_HRS")
F.Data.Dictionary.AddItem("dictColumns", "SUN_HRS", "SUNDAY_HOURS_EDIT")
F.Data.Dictionary.AddItem("dictColumns", "MON_HRS", "MONDAY_HOURS_EDIT")
F.Data.Dictionary.AddItem("dictColumns", "TUES_HRS", "TUESDAY_HOURS_EDIT")
F.Data.Dictionary.AddItem("dictColumns", "WED_HRS", "WEDNESDAY_HOURS_EDIT")
F.Data.Dictionary.AddItem("dictColumns", "THUR_HRS", "THURSDAY_HOURS_EDIT")
F.Data.Dictionary.AddItem("dictColumns", "FRI_HRS", "FRIDAY_HOURS_EDIT")
F.Data.Dictionary.AddItem("dictColumns", "SAT_HRS", "SATURDAY_HOURS_EDIT")
F.Data.Dictionary.SetDefaultReturn("dictColumns", "")

V.Local.sWriteColumn.Set(V.Dictionary.dictColumns![V.Args.Column.Trim])
F.Data.Dictionary.Close("dictColumns")

'check if decimal or time column
F.Intrinsic.String.IsInString(V.Args.Column, "HOURS_EDIT", True, V.Local.bInString)

F.Intrinsic.Control.BlockEvents
F.Intrinsic.Control.If(V.Local.bInString)

	F.Intrinsic.Control.If(V.Global.bAdminMode)
		F.Intrinsic.Control.If(V.DataTable.dtTimesheet(V.Args.RowIndex).Updated!FieldVal,=,True)
			F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,V.Args.Column,V.DataTable.dtTimesheet(V.Args.RowIndex).[V.Local.sWriteColumn]!FieldVal)
			V.Local.bCont.Set(False)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.If(V.DataTable.dtTimesheet(V.Args.RowIndex).Flag_Ready!FieldVal,=,True)
			F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,V.Args.Column,V.DataTable.dtTimesheet(V.Args.RowIndex).[V.Local.sWriteColumn]!FieldVal)
			V.Local.bCont.Set(False)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.Local.bCont)
		'time column, update decimal column
		F.Intrinsic.Control.If(V.DataTable.dtTimesheet(V.Args.RowIndex).[V.Args.Column]!FieldValTrim, =, "")
			F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, V.Args.Column, "00:00")
		F.Intrinsic.Control.EndIf
		
		F.Intrinsic.Math.Div(V.Args.Value,.25,V.Local.fHours)
		F.Intrinsic.String.Split(V.Local.fHours.String,".",V.Local.sHours)
		
		F.Intrinsic.Control.If(V.Local.fHours,>,V.Local.sHours.Long)
			V.Local.bUpdate.Set(False)
		F.Intrinsic.Control.Else
			V.Local.bUpdate.Set(True)
		F.Intrinsic.Control.EndIf
		
		F.Intrinsic.Control.If(V.Local.bUpdate)
	'		F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).[V.Args.Column]!FieldValTrim)
			'F.Intrinsic.Math.Round(V.Args.Decimal, 4, V.Local.fFullDecimal)
			F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, V.Local.sWriteColumn, v.Args.Value)
	'		F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, V.Local.sWriteColumn, V.Args.Decimal)
		F.Intrinsic.Control.Else
			F.Intrinsic.UI.Msgbox("Time Data Must in increments of .25","Attention")
			F.Data.DataTable.SetValue("dtTimesheet",V.Args.RowIndex,V.Args.Column,V.DataTable.dtTimesheet(V.Args.RowIndex).[V.Local.sWriteColumn]!FieldVal)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Else
	'decimal column, update time column
'	F.Intrinsic.Control.CallSub(CalculateTimeColumn, "ROW", V.Args.RowIndex, "COLUMN", V.Args.Column, "TARGET_COLUMN", V.Local.sWriteColumn)
F.Intrinsic.Control.EndIf

'check job total column
F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)

F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)
F.Intrinsic.Control.UnBlockEvents

v.Global.bSaveMsg.Set(true)
F.Intrinsic.Control.CallSub(ComputeTotals)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("gsgcTimesheet_CellValueChanged_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.gsgcTimesheet_CellValueChanged.End

Program.Sub.ConvertTimeToDecimal.Start
F.Intrinsic.Control.SetErrorHandler("ConvertTimeToDecimal_Err")
F.Intrinsic.Control.ClearErrors

V.Local.fHours.Declare(Float)
V.Local.fMinutes.Declare(Float)
V.Local.sSplit.Declare(String)
V.Local.fFullDecimal.Declare(Float)
V.Local.sHours.Declare(String)
V.Local.sMinutes.Declare(String)
V.Local.sNegative.Declare(String, "")
V.Local.sTime.Declare(String)

V.Local.sTime.Set(V.Args.Time)
F.Intrinsic.Control.If(V.Local.sTime.Left1, =, "-")
	V.Local.sNegative.Set("-")
	F.Intrinsic.String.Replace(V.Local.sTime, "-", "", V.Local.sTime)
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Split(V.Local.sTime, ":", V.Local.sSplit)
V.Local.fHours.Set(V.Local.sSplit(0).Float)
V.Local.fMinutes.Set(V.Local.sSplit(1).Float)

F.Intrinsic.Math.Div(V.Local.fMinutes, 60, V.Local.fMinutes)
F.Intrinsic.String.Format(V.Local.fHours, "0", V.Local.sHours)
F.Intrinsic.Math.Add(V.Local.fHours, V.Local.fMinutes, V.Local.fFullDecimal)

F.Intrinsic.Math.Round(V.Local.fFullDecimal, 4, V.Local.fFullDecimal)
F.Intrinsic.Variable.AddRV("DECIMAL", V.Local.fFullDecimal)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("ConvertTimeToDecimal_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.ConvertTimeToDecimal.End

Program.Sub.CalculateTimeColumn.Start
F.Intrinsic.Control.SetErrorHandler("CalculateTimeColumn_Err")
F.Intrinsic.Control.ClearErrors

F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.DataTable.dtTimesheet(V.Args.ROW).[V.Args.COLUMN]!FieldValFloat)
F.Data.DataTable.SetValue("dtTimesheet", V.Args.ROW, V.Args.TARGET_COLUMN, V.Args.Time)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("CalculateTimeColumn_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.CalculateTimeColumn.End

Program.Sub.ConvertDecimalToTime.Start
F.Intrinsic.Control.SetErrorHandler("ConvertDecimalToTime_Err")
F.Intrinsic.Control.ClearErrors

V.Local.fHours.Declare(Float)
V.Local.fMinutes.Declare(Float)
V.Local.sMinutes.Declare(String)
V.Local.sHours.Declare(String)
V.Local.sTime.Declare(String)
V.Local.sNegative.Declare(String, "")

F.Intrinsic.Control.If(V.Args.Decimal, <, 0)
	V.Local.sNegative.Set("-")
F.Intrinsic.Control.EndIf

F.Intrinsic.Math.Mult(V.Args.Decimal, 60, V.Local.fMinutes)
F.Intrinsic.Math.IDiv(V.Local.fMinutes, 60, V.Local.fHours)
F.Intrinsic.Math.Mod(V.Local.fMinutes, 60, V.Local.fMinutes)
F.Intrinsic.Math.Abs(V.Local.fMinutes, V.Local.fMinutes)
F.Intrinsic.Math.Abs(V.Local.fHours, V.Local.fHours)
F.Intrinsic.String.Format(V.Local.fHours, "0", V.Local.sHours)
F.Intrinsic.Math.Round(V.Local.fMinutes, 0, V.Local.fMinutes)
F.Intrinsic.Control.If(V.Local.fMinutes, >, 59)
	F.Intrinsic.Math.Add(V.Local.fHours, 1, V.Local.fHours)
	V.Local.fMinutes.Set("0")
F.Intrinsic.Control.EndIf
F.Intrinsic.String.Format(V.Local.fMinutes, "00", V.Local.sMinutes)
F.Intrinsic.String.Build("{2}{0}:{1}", V.Local.sHours, V.Local.sMinutes, V.Local.sNegative, V.Local.sTime)

F.Intrinsic.Control.If(V.Local.sTime, =, "-0:00")
	F.Intrinsic.String.Replace(V.Local.sTime, "-", "", V.Local.sTime)
F.Intrinsic.Control.EndIf

F.Intrinsic.Variable.AddRV("TIME", V.Local.sTime)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("ConvertDecimalToTime_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.ConvertDecimalToTime.End

Program.Sub.CalculateAllTimeColumns.Start
F.Intrinsic.Control.SetErrorHandler("CalculateAllTimeColumns_Err")
F.Intrinsic.Control.ClearErrors

V.Local.iCounter.Declare(Long)
V.Local.iJ.Declare(Long)
V.Local.sColumns.Declare(String, "SUN_HRS@!@SUNDAY_HOURS_EDIT*!*MON_HRS@!@MONDAY_HOURS_EDIT*!*TUES_HRS@!@TUESDAY_HOURS_EDIT*!*WED_HRS@!@WEDNESDAY_HOURS_EDIT*!*THUR_HRS@!@THURSDAY_HOURS_EDIT*!*FRI_HRS@!@FRIDAY_HOURS_EDIT*!*SAT_HRS@!@SATURDAY_HOURS_EDIT*!*JOB_SUM@!@JOB_TOTAL_TIME")
V.Local.sSplit.Declare(String)

F.Intrinsic.String.Split(V.Local.sColumns, "*!*", V.Local.sColumns)
F.Intrinsic.Control.For(V.Local.iCounter, 0, V.Local.sColumns.UBound, 1)
	F.Intrinsic.String.Split(V.Local.sColumns(V.Local.iCounter), "@!@", V.Local.sSplit)
	F.Intrinsic.Control.For(V.Local.iJ, 0, V.DataTable.dtTimesheet.RowCount--, 1)
		F.Intrinsic.Control.If(V.Local.sSplit,=,"JOB_SUM")
			F.Intrinsic.Control.CallSub(CalculateTimeColumn, "ROW", V.Local.iJ, "COLUMN", V.Local.sSplit(0), "TARGET_COLUMN", V.Local.sSplit(1))
		F.Intrinsic.Control.Else
			F.Data.DataTable.SetValue("dtTimesheet",V.Local.iJ,V.Local.sSplit(1),V.DataTable.dtTimesheet(V.Local.iJ).[V.Local.sSplit]!FieldVal)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iJ)
F.Intrinsic.Control.Next(V.Local.iCounter)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("CalculateAllTimeColumns_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.CalculateAllTimeColumns.End

Program.Sub.cmdFrmTemp_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdFrmTemp_Click_Err")
F.Intrinsic.Control.ClearErrors

v.local.sSQL.Declare(string)
v.local.sMap.Declare(string)

F.Intrinsic.Control.If(v.Global.bAdminMode)
	V.Global.sUser.Set(v.Screen.FormTimesheet!txtUser.text)
F.Intrinsic.Control.EndIf
F.Intrinsic.Control.If(V.Global.sUser.Trim,=,"")
	F.Intrinsic.UI.Msgbox("No Employee Selected!","Select Employee")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

'F.Intrinsic.String.Build("Select JOB, SUFFIX, SEQ,JOB + SUFFIX + SEQ AS JSS,JOB + SUFFIX AS JS,RTRIM(' ') as DESCRIPTION,RTRIM(WC) as WC,  CAST(0 AS DOUBLE) AS MON_HRS,CAST(' ' as LONGVARCHAR) as MON_NOTES, CAST(0 AS DOUBLE) AS TUES_HRS,CAST(' ' as LONGVARCHAR)  as TUES_NOTES, CAST(0 AS DOUBLE) AS WED_HRS,CAST(' ' as LONGVARCHAR)  as WED_NOTES, CAST(0 AS DOUBLE) AS THUR_HRS,CAST(' ' as LONGVARCHAR)  as THUR_NOTES, CAST(0 AS DOUBLE) AS FRI_HRS,CAST(' ' as LONGVARCHAR)  as FRI_NOTES, CAST(0 AS DOUBLE) AS SAT_HRS,CAST(' ' as LONGVARCHAR)  as SAT_NOTES,CAST(0 AS DOUBLE) AS SUN_HRS,CAST(' ' as LONGVARCHAR) as SUN_NOTES,CAST(0 AS BIT) AS UPDATED,CAST(0 AS BIT) AS FLAG_READY,CAST('      ' as VARCHAR) as SUN_NOTES from GCG_6667_TIMSHT_TEMP where UPPER(USER_ID) = '{0}' and JSS not in (Select job + suffix + seq as JSS from GCG_6667_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}') ORDER BY JOB,SUFFIX, SEQ",V.Global.sUser,v.Global.dDate.PervasiveDate,V.Local.sSql)
F.Intrinsic.String.Build("Select SALESORDER, WORKORDER, DEPT ,RTRIM(' ') as NAME_CUSTOMER,RTRIM(WC) as WC,  CAST(0 AS DOUBLE) AS MON_HRS,CAST(' ' as LONGVARCHAR) as MON_NOTES, CAST(0 AS DOUBLE) AS TUES_HRS,CAST(' ' as LONGVARCHAR)  as TUES_NOTES, CAST(0 AS DOUBLE) AS WED_HRS,CAST(' ' as LONGVARCHAR)  as WED_NOTES, CAST(0 AS DOUBLE) AS THUR_HRS,CAST(' ' as LONGVARCHAR)  as THUR_NOTES, CAST(0 AS DOUBLE) AS FRI_HRS,CAST(' ' as LONGVARCHAR)  as FRI_NOTES, CAST(0 AS DOUBLE) AS SAT_HRS,CAST(' ' as LONGVARCHAR)  as SAT_NOTES,CAST(0 AS DOUBLE) AS SUN_HRS,CAST(' ' as LONGVARCHAR) as SUN_NOTES,CAST(0 AS BIT) AS UPDATED,CAST(0 AS BIT) AS FLAG_READY,CAST('      ' as VARCHAR) as SUN_NOTES from GCG_6667_TIMSHT_TEMP where UPPER(USER_ID) = '{0}' and SALESORDER+WORKORDER+DEPT+WC not in (Select SALESORDER+WORKORDER+DEPT+WC from GCG_6667_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}') ORDER BY SALESORDER,WORKORDER,DEPT,WC",V.Global.sUser,v.Global.dDate.PervasiveDate,V.Local.sSql)

F.Data.DataTable.CreateFromSQL("TimeDT","con",V.Local.sSql,true)
F.Intrinsic.Control.If(v.DataTable.TimeDT.RowCount,=,0)
	F.Intrinsic.ui.Msgbox("There are no Reocords that can be added in from the template.")
	F.Data.DataTable.Close("TimeDT")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf
F.Data.DataTable.AddColumn("TimeDT","USER_ID","STRING")
F.Data.DataTable.SetValue("TimeDT",-1,"USER_ID",V.Global.sUser)

F.Data.DataTable.AddColumn("TimeDT","BEG_WEEK","STRING")
F.Data.DataTable.SetValue("TimeDT",-1,"BEG_WEEK",V.Global.dDate.PervasiveDate)
'v.Local.sMap.set("USER_ID@!@USER_ID*!*JOB@!@JOB*!*SUFFIX@!@SUFFIX*!*SEQ@!@SEQ*!*BEG_WEEK@!@BEG_WEEK*!*WC@!@WC*!*SUN_HRS@!@SUN_HRS*!*MON_HRS@!@MON_HRS*!*TUES_HRS@!@TUES_HRS*!*WED_HRS@!@WED_HRS*!*THUR_HRS@!@THUR_HRS*!*FRI_HRS@!@FRI_HRS*!*SAT_HRS@!@SAT_HRS*!*UPDATED@!@UPDATED*!*FLAG_READY@!@FLAG_READY")
v.Local.sMap.set("USER_ID@!@USER_ID*!*SALESORDER@!@SALESORDER*!*WORKORDER@!@WORKORDER*!*DEPT@!@DEPT*!*BEG_WEEK@!@BEG_WEEK*!*WC@!@WC*!*SUN_HRS@!@SUN_HRS*!*MON_HRS@!@MON_HRS*!*TUES_HRS@!@TUES_HRS*!*WED_HRS@!@WED_HRS*!*THUR_HRS@!@THUR_HRS*!*FRI_HRS@!@FRI_HRS*!*SAT_HRS@!@SAT_HRS*!*UPDATED@!@UPDATED*!*FLAG_READY@!@FLAG_READY")
'Function.Data.DataTable.SaveToDB("TimeDT","con","GCG_6667_TIMSHT","USER_ID*!*JOB*!*SUFFIX*!*SEQ*!*BEG_WEEK",256,v.Local.sMap)
Function.Data.DataTable.SaveToDB("TimeDT","con","GCG_6667_TIMSHT","USER_ID*!*SALESORDER*!*WORKORDER*!*DEPT*!*WC*!*BEG_WEEK",256,v.Local.sMap)

F.Data.DataTable.Close("TimeDT")

F.Intrinsic.Control.CallSub(GridLoad)
F.Intrinsic.Control.CallSub(GridTitle)
F.Intrinsic.Control.CallSub(ComputeTotals)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdFrmTemp_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdFrmTemp_Click.End

Program.Sub.MessageBox.Start
'they wanted blue text on the message boxes
'so I had to make a seperate form for it
F.Intrinsic.Control.SetErrorHandler("MessageBox_Err")
F.Intrinsic.Control.ClearErrors

V.Local.bYesAndNo.Declare(Boolean)
V.Local.sTitle.Declare(String)
V.Local.sMessage.Declare(String)

V.Local.bYesAndNo.Set(V.Args.YesAndNo)
V.Local.sTitle.Set(V.Args.Title)
V.Local.sMessage.Set(V.Args.Message)

F.Intrinsic.Control.If(V.Local.bYesAndNo)
	GUI.FormMessageBox.cmdMsgNo.Visible(True)
	GUI.FormMessageBox.cmdMsgNo.Position(4515, 1425)
	GUI.FormMessageBox.cmdMsgNo.Caption("No")
	GUI.FormMessageBox.cmdMsgYes.Visible(True)
	GUI.FormMessageBox.cmdMsgYes.Position(3390, 1425)
	GUI.FormMessageBox.cmdMsgYes.Caption("Yes")
F.Intrinsic.Control.Else
	GUI.FormMessageBox.cmdMsgNo.Visible(False)
	GUI.FormMessageBox.cmdMsgYes.Visible(True)
	GUI.FormMessageBox.cmdMsgYes.Position(4515, 1425)
	GUI.FormMessageBox.cmdMsgYes.Caption("OK")
F.Intrinsic.Control.EndIf

GUI.FormMessageBox..Caption(V.Local.sTitle)
GUI.FormMessageBox.lblMsgBox.Caption(V.Local.sMessage)

GUI.FormTimesheet..Enabled(False)
GUI.FormMessageBox..Show
GUI.FormMessageBox..WaitForDismiss
GUI.FormTimesheet..AlwaysOnTop(True)
GUI.FormTimesheet..AlwaysOnTop(False)
GUI.FormTimesheet..Enabled(True)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("MessageBox_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.MessageBox.End

Program.Sub.FormMessageBox_UnLoad.Start
F.Intrinsic.Control.SetErrorHandler("FormMessageBox_UnLoad_Err")
F.Intrinsic.Control.ClearErrors

V.Global.sMessageBoxReturn.Set("NO")
GUI.FormMessageBox..Visible(False)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("FormMessageBox_UnLoad_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.FormMessageBox_UnLoad.End

Program.Sub.cmdMsgYes_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdMsgYes_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Global.sMessageBoxReturn.Set("YES")
GUI.FormMessageBox..Visible(False)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdMsgYes_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdMsgYes_Click.End

Program.Sub.cmdMsgNo_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdMsgNo_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Global.sMessageBoxReturn.Set("NO")
GUI.FormMessageBox..Visible(False)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdMsgNo_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdMsgNo_Click.End

Program.Sub.SetIcon.Start
F.Intrinsic.Control.SetErrorHandler("SetIcon_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sForm.Declare(String)
V.Local.bExists.Declare(Boolean)
V.Local.sIcon.Declare(String)
V.Local.iCounter.Declare(Long)

F.Intrinsic.String.Build("{0}\ART\gss2.ico",V.Caller.GlobalDir,v.Local.sIcon)
F.Intrinsic.File.Exists(V.Local.sIcon, V.Local.bExists)
F.Intrinsic.Control.If(V.Local.bExists.Not)
	F.Intrinsic.String.Build("{0}\GAB\GAS\gss2.ico",V.Caller.PluginsDir,v.Local.sIcon)
	F.Intrinsic.File.Exists(V.Local.sIcon, V.Local.bExists)
	F.Intrinsic.Control.If(V.Local.bExists.Not)
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.UI.GetFormList(V.Local.sForm)
F.Intrinsic.String.Split(V.Local.sForm, "*!*", V.Local.sForm)

F.Intrinsic.Control.For(V.Local.iCounter, 0, V.Local.sForm.UBound, 1)
	GUI.[V.Local.sForm(V.Local.iCounter)]..Icon(V.Local.sIcon)
F.Intrinsic.Control.Next(V.Local.iCounter)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("SetIcon_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.SetIcon.End

Program.Sub.ErrorMessage.Start
'basic error message for replacing catch block
'this is really just for when printing the message and ending program
'pass error number, error description, current subroutine
'optional callback sub, this will be called before ending
F.Intrinsic.Control.SetErrorHandler("ErrorMessage_Err")
F.Intrinsic.Control.ClearErrors

V.Local.iError.Declare(Long)
V.Local.sErrorDescription.Declare(String)
V.Local.sSubroutine.Declare(String)
V.Local.sError.Declare(String)
V.Local.bExists.Declare(Boolean)
V.Local.sCallback.Declare(String)
V.Static.bError.Declare(Boolean, False)

V.Local.iError.Set(V.Args.ErrorNumber)
V.Local.sErrorDescription.Set(V.Args.ErrorDescription)
V.Local.sSubroutine.Set(V.Args.Subroutine)

'make sure we aren't in an error loop
F.Intrinsic.Control.If(V.Static.bError)
	F.Intrinsic.Control.End
F.Intrinsic.Control.EndIf
V.Static.bError.Set(True)

F.Intrinsic.String.Build("{6}{1}Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}", V.Caller.ScriptFile, V.Ambient.Newline, V.Local.sSubroutine, V.Local.iError, V.Local.sErrorDescription, V.Ambient.GABVersion, V.Ambient.Now, V.Local.sError)
F.Intrinsic.UI.Msgbox(V.Local.sError)

F.Intrinsic.Variable.ArgExists("Callback", V.Local.bExists)
F.Intrinsic.Control.If(V.Local.bExists)
	V.Local.sCallback.Set(V.Args.Callback.Trim)
	F.Intrinsic.Control.CallSub(V.Local.sCallback)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.End

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("ErrorMessage_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Caller.ScriptFile,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.End
Function.Intrinsic.Control.EndIf
Program.Sub.ErrorMessage.End

Program.Sub.LoadJobTime.Start
F.Intrinsic.Control.SetErrorHandler("LoadJobTime_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sSQL.Declare(String)
V.Local.dStartDate.Declare(Date)
V.Local.dEndDate.Declare(Date)
V.Local.sEmployee.Declare(String)
V.Local.sRet.Declare(String)
V.Local.fHours.Declare(Float)
V.Local.sHours.Declare(String)

'get employee
F.Intrinsic.Control.If(v.Global.bAdminMode)
	V.Local.sEmployee.Set(V.Screen.FormTimesheet!txtEmployee.Text.Trim)
F.Intrinsic.Control.Else
	F.Global.Security.GetEmpNoFromUser(V.Global.sUser, V.Local.sEmployee)
	F.Intrinsic.Control.If(V.Local.sEmployee.IsNoReturn)
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

'get date range
V.Local.dStartDate.Set(V.Screen.FormTimesheet!dtpWeek.Value)
F.Intrinsic.Date.DateAdd("D", 6, V.Local.dStartDate, V.Local.dEndDate)

F.Intrinsic.String.Build("select SUM(HOURS_WORKED) TOTAL_HOURS from V_JOB_DETAIL where EMPL = '{0}' and CHARGE_DATE between '{1}' and '{2}' group by EMPL", V.Local.sEmployee, V.Local.dStartDate.PervasiveDate, V.Local.dEndDate.PervasiveDate, V.Local.sSQL)
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSQL, V.Local.sRet)
F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
	V.Local.fHours.Set(0)
F.Intrinsic.Control.Else
	V.Local.fHours.Set(V.Local.sRet.Float)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fHours)
GUI.FormTimesheet.txtGUIHours.Text(V.Args.Time)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("LoadJobTime_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.LoadJobTime.End

Program.Sub.LoadGridJobTime.Start
F.Intrinsic.Control.SetErrorHandler("LoadGridJobTime_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sSQL.Declare(String)
V.Local.dStartDate.Declare(Date)
V.Local.dEndDate.Declare(Date)
V.Local.sEmployee.Declare(String)
V.Local.sRet.Declare(String)
V.Local.fHours.Declare(Float)
V.Local.sHours.Declare(String)
V.Local.iCounter.Declare(Long)
V.Local.sFilter.Declare(String)
V.Local.sColumn.Declare(String)
V.Local.iDifference.Declare(Long)
V.Local.sMainDataTableColumn.Declare(String)

'F.Data.DataTable.AddColumn("dtTimesheet", "SUNDAY_JOB_DETAIL_HOURS", "Float", 0)
'F.Data.DataTable.AddColumn("dtTimesheet", "MONDAY_JOB_DETAIL_HOURS", "Float", 0)
'F.Data.DataTable.AddColumn("dtTimesheet", "TUESDAY_JOB_DETAIL_HOURS", "Float", 0)
'F.Data.DataTable.AddColumn("dtTimesheet", "WEDNESDAY_JOB_DETAIL_HOURS", "Float", 0)
'F.Data.DataTable.AddColumn("dtTimesheet", "THURSDAY_JOB_DETAIL_HOURS", "Float", 0)
'F.Data.DataTable.AddColumn("dtTimesheet", "FRIDAY_JOB_DETAIL_HOURS", "Float", 0)
'F.Data.DataTable.AddColumn("dtTimesheet", "SATURDAY_JOB_DETAIL_HOURS", "Float", 0)

''get employee
'F.Intrinsic.Control.If(v.Global.bAdminMode)
'	V.Local.sEmployee.Set(V.Screen.FormTimesheet!txtEmployee.Text.Trim)
'F.Intrinsic.Control.Else
'	F.Global.Security.GetEmpNoFromUser(V.Global.sUser, V.Local.sEmployee)
'	F.Intrinsic.Control.If(V.Local.sEmployee.IsNoReturn)
'		'F.Intrinsic.String.Build("No employee tied to the user '{0}', clock in time will not be pulled in.", V.Global.sUser, V.Local.sMessage)
'		'F.Intrinsic.UI.Msgbox(V.Local.sMessage)
'		F.Intrinsic.Control.ExitSub
'	F.Intrinsic.Control.EndIf
'F.Intrinsic.Control.EndIf

''get date range
'V.Local.dStartDate.Set(V.Screen.FormTimesheet!dtpWeek.Value)
'F.Intrinsic.Date.DateAdd("D", 6, V.Local.dStartDate, V.Local.dEndDate)

'F.Intrinsic.String.Build("select RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) JSS, CHARGE_DATE, SUM(HOURS_WORKED) TOTAL_HOURS from V_JOB_DETAIL where EMPL = '{0}' and CHARGE_DATE between '{1}' and '{2}' group by JSS, CHARGE_DATE", V.Local.sEmployee, V.Local.dStartDate.PervasiveDate, V.Local.dEndDate.PervasiveDate, V.Local.sSQL)
'F.Data.DataTable.CreateFromSQL("dtJobHours", "Con", V.Local.sSQL)

'F.Data.DataView.Create("dtTimesheet", "dvLoadHours", 22)
'F.Intrinsic.Control.For(V.Local.iCounter, 0, V.DataTable.dtJobHours.RowCount--, 1)
'	
'	'get the column based off the date
'	F.Intrinsic.Date.DateDiff("D", V.DataTable.dtJobHours(V.Local.iCounter).CHARGE_DATE!FieldVal, V.Local.dStartDate, V.Local.iDifference)
'	F.Intrinsic.Control.SelectCase(V.Local.iDifference)
'		F.Intrinsic.Control.Case(0)
'			V.Local.sColumn.Set("SUNDAY_JOB_DETAIL_HOURS")
'			V.Local.sMainDataTableColumn.Set("SUN_HRS")
'		F.Intrinsic.Control.Case(1)
'			V.Local.sColumn.Set("MONDAY_JOB_DETAIL_HOURS")
'			V.Local.sMainDataTableColumn.Set("MON_HRS")
'		F.Intrinsic.Control.Case(2)
'			V.Local.sColumn.Set("TUESDAY_JOB_DETAIL_HOURS")
'			V.Local.sMainDataTableColumn.Set("TUES_HRS")
'		F.Intrinsic.Control.Case(3)
'			V.Local.sColumn.Set("WEDNESDAY_JOB_DETAIL_HOURS")
'			V.Local.sMainDataTableColumn.Set("WED_HRS")
'		F.Intrinsic.Control.Case(4)
'			V.Local.sColumn.Set("THURSDAY_JOB_DETAIL_HOURS")
'			V.Local.sMainDataTableColumn.Set("THURS_HRS")
'		F.Intrinsic.Control.Case(5)
'			V.Local.sColumn.Set("FRIDAY_JOB_DETAIL_HOURS")
'			V.Local.sMainDataTableColumn.Set("FRI_HRS")
'		F.Intrinsic.Control.Case(6)
'			V.Local.sColumn.Set("SATURDAY_JOB_DETAIL_HOURS")
'			V.Local.sMainDataTableColumn.Set("SAT_HRS")
'	F.Intrinsic.Control.EndSelect
'	
'	'see if the job is already in the timesheet
'	F.Intrinsic.String.Build("JSS = '{0}'", V.DataTable.dtJobHours(V.Local.iCounter).JSS!FieldValTrim, V.Local.sFilter)
'	F.Data.DataView.SetFilter("dtTimesheet", "dvLoadHours", V.Local.sFilter)
'	F.Intrinsic.Control.If(V.DataView.dtTimesheet!dvLoadHours.RowCount, >, 0)
'		F.Intrinsic.Control.If(V.DataView.dtTimesheet!dvLoadHours(0).UPDATED!FieldVal, =, True)
'			F.Intrinsic.Math.Sub(V.DataTable.dtJobHours(V.Local.iCounter).TOTAL_HOURS!FieldValFloat, V.DataView.dtTimesheet!dvLoadHours(0).[V.Local.sMainDataTableColumn]!FieldValFloat, V.Local.fHours)
'		F.Intrinsic.Control.Else
'			V.Local.fHours.Set(V.DataTable.dtJobHours(V.Local.iCounter).TOTAL_HOURS!FieldValFloat)
'		F.Intrinsic.Control.EndIf
'		
'		F.Data.DataView.SetValue("dtTimesheet", "dvLoadHours", -1, V.Local.sMainDataTableColumn, V.Local.fHours)
'	F.Intrinsic.Control.Else
'		'do we want to add it?
'	F.Intrinsic.Control.EndIf
'F.Intrinsic.Control.Next(V.Local.iCounter)
'F.Data.DataView.Close("dtTimesheet", "dvLoadHours")
'F.Data.DataTable.Close("dtJobHours")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("LoadGridJobTime_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.LoadGridJobTime.End

Program.Sub.txtUser_LostFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtUser_LostFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sUser.Declare(String)
V.Local.sEmployee.Declare(String)
V.Local.sSQL.Declare(String)
V.Local.sRet.Declare(String)

F.Intrinsic.Control.If(V.Screen.FormTimesheet!txtUser.Text.Trim, !=, "")
	V.Local.sUser.Set(V.Screen.FormTimesheet!txtUser.Text.Trim)
	V.Local.sUser.Set(V.Local.sUser.UCase)

	F.Intrinsic.String.Build("select RTRIM(GS_USER) from USER_INFORMATION where GS_USER = '{0}'", V.Local.sUser, V.Local.sSQL)
	F.ODBC.Connection!Comm.OpenCommonConnection
	F.ODBC.Connection!Comm.ExecuteAndReturn(V.Local.sSQL, V.Local.sRet)
	F.ODBC.Connection!Comm.Close
	
	F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
		F.Intrinsic.UI.Msgbox("Invalid user entered.")
		GUI.FormTimesheet.txtUser.Text("")
		GUI.FormTimesheet.txtEmployee.Text("")
	F.Intrinsic.Control.Else
		F.Global.Security.GetEmpNoFromUser(V.Local.sUser, V.Local.sEmployee)
		F.Intrinsic.Control.If(V.Local.sEmployee.IsNotNoReturn)
			GUI.FormTimesheet.txtEmployee.Text(V.Local.sEmployee)
		F.Intrinsic.Control.Else
			GUI.FormTimesheet.txtEmployee.Text("")
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtUser_LostFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.txtUser_LostFocus.End

Program.Sub.txtEmployee_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtEmployee_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

Gui.FormTimesheet.txtEmployee.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtEmployee_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.txtEmployee_GotFocus.End

Program.Sub.txtASO_LostFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtASO_LostFocus_Err")
F.Intrinsic.Control.ClearErrors
V.Local.sOrd.Declare(String)

V.Local.sOrd.Set(V.Screen.FormTimesheet!txtASO.Text)

F.Intrinsic.Control.If(V.Local.sOrd.Trim,=,"")
	Gui.FormTimesheet.txtAWO.Text("")
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtASO_LostFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.txtASO_LostFocus.End

Program.Sub.txtASO_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtASO_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

Gui.FormTimesheet.txtASO.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtASO_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.txtASO_GotFocus.End

Program.Sub.txtADept_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtADept_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

Gui.FormTimesheet.txtADept.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtADept_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.txtADept_GotFocus.End

Program.Sub.txtWC_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtWC_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

Gui.FormTimesheet.txtWC.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtWC_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
Function.Intrinsic.Control.EndIf
Program.Sub.txtWC_GotFocus.End

Program.Sub.Comments.Start
${$5$}$2.0.0.0$}$2
${$6$}$Angel$}$20231115151015980$}$KXl0r/FkrMYwb/r4ukQ87VNzvoHa8Zo7wHQB+NMLNKLe9uxjzn+cOk+BId1EO5m0ipfVpcZVh/U=
Program.Sub.Comments.End